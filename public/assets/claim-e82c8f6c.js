import{U as f}from"./util-c02dbcf9.js";import{m as D,_ as V,r as k,o as r,c as n,a as e,F as R,g as x,s as L,v as N,k as u,e as C,t as l,b as y,w as T,j as M,d as S,p as A,f as O}from"./index-7c0b344a.js";import{m as U}from"./mobile-8dd88b05.js";import{a as w,E,F as B}from"./apiService-6a3981ff.js";import"./jquery-d0ecd42c.js";import"./axios-c24e582b.js";const F={name:"pcClaim",props:["claimType","productList","returnParams","priceParams","pointSetting"],data(){return{util:f,claimTitle:"",selectedPrd:[],claimCode:"",claimCodeList:[{title:"마음에 안들어서",value:"a"},{title:"비싸서",value:"b"},{title:"직접입력",value:"dct"}],claimMessage:"",bankName:"",bankAccount:"",bankOwner:""}},created(){switch(this.setClass("productView"),this.claimType){case"CR":this.claimTitle="주문취소";break;case"RR":this.claimTitle="반품요청";break;case"ER":this.claimTitle="교환요청";break}this.setTitle(this.claimTitle),this.claimCodeList.unshift({title:this.claimTitle+" 사유선택",value:""})},methods:{...D(U,["setClass","setTitle"]),validate(){if(this.form){if(this.claimCode!="dct")for(const s of this.claimCodeList)this.claimCode==s.value&&(this.claimMessage=s.text);let a={claimMessage:this.claimMessage};this.claimType!="ER"&&!this.priceParams.notPay&&(this.priceParams.payMethod=="bank"||this.priceParams.payMethod=="vbank")&&(a.bankName=this.bankName,a.bankAccount=this.bankAccount,a.bankOwner=this.bankOwner),this.$emit("claimRegist",a)}},checkClaimCode(){return this.claimCode?!0:this.claimTitle+" 사유를 선택하세요"},checkClaimMessage(){return this.claimMessage?!0:"내용을 입력하세요"},checkProduct(a,s){this.$emit("checkProduct",{checked:a,opId:s})},checkBankName(){return this.bankName?!0:"은행명을 입력하세요"},checkBankAccount(){return this.bankAccount?!0:"계좌번호를 입력하세요"},checkBankOwner(){return this.bankOwner?!0:"예금주를 입력하세요"}}},_=a=>(A("data-v-93436d72"),a=a(),O(),a),G={class:"claim-container"},Y=_(()=>e("div",{class:"sub-title"},"상품정보",-1)),j={class:"product-body"},z={key:0,class:"checkbox"},q=["onUpdate:modelValue","onChange"],H={class:"img-box"},J=["src"],K={class:"product-info"},Q={class:"info-ul"},W={key:0,class:"option-item"},X={class:"amt"},Z={key:1,class:"amt"},$={class:"amt"},ee={class:"price"},te=_(()=>e("div",{class:"sub-title",style:{"padding-top":"50px"}},"결제정보",-1)),se={class:"order-box"},ie={class:"order-ul"},oe=_(()=>e("li",{class:"label"},"결제방법",-1)),ae={class:"value"},le={class:"order-ul"},re=_(()=>e("li",{class:"label"},"총 상품금액",-1)),ne={class:"value"},ce={key:0,class:"order-ul"},ue=_(()=>e("li",{class:"label"},"쿠폰 할인액",-1)),de={class:"value"},me={key:1,class:"order-ul"},he={class:"label"},_e={class:"value"},pe={key:2,class:"order-ul"},Pe=_(()=>e("li",{class:"label"},"배송비",-1)),ye={class:"value"},ve={class:"order-ul"},fe=_(()=>e("li",{class:"label"},"총 결제금액",-1)),ke={class:"value"},be={key:3,class:"order-ul"},ge=_(()=>e("li",{class:"label"},null,-1)),Ce=_(()=>e("li",{class:"notpay"},"미입금",-1)),Ie=[ge,Ce],Te={key:0},Re=_(()=>e("div",{class:"sub-title",style:{"padding-top":"30px"}},"환불정보",-1)),xe={class:"order-box"},Me={key:0,style:{padding:"20px 0","text-align":"center","font-size":"14px"}},Ve={key:1},we={key:0,class:"order-ul"},Le=_(()=>e("li",{class:"label"},"복구 쿠폰",-1)),Ne={class:"value"},Se={key:1,class:"order-ul"},Ae={class:"label"},Oe={class:"value"},De={key:2,class:"order-ul"},Ue=_(()=>e("li",{class:"label"},"환불액",-1)),Ee={class:"value"},Be={key:3,class:"order-ul"},Fe=_(()=>e("li",{class:"label"},"반품 배송비",-1)),Ge={class:"value"},Ye={key:1},je=_(()=>e("div",{class:"sub-title",style:{"padding-top":"30px"}},"교환요청시 유의사항",-1)),ze=_(()=>e("div",{class:"order-box"},[e("ul",{style:{"list-style-type":"disc",padding:"0 0 0 15px"}},[e("li",null,"상품에 중요하자가 발생시만 교환 가능합니다"),e("li",null,"상품 교환은 동일상품으로 교환됩니다"),e("li",null,"교환 배송비는 무료입니다"),e("li",null,"상품에 하자가 없을 경우 교환거부될수 있습니다")])],-1)),qe=[je,ze],He={class:"sub-title",style:{"padding-top":"30px"}},Je={class:"input-box",style:{"margin-top":"-30px"}},Ke={key:0},Qe=_(()=>e("div",{class:"sub-title",style:{"padding-top":"30px"}},"환불계좌",-1)),We={class:"input-box",style:{"margin-top":"-30px"}},Xe={class:"button-row"};function Ze(a,s,t,d,i,c){const m=k("v-select"),v=k("v-textarea"),P=k("v-text-field"),h=k("v-btn"),I=k("v-form");return r(),n("div",G,[Y,e("ul",j,[(r(!0),n(R,null,x(t.productList,(o,b)=>(r(),n("li",null,[t.claimType!="CR"?(r(),n("div",z,[L(e("input",{type:"checkbox",style:{width:"15px",height:"15px"},"onUpdate:modelValue":g=>o.checked=g,onChange:g=>c.checkProduct(o.checked,o.opId)},null,40,q),[[N,o.checked]])])):u("",!0),e("div",H,[e("img",{src:o.listImg},null,8,J)]),e("div",K,[e("div",Q,[C(l(o.pname)+" ",1),o.opt_name?(r(),n("div",W,[C(l(o.opt_name)+" ",1),e("span",X,"("+l(o.ordAmt)+"개)",1)])):(r(),n("span",Z,"("+l(o.ordAmt)+"개)",1)),o.sOptList.length>0?(r(!0),n(R,{key:2},x(o.sOptList,g=>(r(),n("div",null,[C(l(g.name)+" ",1),e("span",$,"("+l(g.oamt)+"개)",1)]))),256)):u("",!0)]),e("div",ee,l(i.util.numberFormat(o.payprice))+"원 ",1)])]))),256))]),te,e("div",se,[e("ul",ie,[oe,e("li",ae,l(t.priceParams.payMethodName),1)]),e("ul",le,[re,e("li",ne,l(t.priceParams.productPrice)+"원",1)]),t.priceParams.useCouponPrice?(r(),n("ul",ce,[ue,e("li",de,"-"+l(t.priceParams.useCouponPrice)+"원",1)])):u("",!0),t.priceParams.usePoint?(r(),n("ul",me,[e("li",he,"사용 "+l(t.pointSetting.name),1),e("li",_e,"-"+l(t.priceParams.usePoint)+l(t.pointSetting.unit),1)])):u("",!0),t.priceParams.serviceType=="normal"?(r(),n("ul",pe,[Pe,e("li",ye,l(t.priceParams.deliveryPrice)+"원",1)])):u("",!0),e("ul",ve,[fe,e("li",ke,l(t.priceParams.payPrice)+"원",1)]),t.priceParams.notPay?(r(),n("ul",be,Ie)):u("",!0)]),!t.priceParams.notPay&&t.claimType!="ER"?(r(),n("div",Te,[Re,e("div",xe,[t.returnParams.empty?(r(),n("div",Me,l(i.claimTitle)+"할 상품을 선택하세요 ",1)):(r(),n("div",Ve,[t.returnParams.couponName?(r(),n("ul",we,[Le,e("li",Ne,l(t.returnParams.couponName),1)])):u("",!0),t.returnParams.usePoint?(r(),n("ul",Se,[e("li",Ae,"복구 "+l(t.pointSetting.name),1),e("li",Oe,l(t.returnParams.usePoint)+l(t.pointSetting.unit),1)])):u("",!0),t.returnParams.payPrice?(r(),n("ul",De,[Ue,e("li",Ee,l(t.returnParams.payPrice)+"원",1)])):u("",!0),t.returnParams.returnDeliveryPrice?(r(),n("ul",Be,[Fe,e("li",Ge,l(t.returnParams.returnDeliveryPrice)+"원",1)])):u("",!0)]))])])):u("",!0),t.claimType=="ER"?(r(),n("div",Ye,qe)):u("",!0),e("div",He,l(i.claimTitle)+" 사유",1),y(I,{modelValue:a.form,"onUpdate:modelValue":s[6]||(s[6]=o=>a.form=o),novalidate:"",onSubmit:S(c.validate,["prevent"])},{default:T(()=>[e("div",Je,[y(m,{modelValue:i.claimCode,"onUpdate:modelValue":s[0]||(s[0]=o=>i.claimCode=o),variant:"outlined",rounded:"",ref:"claimCode",rules:[c.checkClaimCode],items:i.claimCodeList},null,8,["modelValue","rules","items"]),i.claimCode=="dct"?(r(),M(v,{key:0,rounded:"",row:"5",rules:[c.checkClaimMessage],variant:"outlined",ref:"claimMessage",label:"내용",modelValue:i.claimMessage,"onUpdate:modelValue":s[1]||(s[1]=o=>i.claimMessage=o)},null,8,["rules","modelValue"])):u("",!0)]),t.claimType!="ER"&&!t.priceParams.notPay&&(t.priceParams.payMethod=="bank"||t.priceParams.payMethod=="vbank")?(r(),n("div",Ke,[Qe,e("div",We,[e("div",null,[y(P,{modelValue:i.bankName,"onUpdate:modelValue":s[2]||(s[2]=o=>i.bankName=o),rules:[c.checkBankName],variant:"outlined",rounded:"",ref:"bankName",label:"은행명"},null,8,["modelValue","rules"])]),e("div",null,[y(P,{modelValue:i.bankAccount,"onUpdate:modelValue":s[3]||(s[3]=o=>i.bankAccount=o),rules:[c.checkBankAccount],variant:"outlined",rounded:"",ref:"bankAccount",label:"계좌번호"},null,8,["modelValue","rules"])]),e("div",null,[y(P,{modelValue:i.bankOwner,"onUpdate:modelValue":s[4]||(s[4]=o=>i.bankOwner=o),rules:[c.checkBankOwner],variant:"outlined",rounded:"",ref:"bankOwner",label:"예금주"},null,8,["modelValue","rules"])])])])):u("",!0),e("div",Xe,[y(h,{type:"button",class:"whiteButton",onClick:s[5]||(s[5]=o=>a.$router.back()),variant:"outlined",rounded:""},{default:T(()=>[C(" 취소 ")]),_:1}),y(h,{type:"submit",class:"blackButton",variant:"outlined",rounded:""},{default:T(()=>[C(" 확인 ")]),_:1})])]),_:1},8,["modelValue","onSubmit"])])}const $e=V(F,[["render",Ze],["__scopeId","data-v-93436d72"]]);const et={name:"pcClaim",props:["claimType","productList","returnParams","priceParams","pointSetting"],data(){return{form:null,util:f,claimTitle:"",selectedPrd:[],claimCode:"",claimCodeList:[{title:"마음에 안들어서",value:"a"},{title:"비싸서",value:"b"},{title:"직접입력",value:"dct"}],claimMessage:"",bankName:"",bankAccount:"",bankOwner:""}},created(){switch(this.claimType){case"CR":this.claimTitle="주문취소";break;case"RR":this.claimTitle="반품요청";break;case"ER":this.claimTitle="교환요청";break}this.claimCodeList.unshift({title:this.claimTitle+" 사유선택",value:""})},methods:{validate(){if(this.form){if(this.claimCode!="dct")for(const s of this.claimCodeList)this.claimCode==s.value&&(this.claimMessage=s.text);let a={claimMessage:this.claimMessage};this.claimType!="ER"&&!this.priceParams.notPay&&(this.priceParams.payMethod=="bank"||this.priceParams.payMethod=="vbank")&&(a.bankName=this.bankName,a.bankAccount=this.bankAccount,a.bankOwner=this.bankOwner),this.$emit("claimRegist",a)}},checkClaimCode(){return this.claimCode?!0:this.claimTitle+" 사유를 선택하세요"},checkClaimMessage(){return this.claimMessage?!0:"내용을 입력하세요"},checkProduct(a,s){this.$emit("checkProduct",{checked:a,opId:s})},checkBankName(){return this.bankName?!0:"은행명을 입력하세요"},checkBankAccount(){return this.bankAccount?!0:"계좌번호를 입력하세요"},checkBankOwner(){return this.bankOwner?!0:"예금주를 입력하세요"}}},p=a=>(A("data-v-4396917f"),a=a(),O(),a),tt={class:"claim-container"},st={class:"claim-title"},it=p(()=>e("div",{class:"sub-title",style:{padding:"20px 0 0 0"}},"상품정보",-1)),ot={class:"product-body"},at={key:0,class:"checkbox"},lt=["onUpdate:modelValue","onChange"],rt={class:"img-box"},nt=["src"],ct={class:"product-info"},ut={class:"info-ul"},dt={key:0,class:"option-item"},mt={class:"amt"},ht={key:1,class:"amt"},_t={class:"amt"},pt={class:"price"},Pt=p(()=>e("div",{class:"sub-title",style:{"padding-top":"50px"}},"결제정보",-1)),yt={class:"order-box"},vt={class:"order-ul"},ft=p(()=>e("li",{class:"label"},"결제방법",-1)),kt={class:"value"},bt={class:"order-ul"},gt=p(()=>e("li",{class:"label"},"총 상품금액",-1)),Ct={class:"value"},It={key:0,class:"order-ul"},Tt=p(()=>e("li",{class:"label"},"쿠폰 할인액",-1)),Rt={class:"value"},xt={key:1,class:"order-ul"},Mt={class:"label"},Vt={class:"value"},wt={key:2,class:"order-ul"},Lt=p(()=>e("li",{class:"label"},"배송비",-1)),Nt={class:"value"},St={class:"order-ul"},At=p(()=>e("li",{class:"label"},"총 결제금액",-1)),Ot={class:"value"},Dt={key:3,class:"order-ul"},Ut=p(()=>e("li",{class:"label"},null,-1)),Et=p(()=>e("li",{class:"notpay"},"미입금",-1)),Bt=[Ut,Et],Ft={key:0},Gt=p(()=>e("div",{class:"sub-title",style:{"padding-top":"50px"}},"환불정보",-1)),Yt={class:"order-box"},jt={key:0,style:{padding:"20px 0","text-align":"center","font-size":"14px"}},zt={key:1},qt={key:0,class:"order-ul"},Ht=p(()=>e("li",{class:"label"},"복구 쿠폰",-1)),Jt={class:"value"},Kt={key:1,class:"order-ul"},Qt={class:"label"},Wt={class:"value"},Xt={key:2,class:"order-ul"},Zt=p(()=>e("li",{class:"label"},"환불액",-1)),$t={class:"value"},es={key:3,class:"order-ul"},ts=p(()=>e("li",{class:"label"},"반품 배송비",-1)),ss={class:"value"},is={key:1},os=p(()=>e("div",{class:"sub-title",style:{"padding-top":"50px"}},"교환요청시 유의사항",-1)),as=p(()=>e("div",{class:"order-box"},[e("ul",{style:{"list-style-type":"disc"}},[e("li",null,"상품에 중요하자가 발생시만 교환 가능합니다"),e("li",null,"상품 교환은 동일상품으로 교환됩니다"),e("li",null,"교환 배송비는 무료입니다"),e("li",null,"상품에 하자가 없을 경우 교환거부될수 있습니다")])],-1)),ls=[os,as],rs={class:"sub-title",style:{padding:"50px 0 0 0"}},ns={class:"input-box",style:{"margin-top":"-30px"}},cs={key:0},us=p(()=>e("div",{class:"sub-title",style:{"padding-top":"30px"}},"환불계좌",-1)),ds={class:"input-box",style:{"margin-top":"-30px",display:"flex","justify-content":"space-between"}},ms={style:{width:"200px"}},hs={style:{width:"300px",margin:"0 15px"}},_s={style:{width:"150px"}},ps={class:"button-row"};function Ps(a,s,t,d,i,c){const m=k("v-select"),v=k("v-textarea"),P=k("v-text-field"),h=k("v-btn"),I=k("v-form");return r(),n("div",tt,[e("div",st,l(i.claimTitle),1),it,e("ul",ot,[(r(!0),n(R,null,x(t.productList,(o,b)=>(r(),n("li",null,[t.claimType!="CR"?(r(),n("div",at,[L(e("input",{type:"checkbox",style:{width:"20px",height:"20px"},"onUpdate:modelValue":g=>o.checked=g,onChange:g=>c.checkProduct(o.checked,o.opId)},null,40,lt),[[N,o.checked]])])):u("",!0),e("div",rt,[e("img",{src:o.listImg},null,8,nt)]),e("div",ct,[e("div",ut,[C(l(o.pname)+" ",1),o.opt_name?(r(),n("div",dt,[C(l(o.opt_name)+" ",1),e("span",mt,"("+l(o.ordAmt)+"개)",1)])):(r(),n("span",ht,"("+l(o.ordAmt)+"개)",1)),o.sOptList.length>0?(r(!0),n(R,{key:2},x(o.sOptList,g=>(r(),n("div",null,[C(l(g.name)+" ",1),e("span",_t,"("+l(g.oamt)+"개)",1)]))),256)):u("",!0)]),e("div",pt,l(i.util.numberFormat(o.payprice))+"원 ",1)])]))),256))]),Pt,e("div",yt,[e("ul",vt,[ft,e("li",kt,l(t.priceParams.payMethodName),1)]),e("ul",bt,[gt,e("li",Ct,l(t.priceParams.productPrice)+"원",1)]),t.priceParams.useCouponPrice?(r(),n("ul",It,[Tt,e("li",Rt,"-"+l(t.priceParams.useCouponPrice)+"원",1)])):u("",!0),t.priceParams.usePoint?(r(),n("ul",xt,[e("li",Mt,"사용 "+l(t.pointSetting.name),1),e("li",Vt,"-"+l(t.priceParams.usePoint)+l(t.pointSetting.unit),1)])):u("",!0),t.priceParams.serviceType=="normal"?(r(),n("ul",wt,[Lt,e("li",Nt,l(t.priceParams.deliveryPrice)+"원",1)])):u("",!0),e("ul",St,[At,e("li",Ot,l(t.priceParams.payPrice)+"원",1)]),t.priceParams.notPay?(r(),n("ul",Dt,Bt)):u("",!0)]),!t.priceParams.notPay&&t.claimType!="ER"?(r(),n("div",Ft,[Gt,e("div",Yt,[t.returnParams.empty?(r(),n("div",jt,l(i.claimTitle)+"할 상품을 선택하세요 ",1)):(r(),n("div",zt,[t.returnParams.couponName?(r(),n("ul",qt,[Ht,e("li",Jt,l(t.returnParams.couponName),1)])):u("",!0),t.returnParams.usePoint?(r(),n("ul",Kt,[e("li",Qt,"복구 "+l(t.pointSetting.name),1),e("li",Wt,l(t.returnParams.usePoint)+l(t.pointSetting.unit),1)])):u("",!0),t.returnParams.payPrice?(r(),n("ul",Xt,[Zt,e("li",$t,l(t.returnParams.payPrice)+"원",1)])):u("",!0),t.returnParams.returnDeliveryPrice?(r(),n("ul",es,[ts,e("li",ss,l(t.returnParams.returnDeliveryPrice)+"원",1)])):u("",!0)]))])])):u("",!0),t.claimType=="ER"?(r(),n("div",is,ls)):u("",!0),e("div",rs,l(i.claimTitle)+" 사유",1),y(I,{modelValue:i.form,"onUpdate:modelValue":s[6]||(s[6]=o=>i.form=o),novalidate:"",onSubmit:S(c.validate,["prevent"])},{default:T(()=>[e("div",ns,[y(m,{modelValue:i.claimCode,"onUpdate:modelValue":s[0]||(s[0]=o=>i.claimCode=o),variant:"outlined",rounded:"",ref:"claimCode",rules:[c.checkClaimCode],items:i.claimCodeList},null,8,["modelValue","rules","items"]),i.claimCode=="dct"?(r(),M(v,{key:0,rounded:"",row:"5",rules:[c.checkClaimMessage],variant:"outlined",ref:"claimMessage",label:"내용",modelValue:i.claimMessage,"onUpdate:modelValue":s[1]||(s[1]=o=>i.claimMessage=o)},null,8,["rules","modelValue"])):u("",!0)]),t.claimType!="ER"&&!t.priceParams.notPay&&(t.priceParams.payMethod=="bank"||t.priceParams.payMethod=="vbank")?(r(),n("div",cs,[us,e("div",ds,[e("div",ms,[y(P,{modelValue:i.bankName,"onUpdate:modelValue":s[2]||(s[2]=o=>i.bankName=o),rules:[c.checkBankName],variant:"outlined",rounded:"",ref:"bankName",label:"은행명"},null,8,["modelValue","rules"])]),e("div",hs,[y(P,{modelValue:i.bankAccount,"onUpdate:modelValue":s[3]||(s[3]=o=>i.bankAccount=o),rules:[c.checkBankAccount],variant:"outlined",rounded:"",ref:"bankAccount",label:"계좌번호"},null,8,["modelValue","rules"])]),e("div",_s,[y(P,{modelValue:i.bankOwner,"onUpdate:modelValue":s[4]||(s[4]=o=>i.bankOwner=o),rules:[c.checkBankOwner],variant:"outlined",rounded:"",ref:"bankOwner",label:"예금주"},null,8,["modelValue","rules"])])])])):u("",!0),e("div",ps,[y(h,{type:"button",class:"whiteButton",onClick:s[5]||(s[5]=o=>a.$router.back()),variant:"outlined",rounded:""},{default:T(()=>[C(" 취소 ")]),_:1}),y(h,{type:"submit",class:"blackButton",variant:"outlined",rounded:""},{default:T(()=>[C(" 확인 ")]),_:1})])]),_:1},8,["modelValue","onSubmit"])])}const ys=V(et,[["render",Ps],["__scopeId","data-v-4396917f"]]);const vs={components:{mobileClaim:$e,pcClaim:ys},data(){return{mobile:!1,oid:"",orderInfo:{},productList:[],claimType:"",selectedPrd:[],pointSetting:{},useCouponPrice:0,usePoint:0,priceParams:{payMethod:"",payMethodName:"",productPrice:0,payPrice:0,serviceType:"normal",deliveryPrice:0,useCouponPrice:0,usePoint:0,couponName:"",notPay:!1},returnParams:{payPrice:0,usePoint:0,couponName:"",returnDeliveryPrice:0,empty:!0},serverFlag:!1,couponInfo:{},resultReturnData:{},deliveryInfo:{},totalProductPrice:0}},created(){this.oid=this.$route.params.oid,this.claimType=this.$route.params.claimType,this.mobile=this.$isMobile(),this.getData()},methods:{getData(){const a={oid:this.oid,claimType:this.claimType};w.post(E,a,s=>{if(s.status=="success"){this.selectedPrd=[],this.productList=[];let d="service",i=0,c=!1;for(let m of s.data.orderList){m.serviceType=="normal"&&(d="normal"),m.ostatus=="notpay"&&(c=!0);let v=[];if(m.optionSingleInfos){const P=JSON.parse(m.optionSingleInfos);for(const h of P)h.required!="Y"&&(v.push({name:h.option_parent_name+":"+h.option_name,oamt:h.camt}),m.payprice+=parseInt(h.sellprice))}m.sOptList=v,m.checked=!1,i+=parseInt(m.payprice),this.productList.push(m),this.claimType=="CR"&&this.selectedPrd.push(m.opId)}this.pointSetting={name:s.data.pointName,unit:s.data.pointUnit},this.orderInfo=this.productList[0],this.priceParams.payMethod=this.orderInfo.paymethod,this.priceParams.payMethodName=s.data.paymethods[this.orderInfo.paymethod],this.priceParams.payPrice=f.numberFormat(this.orderInfo.price),this.priceParams.notPay=c,d=="normal"&&(this.priceParams.deliveryPrice=f.numberFormat(this.orderInfo.deliveryPrice),this.claimType=="RR"&&(this.deliveryInfo=s.data.deliveryInfo)),this.priceParams.productPrice=f.numberFormat(i),this.totalProductPrice=i,this.priceParams.serviceType=d,this.orderInfo.useCouponId&&(this.couponInfo=s.data.couponInfo,this.priceParams.useCouponPrice=f.numberFormat(this.orderInfo.useCouponPrice),this.useCouponPrice=parseInt(this.orderInfo.useCouponPrice),this.claimType=="CR"&&(this.returnParams.couponName=s.data.couponInfo.cname)),this.orderInfo.usePoint&&(this.priceParams.usePoint=f.numberFormat(this.orderInfo.usePoint),this.usePoint=parseInt(this.orderInfo.usePoint),this.claimType=="CR"&&(this.returnParams.usePoint=f.numberFormat(this.orderInfo.usePoint))),this.claimType=="CR"&&(this.returnParams.payPrice=f.numberFormat(this.orderInfo.price),this.priceParams.notPay||(this.returnParams.empty=!1,this.resultReturnData.recoverPrice=this.orderInfo.price,this.resultReturnData.recoverPoint=this.orderInfo.usePoint,d=="normal"&&(this.resultReturnData.returnDeliveryPrice=this.orderInfo.deliveryPrice),this.orderInfo.useCouponId&&(this.resultReturnData.recoverCoupon="yes")))}})},checkProduct(a){let s=0,t="",d=!1;for(const i of this.selectedPrd){if(i==a.opId){d=!0,t=s;break}s++}a.checked?d||this.selectedPrd.push(a.opId):d&&this.selectedPrd.splice(t,1),this.claimType=="RR"&&this.counterReturnPrice()},counterReturnPrice(){if(this.selectedPrd.length<1){this.returnParams={payPrice:0,usePoint:0,couponName:"",returnDeliveryPrice:0,empty:!0};return}let a=0,s=!1,t={};for(const b of this.selectedPrd)t[b]=b;let d="service",i="service";for(const b of this.productList)t[b.opId]?(b.couponId&&(s=!0),b.serviceType=="normal"&&(d="normal"),a+=parseInt(b.payprice)):b.serviceType=="normal"&&(i="normal");let c=0,m=!1,v=!1;this.useCouponPrice&&(this.couponInfo.ctype=="product"?s&&(c=c+this.useCouponPrice,a>=this.useCouponPrice&&(m=!0)):(c=c+this.useCouponPrice,a>=this.useCouponPrice&&(m=!0))),this.usePoint&&(c=c+this.usePoint,a>=this.usePoint&&(v=!0));let P=0,h="",I=0;a>=c?(P=a-c,m&&(h=this.couponInfo.cname),v&&(I=this.usePoint)):m?(P=a-this.useCouponPrice,h=this.couponInfo.cname,I=0):v&&(P=a-this.usePoint,h="",I=this.usePoint);let o=0;if(this.deliveryInfo&&this.orderInfo.serviceType=="normal"){if(i=="normal")switch(this.deliveryInfo.dpriceType){case"half":this.orderInfo.deliveryPrice<1&&this.totalProductPrice-a<this.deliveryInfo.oprice&&(o=parseInt(this.deliveryInfo.mprice));break}d=="normal"&&(o=o+parseInt(this.deliveryInfo.backPrice))}this.resultReturnData={recoverPrice:P,recoverPoint:I,returnDeliveryPrice:o,recoverCoupon:h?"yes":"no"},this.returnParams={payPrice:f.numberFormat(P),usePoint:f.numberFormat(I),returnDeliveryPrice:f.numberFormat(o),couponName:h,empty:!1}},claimRegist(a){if(!this.serverFlag&&!(!this.oid||!this.claimType))if(this.claimType=="CR")this.doRegist(a);else{if(this.selectedPrd.length<1){const d={message:"상품을 하나 이상 선택하세요"};this.emitter.emit("modalOpen",d);return}let s={};for(const d of this.selectedPrd)s[d]=d;let t=[];for(const d of this.productList)s[d.opId]||t.push(d.opId);if(a.ocIds=t,t.length>0){const d={type:"confirm",message:"선택된 상품을 제외한 모든 상품은 구매확정으로 처리됩니다<br> 동의하시면 확인을 눌러주세요",doAction:()=>{this.doRegist(a)}};this.emitter.emit("modalOpen",d)}else this.doRegist(a)}},doRegist(a){this.serverFlag=!0;const s={oid:this.oid,opIds:this.selectedPrd,claimType:this.claimType,claimMessage:a.claimMessage};!this.priceParams.notPay&&this.claimType!="ER"&&(s.recoverPrice=this.resultReturnData.recoverPrice,s.recoverPoint=this.resultReturnData.recoverPoint,s.recoverCouponId=this.resultReturnData.recoverCoupon=="yes"?this.orderInfo.useCouponId:"",s.recoverDeliveryPrice=this.resultReturnData.returnDeliveryPrice),this.claimType!="CR"&&(s.ocIds=a.ocIds),this.claimType!="ER"&&!this.priceParams.notPay&&(this.priceParams.payMethod=="bank"||this.priceParams.payMethod=="vbank")&&(s.bankName=a.bankName,s.bankAccount=a.bankAccount,s.bankOwner=a.bankOwner),this.emitter.emit("overlay","open"),w.post(B,s,t=>{this.serverFlag=!1,this.emitter.emit("overlay","hide");let d=t.status,i={};if(d=="success"){let c;switch(this.claimType){case"CR":this.priceParams.notPay?c="주문취소 완료 되었습니다":c="주문취소 요청이 접수 되었습니다";break;case"RR":c="반품요청이 접수 되었습니다";break;case"ER":c="교환요청이 접수 되었습니다";break}this.$router.back(),i={message:c}}else i={message:t.data};this.emitter.emit("modalOpen",i)})}}},fs={class:"page-container"};function ks(a,s,t,d,i,c){const m=k("mobileClaim"),v=k("pcClaim");return r(),n("div",fs,[i.mobile?(r(),M(m,{key:0,productList:i.productList,claimType:i.claimType,pointSetting:i.pointSetting,priceParams:i.priceParams,returnParams:i.returnParams,onClaimRegist:c.claimRegist,onCheckProduct:c.checkProduct},null,8,["productList","claimType","pointSetting","priceParams","returnParams","onClaimRegist","onCheckProduct"])):(r(),M(v,{key:1,claimType:i.claimType,productList:i.productList,pointSetting:i.pointSetting,priceParams:i.priceParams,returnParams:i.returnParams,onClaimRegist:c.claimRegist,onCheckProduct:c.checkProduct},null,8,["claimType","productList","pointSetting","priceParams","returnParams","onClaimRegist","onCheckProduct"]))])}const xs=V(vs,[["render",ks],["__scopeId","data-v-97f15983"]]);export{xs as default};
