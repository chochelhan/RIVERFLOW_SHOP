import{A as L,a as A,o as w,p as j,q as E}from"./apiService-aee0d783.js";import{U as P}from"./util-5fdb7bcf.js";import{m as Z,_ as V,r as _,o as l,c as a,a as i,d as h,w as b,t as r,e as u,F as I,b as S,q as U,v as N,g as v,n as D,u as F,p as O,f as R,j as T}from"./index-e9ed42ea.js";import{m as B}from"./mobile-9de1c1d4.js";import"./axios-c24e582b.js";import"./jquery-331624d0.js";const z={props:["params","priceParams","cartList","shippingList","shippingOrgList","setOrderStart","setPriceDataStart"],data(){return{form:null,type:"",util:P,ids:[],memberInfo:{},useCoupon:"",useCouponPrice:0,useCouponList:[],useCouponMessage:"",usePoint:0,maxPoint:0,pointSetting:{},usePointDisabled:!1,pointMessage:[],havePoint:0,usePointPrice:0,shippingId:"",shippingTitle:"",shippingName:"",shippingZip:"",shippingAddr1:"",shippingAddr2:"",shippingPcs:"",shippingPcsError:!1,jibunAddr1:"",defaultShipping:!1,oname:"",opcs:"",oemail:"",opcsError:!1,deliveryMessageId:"",deliveryMessageList:[],deliveryMessage:"",payMethod:"",payMenthodList:[],totalPrice:0,deliveryPrice:0,totalPaymentPrice:0,totalOrderAmt:0,deliveryInfo:{},serviceType:"normal",totalReservePoint:0,deliveryId:"",formHasErrors:!1,totalMaxUsePoint:0,denyReservePoint:"no"}},watch:{shippingId(s){this.setShippingInfo(),this.updatePriceInfo()},useCoupon(){this.updatePriceInfo()},setOrderStart(s){s&&this.setData()},setPriceDataStart(s){s&&(this.priceParams.sendType=="errorCoupon"?(this.usePoint=0,this.useCoupon=""):this.priceParams.sendType=="errorPoint"?this.usePoint=0:(this.deliveryPrice=this.priceParams.deliveryPrice,this.totalPaymentPrice=this.priceParams.totalPaymentPrice,this.memberInfo.id&&(this.denyReservePoint=this.priceParams.denyReservePoint,this.usePoint=this.priceParams.usePoint,this.useCouponPrice=this.priceParams.useCouponPrice,this.usePointPrice=this.priceParams.usePointPrice)),this.$emit("setPriceDataStartFalse",{}))}},created(){this.setClass("sub"),this.setTitle("결제하기");const s=this.$route.params.cartIds;this.ids=s.split(","),this.type=this.$route.params.type;const t=L.getSession();t&&(t!=null&&t.memberInfo)&&(this.memberInfo=t.memberInfo)},methods:{...Z(B,["setClass","setTitle"]),setData(){this.params.payMenthodList&&(this.payMenthodList=this.params.payMenthodList),this.deliveryInfo=this.params.deliveryInfo,this.totalPrice=this.priceParams.totalPrice,this.totalOrderAmt=this.priceParams.totalOrderAmt,this.totalPaymentPrice=this.priceParams.totalPaymentPrice,this.serviceType=this.params.serviceType,this.deliveryId=this.deliveryInfo.deliveryId,this.deliveryPrice=this.deliveryInfo.deliveryPrice,this.memberInfo.id&&(this.oname=this.memberInfo.name,this.opcs=this.memberInfo.pcs?this.memberInfo.pcs:"",this.oemail=this.memberInfo.email?this.memberInfo.email:"",this.totalReservePoint=this.params.totalReservePoint,this.totalMaxUsePoint=this.params.totalMaxUsePoint,this.params.shippingId&&this.serviceType=="normal"&&(this.shippingId=this.params.shippingId),this.useCouponMessage=this.params.useCouponMessage,this.useCouponList=this.params.useCouponList,this.setPointInfo()),this.deliveryMessageList=this.params.deliveryMessageList},setPointInfo(){this.memberInfo.id&&(this.pointSetting=this.params.pointSetting,this.havePoint=this.params.havePoint,this.usePointDisabled=this.params.usePointDisabled,this.maxPoint=this.params.maxPoint,this.pointMessage=this.params.pointMessage)},setShippingInfo(){if(this.shippingId!="direct")for(const s of this.shippingOrgList)this.shippingId==s.id&&(this.shippingName=s.rname,this.shippingPcs=s.rpcs,this.shippingAddr1=s.raddr1,this.shippingAddr2=s.raddr2,this.shippingZip=s.rpost,s.jibunAddr?this.jibunAddr1=s.jibunAddr:this.jibunAddr1=s.raddr1)},checkPoint(){const s=P.price(this.usePoint);if(s){let o=this.usePoint.toString().replace(/,/gi,"");o=o.toString().replace(/-/gi,""),parseInt(o)>parseInt(this.maxPoint)?this.usePoint=P.numberFormat(this.maxPoint):this.usePoint=s}else if(this.usePoint)return"숫자만 입력가능합니다";return!0},updatePriceInfo(){const s={useCoupon:!this.useCoupon||this.useCoupon=="none"?"":this.useCoupon,usePoint:this.usePoint,jibunAddr1:this.jibunAddr1};this.$emit("updatePriceAction",s)},showDaumAddress(){const s=this.$refs.wrap,t=Math.max(document.body.scrollTop,document.documentElement.scrollTop);new window.daum.Postcode({oncomplete:o=>{let d="";o.userSelectedType==="R"?d=o.roadAddress:d=o.jibunAddress,this.shippingZip=o.zonecode,this.shippingAddr1=d,this.jibunAddr1=o.jibunAddress,s.style.display="none",document.body.scrollTop=t,this.updatePriceInfo()},onresize:function(o){},width:"100%",height:"100%"}).embed(s),s.style.display="block"},foldDaumPostcode(){const s=this.$refs.wrap;s.style.display="none"},validate(){if(!this.form||this.opcsError)return;let s="",t="";if(this.shippingPcsError)return;if(s=this.shippingId,(this.shippingId=="direct"||!this.memberInfo.id)&&(s=""),this.deliveryMessageId&&(this.deliveryMessageId=="direct"?t=this.deliveryMessage:t=this.deliveryMessageId),!this.payMethod){let d={message:"결제방법을 선택하세요"};this.emitter.emit("modalOpen",d);return}const o={oname:this.oname,opcs:this.opcs,oemail:this.oemail,shippingId:s,shippingTitle:this.shippingTitle,jibunAddr1:this.jibunAddr1,jibunAddr:this.jibunAddr1,defaultShipping:this.defaultShipping?"yes":"no",rname:this.shippingName,rpcs:this.shippingPcs,raddr1:this.shippingAddr1,raddr2:this.shippingAddr2,rpost:this.shippingZip,rmessage:t,totalPrice:this.totalPaymentPrice,deliveryPrice:this.deliveryPrice,deliveryId:this.deliveryId,useCoupon:!this.useCoupon||this.useCoupon=="none"?"":this.useCoupon,usePoint:this.usePointPrice,serviceType:this.serviceType,paymethod:this.payMethod};this.$emit("paymentAction",o)},shippingIdCheck(){return this.memberInfo.id&&this.shippingList.length<1?this.shippingId?!0:"배송지를 선택하세요":!0},shippingTitleCheck(){return this.memberInfo.id?this.shippingTitle?!0:"배송지명을 입력하세요":!0},shippingNameCheck(){return this.memberInfo.id&&this.shippingId||this.shippingName?!0:"수령인을 입력하세요"},shippingAddr1Check(){return this.memberInfo.id&&this.shippingId||this.shippingAddr1?!0:"주소를 입력하세요"},shippingAddr2Check(){return this.memberInfo.id&&this.shippingId||this.shippingAddr2?!0:"상세주소를 입력하세요"},shippingPcsCheck(){if(this.memberInfo.id&&this.shippingId)return!0;if(this.shippingPcs){let s=this.shippingPcs.toString().replace(/-/gi,"");if(this.shippingPcsError=!0,isNaN(s))return"휴대폰번호는 숫자만 입력가능합니다";{let t=s.substr(0,3),o=s.substr(3,4),d=s.substr(7,4);if(s.length>3&&s.length<8)this.shippingPcs=t+"-"+o;else if(s.length>=8&&s.length<=11)this.shippingPcs=t+"-"+o+"-"+d,this.shippingPcsError=!1;else if(s.length>11)return"잘못된 휴대폰번호 입니다"}return!0}else return"연락처를 입력하세요"},opcsCheck(){if(this.opcs){let s=this.opcs.toString().replace(/-/gi,"");if(this.opcsError=!0,isNaN(s))return"휴대폰번호는 숫자만 입력가능합니다";{let t=s.substr(0,3),o=s.substr(3,4),d=s.substr(7,4);if(s.length>3&&s.length<8)this.opcs=t+"-"+o;else if(s.length>=8&&s.length<=11)this.opcs=t+"-"+o+"-"+d,this.opcsError=!1;else if(s.length>11)return"잘못된 휴대폰번호 입니다"}return!0}else return"연락처를 입력하세요"},onameCheck(){return this.oname?!0:"주문자를 입력하세요"},deliveryMessageCheck(){return this.deliveryMessageId=="direct"?this.deliveryMessage?!0:"내용을 입력하세요":!0},setPayMethod(s){let t=0;for(let o of this.payMenthodList)s==t?(this.payMethod=o.code,o.active="active"):o.active="",t++}}},g=s=>(O("data-v-7ba639e3"),s=s(),R(),s),W={class:"page-container"},q={ref:"wrap",id:"daumFrame"},H={class:"order-container"},G={class:"order-info"},J={style:{padding:"0 20px","border-bottom":"solid 10px #eee"}},K=g(()=>i("div",{class:"info-title",style:{"padding-top":"0"}},"주문자 정보",-1)),Q={class:"shipping-info"},X={id:"oname-position"},Y=g(()=>i("div",{class:"label"},[v(" 주문자"),i("span",null,"*")],-1)),$={class:"field-box"},ee={id:"opcs-position"},ie=g(()=>i("div",{class:"label"},[v(" 연락처"),i("span",null,"*")],-1)),te={class:"field-box"},se=g(()=>i("div",{class:"label"}," 이메일 ",-1)),ne={class:"field-box"},oe={key:0,style:{padding:"0 20px","border-bottom":"solid 10px #eee"}},re={class:"info-title",style:{"padding-top":"30px"}},le={class:"info-ul"},ae={class:"label"},pe={class:"have-point"},de={class:"flex-area"},he={class:"input-box price"},ue={class:"tip"},ce={class:"tip-box"},me={key:0},ge={key:1,style:{padding:"0 20px","border-bottom":"solid 10px #eee"}},ve=g(()=>i("div",{class:"info-title",style:{"padding-bottom":"30px"}},"배송지 정보",-1)),Pe={key:0,class:"info-ul",style:{"padding-top":"0"}},fe=g(()=>i("div",{class:"label"}," 배송지 ",-1)),_e={class:"select-shipping-box"},ye={key:1,class:"shipping-info"},be={key:0,id:"shippingTitle-position"},Ie=g(()=>i("div",{class:"label"},[v(" 배송지명"),i("span",null,"*")],-1)),Se={class:"field-box"},Me={id:"shippingName-position"},ke=g(()=>i("div",{class:"label"},[v(" 수령인"),i("span",null,"*")],-1)),Ce={class:"field-box"},xe={id:"shippingAddr1-position"},Ae=g(()=>i("div",{class:"label",id:"shippingAddr2-position"},[v(" 주소"),i("span",null,"*")],-1)),Le={class:"field-box"},Ve={class:"flex-area"},Te=g(()=>i("span",null,"우편번호 검색",-1)),Ue={id:"shippingPcs-position"},Ne=g(()=>i("div",{class:"label"},[v(" 연락처"),i("span",null,"*")],-1)),De={class:"field-box"},Fe={key:2,class:"shipping-checkbox"},Oe={style:{cursor:"pointer","font-weight":"bold"}},Re={class:"info-ul",id:"deliveryMessageId-position"},we={key:0,id:"deliveryMessage-position"},je=g(()=>i("div",{class:"info-title",style:{padding:"30px 20px 0 20px"}},"결제방법",-1)),Ee={class:"info-ul"},Ze={class:"tab"},Be=["onClick"],ze={class:"report-container"},We=g(()=>i("div",{class:"cart-divide"},null,-1)),qe={class:"cart-box"},He=g(()=>i("div",{class:"cart-title"}," 주문상품정보 ",-1)),Ge={class:"product-list"},Je={class:"img"},Ke=["src"],Qe={class:"info-box"},Xe={class:"pname"},Ye={key:0},$e={class:"price"},ei={key:0,class:"reserve-point"},ii=g(()=>i("span",{class:"reserve-point-icon"},"적립",-1)),ti={key:0,class:"single-option-box"},si=g(()=>i("div",{class:"single-title"},"추가옵션",-1)),ni={class:"single-option-ul"},oi={class:"sopt-name"},ri={key:0,class:"sopt-price"},li={key:1,class:"sopt-soldout"},ai={class:"cart-content"},pi=g(()=>i("div",{class:"c-name"},"총 상품수량",-1)),di={class:"c-value"},hi=g(()=>i("div",{class:"c-name"},"총 주문금액",-1)),ui={class:"c-value"},ci={key:0},mi=g(()=>i("div",{class:"c-name"},"쿠폰 할인",-1)),gi={class:"c-value"},vi={key:1},Pi={class:"c-name"},fi={class:"c-value"},_i={key:2},yi=g(()=>i("div",{class:"c-name"},"배송비",-1)),bi={class:"c-value"},Ii={key:3},Si={class:"c-name"},Mi={class:"c-value"},ki=g(()=>i("div",{class:"c-name"},"총 결제금액",-1)),Ci={class:"c-value total-price"},xi=g(()=>i("span",null,"주문하기",-1));function Ai(s,t,o,d,e,p){const m=_("v-text-field"),y=_("v-btn"),M=_("v-select"),C=_("v-textarea"),x=_("v-form");return l(),a("div",W,[i("div",q,[i("img",{src:"//t1.daumcdn.net/postcode/resource/images/close.png",id:"btnFoldWrap",style:{cursor:"pointer",position:"absolute",right:"0px",top:"-1px","z-index":"1"},onClick:t[0]||(t[0]=(...n)=>p.foldDaumPostcode&&p.foldDaumPostcode(...n)),alt:"접기 버튼"})],512),h(x,{modelValue:e.form,"onUpdate:modelValue":t[17]||(t[17]=n=>e.form=n),class:"order-form",novalidate:"",onSubmit:F(p.validate,["prevent"])},{default:b(()=>[i("div",H,[i("div",G,[i("div",J,[K,i("ul",Q,[i("li",X,[Y,i("div",$,[h(m,{modelValue:e.oname,"onUpdate:modelValue":t[1]||(t[1]=n=>e.oname=n),ref:"oname",rules:[p.onameCheck],placeholder:"주문자 이름",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",ee,[ie,i("div",te,[h(m,{modelValue:e.opcs,"onUpdate:modelValue":t[2]||(t[2]=n=>e.opcs=n),maxLength:"13",ref:"opcs",rules:[p.opcsCheck],placeholder:"휴대폰번호를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",null,[se,i("div",ne,[h(m,{modelValue:e.oemail,"onUpdate:modelValue":t[3]||(t[3]=n=>e.oemail=n),placeholder:"이메일을 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue"])])])])]),e.memberInfo.id?(l(),a("div",oe,[i("div",re,r(e.pointSetting.pointName),1),i("ul",le,[i("li",null,[i("div",ae,[i("div",null,r(e.pointSetting.pointName),1),i("div",pe,"(보유 "+r(e.pointSetting.pointName)+" : "+r(e.util.numberFormat(e.havePoint))+r(e.pointSetting.pointUnit)+") ",1)]),i("div",de,[i("div",he,[h(m,{modelValue:e.usePoint,"onUpdate:modelValue":t[4]||(t[4]=n=>e.usePoint=n),rules:[p.checkPoint],disabled:e.usePointDisabled,suffix:"원",rounded:"",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),h(y,{class:"blackButton",type:"button",onClick:t[5]||(t[5]=n=>p.updatePriceInfo()),disabled:e.usePointDisabled,variant:"outlined",rounded:""},{default:b(()=>[i("span",null,r(e.pointSetting.pointName)+" 적용",1)]),_:1},8,["disabled"])])]),i("li",ue,[i("ul",ce,[e.serviceType=="normal"?(l(),a("li",me,"배송비는 "+r(e.pointSetting.pointName)+"으로 결제할수 없습니다 ",1)):u("",!0),(l(!0),a(I,null,S(e.pointMessage,n=>(l(),a("li",null,r(n),1))),256))])])])])):u("",!0),e.serviceType=="normal"?(l(),a("div",ge,[ve,e.memberInfo.id&&o.shippingList.length>0?(l(),a("ul",Pe,[i("li",null,[fe,i("div",null,[i("div",_e,[h(M,{modelValue:e.shippingId,"onUpdate:modelValue":t[6]||(t[6]=n=>e.shippingId=n),ref:"shippingId",rounded:"",variant:"outlined",rules:[p.shippingIdCheck],items:o.shippingList},null,8,["modelValue","rules","items"])])])])])):u("",!0),!e.memberInfo.id||!e.shippingId||e.shippingId=="direct"?(l(),a("ul",ye,[e.memberInfo.id?(l(),a("li",be,[Ie,i("div",Se,[h(m,{modelValue:e.shippingTitle,"onUpdate:modelValue":t[7]||(t[7]=n=>e.shippingTitle=n),ref:"shippingTitle",rules:[p.shippingTitleCheck],placeholder:"배송지명",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])])):u("",!0),i("li",Me,[ke,i("div",Ce,[h(m,{modelValue:e.shippingName,"onUpdate:modelValue":t[8]||(t[8]=n=>e.shippingName=n),ref:"shippingName",rules:[p.shippingNameCheck],placeholder:"수령인 이름",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",xe,[Ae,i("div",Le,[i("div",Ve,[h(m,{modelValue:e.shippingZip,"onUpdate:modelValue":t[9]||(t[9]=n=>e.shippingZip=n),placeholder:"우편번호",readonly:!0,rounded:"",variant:"outlined"},null,8,["modelValue"]),h(y,{class:"blackButton",type:"button",onClick:t[10]||(t[10]=n=>p.showDaumAddress()),variant:"outlined",rounded:""},{default:b(()=>[Te]),_:1})]),h(m,{modelValue:e.shippingAddr1,"onUpdate:modelValue":t[11]||(t[11]=n=>e.shippingAddr1=n),ref:"shippingAddr1",rules:[p.shippingAddr1Check],readonly:!0,placeholder:"주소를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"]),h(m,{modelValue:e.shippingAddr2,"onUpdate:modelValue":t[12]||(t[12]=n=>e.shippingAddr2=n),ref:"shippingAddr2",rules:[p.shippingAddr2Check],placeholder:"상세주소를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",Ue,[Ne,i("div",De,[h(m,{modelValue:e.shippingPcs,"onUpdate:modelValue":t[13]||(t[13]=n=>e.shippingPcs=n),ref:"shippingPcs",maxLength:"13",rules:[p.shippingPcsCheck],placeholder:"휴대폰번호를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])])])):u("",!0),e.memberInfo.id&&(!e.shippingId||e.shippingId=="direct")?(l(),a("div",Fe,[i("label",Oe,[U(i("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=n=>e.defaultShipping=n)},null,512),[[N,e.defaultShipping]]),v(" 기본 배송지로 등록 ")])])):u("",!0),i("ul",Re,[i("li",null,[h(M,{modelValue:e.deliveryMessageId,"onUpdate:modelValue":t[15]||(t[15]=n=>e.deliveryMessageId=n),variant:"outlined",ref:"deliveryMessageId",rounded:"",items:e.deliveryMessageList,placeholder:"배송시 요청사항을 선택해주세요"},null,8,["modelValue","items"])]),e.deliveryMessageId=="direct"?(l(),a("li",we,[h(C,{modelValue:e.deliveryMessage,"onUpdate:modelValue":t[16]||(t[16]=n=>e.deliveryMessage=n),ref:"deliveryMessage",variant:"outlined",rounded:"",rules:[p.deliveryMessageCheck],rows:"3",placeholder:"내용을 입력해주세요(최대 50자)",maxLength:"50"},null,8,["modelValue","rules"])])):u("",!0)])])):u("",!0),je,i("ul",Ee,[i("li",Ze,[(l(!0),a(I,null,S(e.payMenthodList,(n,f)=>(l(),a("div",{onClick:k=>p.setPayMethod(f),class:D("tab-item "+n.active),key:n.code},r(n.name),11,Be))),128))])])])]),i("div",ze,[We,i("div",qe,[He,i("ul",Ge,[(l(!0),a(I,null,S(o.cartList,n=>(l(),a("li",null,[i("div",Je,[i("img",{src:n.listImg},null,8,Ke)]),i("div",Qe,[i("div",Xe,[v(r(n.pname)+" ",1),n.option_name?(l(),a("span",Ye,"("+r(n.option_name)+")",1)):u("",!0)]),i("div",$e,[v(r(n.camt)+"개 "+r(e.util.numberFormat(n.sellprice))+"원 ",1),e.memberInfo.id&&n.reservePoint>0&&e.denyReservePoint=="no"?(l(),a("div",ei,[ii,v(" "+r(e.util.numberFormat(n.reservePoint))+r(e.pointSetting.pointUnit),1)])):u("",!0)]),n.optionType=="single"&&n.optionResult&&n.optionResult.length>0?(l(),a("div",ti,[si,i("ul",ni,[(l(!0),a(I,null,S(n.optionResult,(f,k)=>(l(),a("li",{key:"spt"+k},[i("div",oi,r(f.option_parent_name)+":"+r(f.option_name),1),f.status=="sale"?(l(),a("div",ri,[i("span",null,r(f.camt)+"개, "+r(e.util.numberFormat(f.sellprice))+"원 ",1)])):(l(),a("div",li," [품절] "))]))),128))])])):u("",!0)])]))),256))]),i("ul",ai,[i("li",null,[pi,i("div",di,r(e.util.numberFormat(e.totalOrderAmt))+"개",1)]),i("li",null,[hi,i("div",ui,r(e.util.numberFormat(e.totalPrice))+"원",1)]),e.memberInfo.id&&e.useCouponList.length>0?(l(),a("li",ci,[mi,i("div",gi,r(e.util.numberFormat(e.useCouponPrice))+"원",1)])):u("",!0),e.memberInfo.id?(l(),a("li",vi,[i("div",Pi,"사용 "+r(e.pointSetting.pointName),1),i("div",fi,r(e.util.numberFormat(e.usePointPrice))+r(e.pointSetting.pointUnit),1)])):u("",!0),e.serviceType=="normal"?(l(),a("li",_i,[yi,i("div",bi,r(e.util.numberFormat(e.deliveryPrice))+"원",1)])):u("",!0),e.memberInfo.id&&e.denyReservePoint=="no"?(l(),a("li",Ii,[i("div",Si,"지급예정 "+r(e.pointSetting.pointUnit),1),i("div",Mi,r(e.util.numberFormat(e.totalReservePoint))+"원",1)])):u("",!0),i("li",null,[ki,i("div",Ci,r(e.util.numberFormat(e.totalPaymentPrice))+"원",1)])]),h(y,{class:"blackButton",type:"submit",variant:"outlined",rounded:""},{default:b(()=>[xi]),_:1})])])]),_:1},8,["modelValue","onSubmit"])])}const Li=V(z,[["render",Ai],["__scopeId","data-v-7ba639e3"]]);const Vi={props:["params","priceParams","cartList","shippingList","shippingOrgList","setOrderStart","setPriceDataStart"],data(){return{form:null,type:"",util:P,ids:[],memberInfo:{},useCoupon:"",useCouponPrice:0,useCouponList:[],useCouponMessage:"",usePoint:0,maxPoint:0,pointSetting:{},usePointDisabled:!1,pointMessage:[],havePoint:0,usePointPrice:0,shippingId:"",shippingTitle:"",shippingName:"",shippingZip:"",shippingAddr1:"",shippingAddr2:"",shippingPcs:"",shippingPcsError:!1,jibunAddr1:"",defaultShipping:!1,oname:"",opcs:"",oemail:"",opcsError:!1,deliveryMessageId:"",deliveryMessageList:[],deliveryMessage:"",payMethod:"",payMenthodList:[],totalPrice:0,deliveryPrice:0,totalPaymentPrice:0,totalOrderAmt:0,deliveryInfo:{},serviceType:"normal",totalReservePoint:0,deliveryId:"",formHasErrors:!1,totalMaxUsePoint:0,denyReservePoint:"no"}},watch:{shippingId(s){this.setShippingInfo(),this.updatePriceInfo()},useCoupon(){this.updatePriceInfo()},setOrderStart(s){s&&this.setData()},setPriceDataStart(s){s&&(this.priceParams.sendType=="errorCoupon"?(this.usePoint=0,this.useCoupon=""):this.priceParams.sendType=="errorPoint"?this.usePoint=0:(this.deliveryPrice=this.priceParams.deliveryPrice,this.totalPaymentPrice=this.priceParams.totalPaymentPrice,this.memberInfo.id&&(this.denyReservePoint=this.priceParams.denyReservePoint,this.usePoint=this.priceParams.usePoint,this.useCouponPrice=this.priceParams.useCouponPrice,this.usePointPrice=this.priceParams.usePointPrice)),this.$emit("setPriceDataStartFalse",{}))}},created(){const s=this.$route.params.cartIds;this.ids=s.split(","),this.type=this.$route.params.type;const t=L.getSession();t&&(t!=null&&t.memberInfo)&&(this.memberInfo=t.memberInfo)},methods:{setData(){this.params.payMenthodList&&(this.payMenthodList=this.params.payMenthodList),this.serviceType=this.params.serviceType,this.serviceType=="normal"&&(this.deliveryInfo=this.params.deliveryInfo,this.deliveryId=this.deliveryInfo.deliveryId,this.deliveryPrice=this.deliveryInfo.deliveryPrice,this.deliveryMessageList=this.params.deliveryMessageList),this.totalPrice=this.priceParams.totalPrice,this.totalOrderAmt=this.priceParams.totalOrderAmt,this.totalPaymentPrice=this.priceParams.totalPaymentPrice,this.memberInfo.id&&(this.oname=this.memberInfo.name,this.opcs=this.memberInfo.pcs?this.memberInfo.pcs:"",this.oemail=this.memberInfo.email?this.memberInfo.email:"",this.totalReservePoint=this.params.totalReservePoint,this.totalMaxUsePoint=this.params.totalMaxUsePoint,this.params.shippingId&&this.serviceType=="normal"&&(this.shippingId=this.params.shippingId),this.useCouponMessage=this.params.useCouponMessage,this.useCouponList=this.params.useCouponList,this.setPointInfo())},setPointInfo(){this.memberInfo.id&&(this.pointSetting=this.params.pointSetting,this.havePoint=this.params.havePoint,this.usePointDisabled=this.params.usePointDisabled,this.maxPoint=this.params.maxPoint,this.pointMessage=this.params.pointMessage)},setShippingInfo(){if(this.shippingId!="direct")for(const s of this.shippingOrgList)this.shippingId==s.id&&(this.shippingName=s.rname,this.shippingPcs=s.rpcs,this.shippingAddr1=s.raddr1,this.shippingAddr2=s.raddr2,this.shippingZip=s.rpost,s.jibunAddr?this.jibunAddr1=s.jibunAddr:this.jibunAddr1=s.raddr1)},checkPoint(){const s=P.price(this.usePoint);if(s){let o=this.usePoint.toString().replace(/,/gi,"");o=o.toString().replace(/-/gi,""),parseInt(o)>parseInt(this.maxPoint)?this.usePoint=P.numberFormat(this.maxPoint):this.usePoint=s}else if(this.usePoint)return"숫자만 입력가능합니다";return!0},updatePriceInfo(){const s={useCoupon:!this.useCoupon||this.useCoupon=="none"?"":this.useCoupon,usePoint:this.usePoint,jibunAddr1:this.jibunAddr1};this.$emit("updatePriceAction",s)},showDaumAddress(){const s=this.$refs.wrap,t=Math.max(document.body.scrollTop,document.documentElement.scrollTop);new window.daum.Postcode({oncomplete:o=>{let d="";o.userSelectedType==="R"?d=o.roadAddress:d=o.jibunAddress,this.shippingZip=o.zonecode,this.shippingAddr1=d,this.jibunAddr1=o.jibunAddress,s.style.display="none",document.body.scrollTop=t,this.updatePriceInfo()},onresize:function(o){},width:"100%",height:"100%"}).embed(s),s.style.display="block"},foldDaumPostcode(){const s=this.$refs.wrap;s.style.display="none"},validate(){if(!this.form||this.opcsError)return;let s="",t="";if(this.shippingPcsError)return;if(s=this.shippingId,(this.shippingId=="direct"||!this.memberInfo.id)&&(s=""),this.deliveryMessageId&&(this.deliveryMessageId=="direct"?t=this.deliveryMessage:t=this.deliveryMessageId),!this.payMethod){let d={message:"결제방법을 선택하세요"};this.emitter.emit("modalOpen",d);return}const o={oname:this.oname,opcs:this.opcs,oemail:this.oemail,shippingId:s,shippingTitle:this.shippingTitle,jibunAddr1:this.jibunAddr1,jibunAddr:this.jibunAddr1,defaultShipping:this.defaultShipping?"yes":"no",rname:this.shippingName,rpcs:this.shippingPcs,raddr1:this.shippingAddr1,raddr2:this.shippingAddr2,rpost:this.shippingZip,rmessage:t,totalPrice:this.totalPaymentPrice,deliveryPrice:this.deliveryPrice,deliveryId:this.deliveryId,useCoupon:!this.useCoupon||this.useCoupon=="none"?"":this.useCoupon,usePoint:this.usePointPrice,serviceType:this.serviceType,paymethod:this.payMethod};this.$emit("paymentAction",o)},shippingIdCheck(){return this.memberInfo.id&&this.shippingList.length<1?this.shippingId?!0:"배송지를 선택하세요":!0},shippingTitleCheck(){return this.memberInfo.id?this.shippingTitle?!0:"배송지명을 입력하세요":!0},shippingNameCheck(){return this.memberInfo.id&&this.shippingId||this.shippingName?!0:"수령인을 입력하세요"},shippingAddr1Check(){return this.memberInfo.id&&this.shippingId||this.shippingAddr1?!0:"주소를 입력하세요"},shippingAddr2Check(){return this.memberInfo.id&&this.shippingId||this.shippingAddr2?!0:"상세주소를 입력하세요"},shippingPcsCheck(){if(this.memberInfo.id&&this.shippingId)return!0;if(this.shippingPcs){let s=this.shippingPcs.toString().replace(/-/gi,"");if(this.shippingPcsError=!0,isNaN(s))return"휴대폰번호는 숫자만 입력가능합니다";{let t=s.substr(0,3),o=s.substr(3,4),d=s.substr(7,4);if(s.length>3&&s.length<8)this.shippingPcs=t+"-"+o;else if(s.length>=8&&s.length<=11)this.shippingPcs=t+"-"+o+"-"+d,this.shippingPcsError=!1;else if(s.length>11)return"잘못된 휴대폰번호 입니다"}return!0}else return"연락처를 입력하세요"},opcsCheck(){if(this.opcs){let s=this.opcs.toString().replace(/-/gi,"");if(this.opcsError=!0,isNaN(s))return"휴대폰번호는 숫자만 입력가능합니다";{let t=s.substr(0,3),o=s.substr(3,4),d=s.substr(7,4);if(s.length>3&&s.length<8)this.opcs=t+"-"+o;else if(s.length>=8&&s.length<=11)this.opcs=t+"-"+o+"-"+d,this.opcsError=!1;else if(s.length>11)return"잘못된 휴대폰번호 입니다"}return!0}else return"연락처를 입력하세요"},onameCheck(){return this.oname?!0:"주문자를 입력하세요"},deliveryMessageCheck(){return this.deliveryMessageId=="direct"?this.deliveryMessage?!0:"내용을 입력하세요":!0},setPayMethod(s){let t=0;for(let o of this.payMenthodList)s==t?(this.payMethod=o.code,o.active="active"):o.active="",t++}}},c=s=>(O("data-v-f81e6490"),s=s(),R(),s),Ti={class:"page-container"},Ui={ref:"wrap",id:"daumFrame"},Ni={class:"order-container"},Di=c(()=>i("div",{class:"sub-title-box"},[i("div",{class:"sub-title"}," 결제하기 ")],-1)),Fi={class:"order-info"},Oi=c(()=>i("div",{class:"info-title",style:{"padding-top":"0","padding-bottom":"20px"}},"주문자 정보",-1)),Ri={class:"shipping-info"},wi=c(()=>i("div",{class:"label"},[v(" 주문자"),i("span",null,"*")],-1)),ji={class:"field-box"},Ei=c(()=>i("div",{class:"label"},[v(" 연락처"),i("span",null,"*")],-1)),Zi={class:"field-box"},Bi=c(()=>i("div",{class:"label"}," 이메일 ",-1)),zi={class:"field-box"},Wi={key:0},qi=c(()=>i("div",{class:"info-title",style:{"padding-top":"0"}},"적립금",-1)),Hi={class:"info-ul"},Gi={class:"label"},Ji={class:"have-point"},Ki={class:"flex-area"},Qi={class:"input-box price"},Xi={class:"tip"},Yi={class:"tip-box"},$i={key:0},et={key:1},it=c(()=>i("div",{class:"info-title",style:{"padding-bottom":"30px"}},"배송지 정보",-1)),tt={key:0,class:"info-ul",style:{"padding-top":"0"}},st=c(()=>i("div",{class:"label"}," 배송지 ",-1)),nt={class:"select-shipping-box"},ot={key:1,class:"shipping-info"},rt={key:0},lt=c(()=>i("div",{class:"label"},[v(" 배송지명"),i("span",null,"*")],-1)),at={class:"field-box"},pt=c(()=>i("div",{class:"label"},[v(" 수령인"),i("span",null,"*")],-1)),dt={class:"field-box"},ht=c(()=>i("div",{class:"label"},[v(" 주소"),i("span",null,"*")],-1)),ut={class:"field-box"},ct={class:"flex-area"},mt=c(()=>i("span",null,"우편번호 검색",-1)),gt=c(()=>i("div",{class:"label"},[v(" 연락처"),i("span",null,"*")],-1)),vt={class:"field-box"},Pt={key:2,class:"shipping-checkbox"},ft={style:{cursor:"pointer","font-weight":"bold"}},_t={class:"info-ul"},yt={key:0},bt=c(()=>i("div",{class:"info-title"},"결제방법",-1)),It={class:"info-ul"},St={class:"tab"},Mt=["onClick"],kt={class:"report-container"},Ct=c(()=>i("div",{class:"cart-divide"},null,-1)),xt={class:"cart-box"},At=c(()=>i("div",{class:"cart-title"}," 주문상품정보 ",-1)),Lt={class:"product-list"},Vt={class:"img"},Tt=["src"],Ut={class:"info-box"},Nt={class:"pname"},Dt={key:0},Ft={class:"price"},Ot={key:0,class:"reserve-point"},Rt=c(()=>i("span",{class:"reserve-point-icon"},"적립",-1)),wt={key:0,class:"single-option-box"},jt=c(()=>i("div",{class:"single-title"},"추가옵션",-1)),Et={class:"single-option-ul"},Zt={class:"sopt-name"},Bt={key:0,class:"sopt-price"},zt={key:1,class:"sopt-soldout"},Wt={class:"cart-content"},qt=c(()=>i("div",{class:"c-name"},"총 상품수량",-1)),Ht={class:"c-value"},Gt=c(()=>i("div",{class:"c-name"},"총 주문금액",-1)),Jt={class:"c-value"},Kt={key:0},Qt=c(()=>i("div",{class:"c-name"},"쿠폰 할인",-1)),Xt={class:"c-value"},Yt={key:1},$t={class:"c-name"},es={class:"c-value"},is={key:2},ts=c(()=>i("div",{class:"c-name"},"배송비",-1)),ss={class:"c-value"},ns={key:3},os={class:"c-name"},rs={class:"c-value"},ls=c(()=>i("div",{class:"c-name"},"총 결제금액",-1)),as={class:"c-value total-price"},ps=c(()=>i("span",null,"주문하기",-1));function ds(s,t,o,d,e,p){const m=_("v-text-field"),y=_("v-btn"),M=_("v-select"),C=_("v-textarea"),x=_("v-form");return l(),a("div",Ti,[i("div",Ui,[i("img",{src:"//t1.daumcdn.net/postcode/resource/images/close.png",id:"btnFoldWrap",style:{cursor:"pointer",position:"absolute",right:"0px",top:"-1px","z-index":"1"},onClick:t[0]||(t[0]=(...n)=>p.foldDaumPostcode&&p.foldDaumPostcode(...n)),alt:"접기 버튼"})],512),h(x,{modelValue:e.form,"onUpdate:modelValue":t[17]||(t[17]=n=>e.form=n),class:"order-form",novalidate:"",onSubmit:F(p.validate,["prevent"])},{default:b(()=>[i("div",Ni,[Di,i("div",Fi,[Oi,i("ul",Ri,[i("li",null,[wi,i("div",ji,[h(m,{modelValue:e.oname,"onUpdate:modelValue":t[1]||(t[1]=n=>e.oname=n),ref:"oname",rules:[p.onameCheck],placeholder:"주문자 이름",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",null,[Ei,i("div",Zi,[h(m,{modelValue:e.opcs,"onUpdate:modelValue":t[2]||(t[2]=n=>e.opcs=n),maxLength:"13",ref:"opcs",rules:[p.opcsCheck],placeholder:"휴대폰번호를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",null,[Bi,i("div",zi,[h(m,{modelValue:e.oemail,"onUpdate:modelValue":t[3]||(t[3]=n=>e.oemail=n),placeholder:"이메일을 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue"])])])]),this.memberInfo.id?(l(),a("div",Wi,[qi,i("ul",Hi,[i("li",null,[i("div",Gi,[i("div",null,r(e.pointSetting.pointName),1),i("div",Ji,"(보유 "+r(e.pointSetting.pointName)+" : "+r(e.util.numberFormat(e.havePoint))+r(e.pointSetting.pointUnit)+") ",1)]),i("div",Ki,[i("div",Qi,[h(m,{modelValue:e.usePoint,"onUpdate:modelValue":t[4]||(t[4]=n=>e.usePoint=n),rules:[p.checkPoint],disabled:e.usePointDisabled,suffix:"원",rounded:"",variant:"outlined"},null,8,["modelValue","rules","disabled"])]),h(y,{class:"blackButton",type:"button",onClick:t[5]||(t[5]=n=>p.updatePriceInfo()),disabled:e.usePointDisabled,variant:"outlined",rounded:""},{default:b(()=>[i("span",null,r(e.pointSetting.pointName)+" 적용",1)]),_:1},8,["disabled"])])]),i("li",Xi,[i("ul",Yi,[e.serviceType=="normal"?(l(),a("li",$i,"배송비는 "+r(e.pointSetting.pointName)+"으로 결제할수 없습니다 ",1)):u("",!0),(l(!0),a(I,null,S(e.pointMessage,n=>(l(),a("li",null,r(n),1))),256))])])])])):u("",!0),e.serviceType=="normal"?(l(),a("div",et,[it,e.memberInfo.id&&o.shippingList.length>0?(l(),a("ul",tt,[i("li",null,[st,i("div",null,[i("div",nt,[h(M,{modelValue:e.shippingId,"onUpdate:modelValue":t[6]||(t[6]=n=>e.shippingId=n),ref:"shippingId",rounded:"",variant:"outlined",rules:[p.shippingIdCheck],items:o.shippingList},null,8,["modelValue","rules","items"])])])])])):u("",!0),!e.memberInfo.id||!e.shippingId||e.shippingId=="direct"?(l(),a("ul",ot,[e.memberInfo.id?(l(),a("li",rt,[lt,i("div",at,[h(m,{modelValue:e.shippingTitle,"onUpdate:modelValue":t[7]||(t[7]=n=>e.shippingTitle=n),ref:"shippingTitle",rules:[p.shippingTitleCheck],placeholder:"배송지명",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])])):u("",!0),i("li",null,[pt,i("div",dt,[h(m,{modelValue:e.shippingName,"onUpdate:modelValue":t[8]||(t[8]=n=>e.shippingName=n),ref:"shippingName",rules:[p.shippingNameCheck],placeholder:"수령인 이름",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",null,[ht,i("div",ut,[i("div",ct,[h(m,{modelValue:e.shippingZip,"onUpdate:modelValue":t[9]||(t[9]=n=>e.shippingZip=n),placeholder:"우편번호",readonly:!0,rounded:"",variant:"outlined"},null,8,["modelValue"]),h(y,{class:"blackButton",type:"button",onClick:t[10]||(t[10]=n=>p.showDaumAddress()),variant:"outlined",rounded:""},{default:b(()=>[mt]),_:1})]),h(m,{modelValue:e.shippingAddr1,"onUpdate:modelValue":t[11]||(t[11]=n=>e.shippingAddr1=n),ref:"shippingAddr1",rules:[p.shippingAddr1Check],readonly:!0,placeholder:"주소를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"]),h(m,{modelValue:e.shippingAddr2,"onUpdate:modelValue":t[12]||(t[12]=n=>e.shippingAddr2=n),ref:"shippingAddr2",rules:[p.shippingAddr2Check],placeholder:"상세주소를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])]),i("li",null,[gt,i("div",vt,[h(m,{modelValue:e.shippingPcs,"onUpdate:modelValue":t[13]||(t[13]=n=>e.shippingPcs=n),ref:"shippingPcs",maxLength:"13",rules:[p.shippingPcsCheck],placeholder:"휴대폰번호를 입력하세요",rounded:"",variant:"outlined"},null,8,["modelValue","rules"])])])])):u("",!0),e.memberInfo.id&&(!e.shippingId||e.shippingId=="direct")?(l(),a("div",Pt,[i("label",ft,[U(i("input",{type:"checkbox","onUpdate:modelValue":t[14]||(t[14]=n=>e.defaultShipping=n)},null,512),[[N,e.defaultShipping]]),v(" 기본 배송지로 등록 ")])])):u("",!0),i("ul",_t,[i("li",null,[h(M,{modelValue:e.deliveryMessageId,"onUpdate:modelValue":t[15]||(t[15]=n=>e.deliveryMessageId=n),variant:"outlined",ref:"deliveryMessageId",rounded:"",items:e.deliveryMessageList,placeholder:"배송시 요청사항을 선택해주세요"},null,8,["modelValue","items"])]),e.deliveryMessageId=="direct"?(l(),a("li",yt,[h(C,{modelValue:e.deliveryMessage,"onUpdate:modelValue":t[16]||(t[16]=n=>e.deliveryMessage=n),ref:"deliveryMessage",variant:"outlined",rounded:"",rules:[p.deliveryMessageCheck],rows:"3",placeholder:"내용을 입력해주세요(최대 50자)",maxLength:"50"},null,8,["modelValue","rules"])])):u("",!0)])])):u("",!0),bt,i("ul",It,[i("li",St,[(l(!0),a(I,null,S(e.payMenthodList,(n,f)=>(l(),a("div",{onClick:k=>p.setPayMethod(f),class:D("tab-item "+n.active),key:n.code},r(n.name),11,Mt))),128))])])])]),i("div",kt,[Ct,i("div",xt,[At,i("ul",Lt,[(l(!0),a(I,null,S(o.cartList,n=>(l(),a("li",null,[i("div",Vt,[i("img",{src:n.listImg},null,8,Tt)]),i("div",Ut,[i("div",Nt,[v(r(n.pname)+" ",1),n.option_name?(l(),a("span",Dt,"("+r(n.option_name)+")",1)):u("",!0)]),i("div",Ft,[v(r(n.camt)+"개 "+r(e.util.numberFormat(n.sellprice))+"원 ",1),e.memberInfo.id&&n.reservePoint>0&&e.denyReservePoint=="no"?(l(),a("div",Ot,[Rt,v(" "+r(e.util.numberFormat(n.reservePoint))+r(e.pointSetting.pointUnit),1)])):u("",!0)]),n.optionType=="single"&&n.optionResult&&n.optionResult.length>0?(l(),a("div",wt,[jt,i("ul",Et,[(l(!0),a(I,null,S(n.optionResult,(f,k)=>(l(),a("li",{key:"spt"+k},[i("div",Zt,r(f.option_parent_name)+":"+r(f.option_name),1),f.status=="sale"?(l(),a("div",Bt,[i("span",null,r(f.camt)+"개, "+r(e.util.numberFormat(f.sellprice))+"원 ",1)])):(l(),a("div",zt," [품절] "))]))),128))])])):u("",!0)])]))),256))]),i("ul",Wt,[i("li",null,[qt,i("div",Ht,r(e.util.numberFormat(e.totalOrderAmt))+"개",1)]),i("li",null,[Gt,i("div",Jt,r(e.util.numberFormat(e.totalPrice))+"원",1)]),e.memberInfo.id&&e.useCouponList.length>0?(l(),a("li",Kt,[Qt,i("div",Xt,r(e.util.numberFormat(e.useCouponPrice))+"원",1)])):u("",!0),e.memberInfo.id?(l(),a("li",Yt,[i("div",$t,"사용 "+r(e.pointSetting.pointName),1),i("div",es,r(e.util.numberFormat(e.usePointPrice))+r(e.pointSetting.pointUnit),1)])):u("",!0),e.serviceType=="normal"?(l(),a("li",is,[ts,i("div",ss,r(e.util.numberFormat(e.deliveryPrice))+"원",1)])):u("",!0),e.memberInfo.id&&e.denyReservePoint=="no"?(l(),a("li",ns,[i("div",os,"지급예정 "+r(e.pointSetting.pointName),1),i("div",rs,r(e.util.numberFormat(e.totalReservePoint))+r(e.pointSetting.pointUnit),1)])):u("",!0),i("li",null,[ls,i("div",as,r(e.util.numberFormat(e.totalPaymentPrice))+"원",1)])]),h(y,{class:"blackButton",type:"submit",variant:"outlined",rounded:""},{default:b(()=>[ps]),_:1})])])]),_:1},8,["modelValue","onSubmit"])])}const hs=V(Vi,[["render",ds],["__scopeId","data-v-f81e6490"]]);const us={components:{mobileOrder:Li,pcOrder:hs},data(){return{mobile:!1,params:{},priceParams:{},cartList:[],util:P,ids:[],memberInfo:{},type:"",deliveryInfo:{},serviceType:"normal",shippingList:[],shippingOrgList:[],shippingId:"",setOrderStart:!1,setPriceDataStart:!1,useCouponPrice:0,useCoupon:"",usePoint:0,jibunAddr1:"",deliveryId:"",serverFlag:!1,IMP:"",pgSetting:"",pgInitFlag:!1}},created(){this.mobile=this.$isMobile();const s=this.$route.params.cartIds;for(const o of s.split(","))o&&this.ids.push(o);this.type=this.$route.params.type;const t=L.getSession();t&&(t!=null&&t.memberInfo)&&(this.memberInfo=t.memberInfo),this.getData()},methods:{setPriceDataStartFalse(){this.setPriceDataStart=!1},getData(){A.post(w,{ids:this.ids,type:this.type},s=>{if(s.status=="success"){if(s.data.cartList.length<1){this.$router.push("/");return}for(let t of s.data.cartList){if(t.gamt<1){this.$router.push("/");return}this.cartList.push(t)}if(s.data.serviceType=="normal"&&(this.deliveryInfo=s.data.deliveryInfo),this.params.deliveryInfo=s.data.deliveryInfo,this.params.orderSetting=s.data.orderSetting,s.data.orderSetting&&s.data.orderSetting.paymethods){this.params.payMenthodList=[];for(const t of s.data.orderSetting.paymethods){let o={name:s.data.paymethodNames[t],code:t,active:""};this.params.payMenthodList.push(o)}}if(this.priceParams.totalPrice=s.data.totalPrice,this.priceParams.totalOrderAmt=s.data.totalOrderAmt,this.priceParams.totalPaymentPrice=s.data.totalPaymentPrice,this.totalPrice=s.data.totalPrice,this.totalOrderAmt=s.data.totalOrderAmt,this.totalPaymentPrice=s.data.totalPaymentPrice,this.params.serviceType=s.data.serviceType,this.serviceType=s.data.serviceType,this.params.serviceType=s.data.serviceType,this.serviceType=="normal"&&(this.deliveryId=this.deliveryInfo.deliveryId,this.params.deliveryId=this.deliveryInfo.deliveryId,this.priceParams.deliveryPrice=this.deliveryInfo.deliveryPrice,this.deliveryPrice=this.deliveryInfo.deliveryPrice),this.memberInfo.id){if(this.params.totalReservePoint=s.data.totalReservePoint,this.params.totalMaxUsePoint=s.data.totalMaxUsePoint,this.serviceType=="normal"&&s.data.shippingList){for(let t of s.data.shippingList){this.shippingOrgList.push(t);let o="["+t.title+"] ";o+=t.rname+" "+t.rpcs+" ("+t.rpost+") "+t.raddr1+" "+t.raddr2,this.shippingList.push({title:o,value:t.id}),t.defaultShipping=="yes"&&(this.shippingId=t.id)}s.data.shippingList.length>0&&this.shippingList.push({title:"직접입력",value:"direct"}),this.shippingId&&(this.params.shippingId=this.shippingId)}if(this.params.useCouponList=[],s.data.couponList&&s.data.couponList.length>0){this.params.useCouponMessage="사용가능 쿠폰 "+s.data.couponList.length+" 장",this.params.useCouponList.push({title:" 쿠폰 사용안함",value:"none"});for(let t of s.data.couponList){let o;t.discountType=="rate"?(o="할인율 "+t.discountRate+"%",t.discountRatePrice&&(o+=" 최대 "+P.numberFormat(t.discountRatePrice)+"원 할인")):o=t.discountPrice+"원 할인";let d={title:t.cname+" ("+o+")",value:t.id};this.params.useCouponList.push(d)}}this.setPointInfo(s)}this.params.deliveryMessageList=[],this.params.deliveryMessageList.push({title:"배송메세지를 선택하세요",value:""}),this.params.deliveryMessageList.push({title:"경비실에 맞겨주세요",value:"경비실에 맞겨주세요"}),this.params.deliveryMessageList.push({title:"문앞에 놓아주세요",value:"문앞에 놓아주세요"}),this.params.deliveryMessageList.push({title:"도착 1시간 전에 전화주세요",value:"도착 1시간 전에 전화주세요"}),this.params.deliveryMessageList.push({title:"직접입력",value:"direct"}),this.setOrderStart=!0}else{let t={};t={message:"잘못된 접근입니다",doAction:()=>{this.$router.push("/")}},this.emitter.emit("modalOpen",t)}})},setPointInfo(s){if(this.memberInfo.id){this.params.pointSetting=s.data.pointSetting,this.params.havePoint=parseInt(s.data.havePoint),this.params.havePoint<1?this.params.usePointDisabled=!0:this.params.maxPoint=parseInt(s.data.havePoint),this.params.pointMessage=[];let t;if(this.params.pointSetting.usePointMinPriceUse=="yes"&&parseInt(this.priceParams.totalPrice)<parseInt(this.params.pointSetting.usePointMinPrice)&&(this.params.usePointDisabled=!0,t="배송비를 제외한 결제금액이 "+P.numberFormat(this.params.pointSetting.usePointMinPrice)+"원 이상일때만 "+this.params.pointSetting.pointName+" 사용이 가능합니다",this.params.pointMessage.push(t)),this.params.pointSetting.usePointMinUse=="yes"&&(t="최소 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(this.params.pointSetting.usePointMin)+this.params.pointSetting.pointUnit,this.params.pointMessage.push(t),this.params.havePoint<parseInt(this.params.pointSetting.usePointMin)&&(this.params.usePointDisabled=!0)),this.params.pointSetting.usePointMaxUse=="yes"){let o=this.priceParams.totalPrice*(parseInt(this.params.pointSetting.usePointMax)/100);o=Math.floor(o),t="최대 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(o)+this.params.pointSetting.pointUnit,this.params.pointMessage.push(t),this.params.maxPoint>parseInt(o)&&(this.params.maxPoint=parseInt(o))}if(this.params.maxPoint>parseInt(this.params.totalMaxUsePoint)&&(this.params.maxPoint=parseInt(this.params.totalMaxUsePoint)),this.params.pointSetting.denyPoint)for(const o of this.params.pointSetting.denyPoint)o=="pp"?(t="일부라도  "+this.params.pointSetting.pointName+"으로 결제하는 상품은  "+this.params.pointSetting.pointName+"을 지급하지 않습니다",this.params.pointMessage.push(t)):o=="cp"&&(t="일부라도 쿠폰할인으로 결제하는 상품은  "+this.params.pointSetting.pointName+"을 지급하지 않습니다",this.params.pointMessage.push(t))}},updatePriceAction(s){this.useCoupon=s.useCoupon,this.usePoint=s.usePoint,this.jibunAddr1=s.jibunAddr1,this.updatePriceInfo()},updatePriceInfo(){let s=0;if(this.usePoint){let d=this.usePoint.toString().replace(/,/gi,"");if(d=d.toString().replace(/-/gi,""),isNaN(d)?s=0:s=parseInt(d),this.params.pointSetting.usePointMinUse=="yes"&&s<parseInt(this.params.pointSetting.usePointMin)){let p={message:"최소 사용가능 "+this.params.pointSetting.pointName+" "+P.numberFormat(this.params.pointSetting.usePointMin)+this.params.pointSetting.pointUnit+" 이상 입력하세요"};this.emitter.emit("modalOpen",p);return}}const t={ids:this.ids,type:this.type,deliveryId:this.deliveryId,useCoupon:!this.useCoupon||this.useCoupon=="none"?"":this.useCoupon,usePoint:s,jibunAddr1:this.jibunAddr1};A.post(j,t,o=>{if(o.data.pointError){let d="";switch(o.data.pointError){case"wrongUsePoint":d="잘못된 "+this.params.pointSetting.pointName+" 정보입니다";break;case"wrongSetting":d="배송비를 제외한 결제금액이 "+P.numberFormat(this.params.pointSetting.usePointMinPrice)+"원 이상일때만 "+this.params.pointSetting.pointName+" 사용이 가능합니다";break;case"minPoint":d="최소 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(this.params.pointSetting.usePointMin)+this.params.pointSetting.pointUnit+" 이상 입력하세요";break;case"maxPoint":d="최대 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(this.params.maxPoint)+this.params.pointSetting.pointUnit+" 이하로 입력하세요";break}let e={message:d};this.emitter.emit("modalOpen",e),this.usePoint=0,this.priceParams.sendType="errorPoint",this.setPriceDataStart=!0;return}if(o.data.couponError){let d={message:"잘못된 쿠폰정보입니다"};this.useCoupon="",this.usePoint=0,this.emitter.emit("modalOpen",d),this.priceParams.sendType="errorCoupon",this.setPriceDataStart=!0;return}this.serviceType=="normal"?o.data.deliveryResult&&(this.priceParams.deliveryPrice=o.data.deliveryResult.resultPrice):(this.priceParams.deliveryPrice=0,this.deliveryPrice=0),this.priceParams.totalPaymentPrice=parseInt(o.data.totalPrice)+this.deliveryPrice,this.memberInfo.id&&(this.priceParams.sendType="success",this.priceParams.denyReservePoint=o.data.denyReservePoint,this.priceParams.usePoint=o.data.usePointPrice,this.priceParams.useCouponPrice=o.data.useCouponPrice,this.priceParams.usePointPrice=o.data.usePointPrice),console.log(this.priceParams),this.setPriceDataStart=!0})},validate(s){this.serverFlag||(this.serverFlag=!0,s.ids=this.ids,s.type=this.type,this.emitter.emit("overlay","open"),A.post(E,s,t=>{if(this.serverFlag=!1,this.emitter.emit("overlay","hide"),t.status=="message"){let o="";switch(t.data){case"notEqualPrice":o="잘못된 총 결제금액 입니다";break;case"wrongUsePoint":o="잘못된 적립금 정보입니다";break;case"wrongSetting":o="배송비를 제외한 결제금액이 "+P.numberFormat(this.params.pointSetting.usePointMinPrice)+"원 이상일때만 "+this.params.pointSetting.pointName+" 사용이 가능합니다";break;case"minPoint":o="최소 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(this.params.pointSetting.usePointMin)+this.params.pointSetting.pointUnit+" 이상 입력하세요";break;case"maxPoint":o="최대 사용가능 "+this.params.pointSetting.pointName+" : "+P.numberFormat(this.params.maxPoint)+this.params.pointSetting.pointUnit+" 이하로 입력하세요";break;case"notCoupon":o="잘못된 쿠폰정보입니다";break}let d={message:o};this.emitter.emit("modalOpen",d)}else if(t.data.paymethod=="bank"){let o={message:"주문서 작성이 완료되었습니다",doAction:()=>{this.$router.push("/orderComplete/"+t.data.id)}};this.emitter.emit("modalOpen",o)}}))}}},cs={class:"page-container"};function ms(s,t,o,d,e,p){const m=_("mobileOrder"),y=_("pcOrder");return l(),a("div",cs,[e.mobile?(l(),T(m,{key:0,params:e.params,priceParams:e.priceParams,cartList:e.cartList,shippingList:e.shippingList,shippingOrgList:e.shippingOrgList,setOrderStart:e.setOrderStart,setPriceDataStart:e.setPriceDataStart,onSetPriceDataStartFalse:p.setPriceDataStartFalse,onUpdatePriceAction:p.updatePriceAction,onPaymentAction:p.validate},null,8,["params","priceParams","cartList","shippingList","shippingOrgList","setOrderStart","setPriceDataStart","onSetPriceDataStartFalse","onUpdatePriceAction","onPaymentAction"])):(l(),T(y,{key:1,params:e.params,priceParams:e.priceParams,cartList:e.cartList,shippingList:e.shippingList,shippingOrgList:e.shippingOrgList,setOrderStart:e.setOrderStart,setPriceDataStart:e.setPriceDataStart,onSetPriceDataStartFalse:p.setPriceDataStartFalse,onUpdatePriceAction:p.updatePriceAction,onPaymentAction:p.validate},null,8,["params","priceParams","cartList","shippingList","shippingOrgList","setOrderStart","setPriceDataStart","onSetPriceDataStartFalse","onUpdatePriceAction","onPaymentAction"]))])}const bs=V(us,[["render",ms],["__scopeId","data-v-18d4d55b"]]);export{bs as default};
