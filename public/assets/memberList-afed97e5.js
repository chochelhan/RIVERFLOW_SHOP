import{g as A,h as P,i as N,a as x,j as T,k as B,l as F}from"./apiService-0aea4262.js";import{U as S}from"./util-5fdb7bcf.js";import{s as R}from"./shopTable-d56388e3.js";import{a as V}from"./apiService-aee0d783.js";import{_ as C,r as h,o as g,c as y,d as n,w as u,a as i,t as D,e as w,g as _,n as f,u as E,p as I,f as L,j as z}from"./index-e9ed42ea.js";import"./axios-c24e582b.js";import"./jquery-331624d0.js";const Y={props:["id"],data(){return{form:null,changePassShow:!1,changePcsShow:!1,uid:"",upass:"",nowupass:"",reUpass:"",name:"",pcs:"",authPcs:"",nick:"",show1:!1,show2:!1,settingInfo:{},pcsAuth:"",uidAuth:"",uidDouble:!1,nickDouble:!1,nickError:!1,pcsError:!1,authNumberValidate:!1,serverFlag:!1,pcsErrorMessage:"",passValidte:{eng:"",number:"",lentype:"",equal:"",han:""}}},created(){this.getData()},methods:{getData(){V.post(A,{id:this.id},s=>{if(s.data){const e=s.data.memberInfo;console.log(e),this.uid=e.uid,this.nick=e.nick,this.name=e.name,this.pcs=e.pcs,s.data.memberSetting&&(this.settingInfo=s.data.memberSetting.member)}})},validate(){if(this.form){if(this.nickDouble&&this.settingInfo.nickUse=="yes"||this.nickError&&this.settingInfo.nickUse=="yes")return;if(this.changePassShow){for(const e in this.passValidte)if(this.passValidte[e]!="active"){let l={message:"비밀번호를 확인하세요"};this.emitter.emit("modalOpen",l);return}}let s={name:this.name,nick:this.nick,id:this.id};this.settingInfo.authType=="pcs"?this.changePcsShow&&(s.pcs=this.pcs):this.pcs&&(s.pcs=this.pcs),this.changePassShow&&(s.nowupass=this.nowupass,s.upass=this.upass),this.modifyActive(s)}},modifyActive(s){this.serverFlag||(this.emitter.emit("overlay","open"),this.serverFlag=!0,V.post(P,s,e=>{this.serverFlag=!1,this.emitter.emit("overlay","hide");let l=e.status,a={};if(l=="success")a={message:"회원정보가 변경되었습니다",doAction:()=>{this.$emit("reload")}};else{let t="";switch(e.data){case"wrongNowpass":t="잘못된 현재 비밀번호 입니다";break}a={message:t}}this.emitter.emit("modalOpen",a)}))},nameErrors(s){return s?!0:"이름을 입력하세요"},nickErrors(s){if(this.settingInfo.nickRequired=="yes"&&!s)return"닉네임을 입력하세요";if(this.nickError=!1,this.nick)if(/^[ㄱ-ㅎ|가-힣|a-z|A-Z|0-9|]{2,10}$/.test(this.nick))V.asyncPost(N,{id:this.id,nick:this.nick}).then(a=>{a.data.data=="disable"?this.nickDouble=!0:this.nickDouble=!1});else return"닉네임은 한글,영문,숫자 2~10자 만 가능합니다";return!0},pcsErrors(s){if(this.settingInfo.pcsRequired=="yes"&&!s)return"휴대폰번호를 입력하세요";if(this.pcs){let e=this.pcs.toString().replace(/-/gi,"");if(this.pcsError=!0,isNaN(e))return"휴대폰번호는 숫자만 입력가능합니다";{let l=e.substr(0,3),a=e.substr(3,4),t=e.substr(7,4);if(e.length>3&&e.length<8)this.pcs=l+"-"+a;else if(e.length>=8&&e.length<=11)this.pcs=l+"-"+a+"-"+t,this.pcsError=!1;else if(e.length>11)return"잘못된 휴대폰번호 입니다"}}return!0},upassErrors(s){if(!s)return"비밀번호를 입력하세요";s.length>=8&&s.length<=20?this.passValidte.lentype="active":this.passValidte.lentype="";let e=/\d{1}/,l=e.test(this.upass);return this.passValidte.number=l?"active":"",e=/[a-zA-Z]/,l=e.test(this.upass),this.passValidte.eng=l?"active":"",e=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/,l=e.test(this.upass),l?(errors.push("비밀번호에 한글을 사용할수 없습니다"),this.passValidte.han=""):this.passValidte.han="active",!0},reUpassErrors(s){return s?(this.upass==this.reUpass?this.passValidte.equal="active":this.passValidte.equal="",!0):"비밀번호를 다시 입력하세요"},nowupassErrors(s){return s?!0:"현재비밀번호를 입력하세요"},pcsAuthErrors(s){return s?!0:"인증번호를 입력하세요"}}},c=s=>(I("data-v-c8d2f55e"),s=s(),L(),s),q={class:"login-container"},O={class:"input-ul"},j={style:{display:"flex",height:"70px"}},G=c(()=>i("div",{class:"label",style:{width:"110px","padding-top":"5px"}},"이메일",-1)),K={class:"input-text-box",style:{"font-weight":"bold",color:"#000","font-size":"16px"}},Z=c(()=>i("div",{class:"label"},"이름",-1)),H={key:0},J=c(()=>i("div",{class:"label"},"닉네임",-1)),Q={class:"input-text-box"},W={key:0,class:"error-message"},X={key:1},$=c(()=>i("div",{class:"label"},"휴대폰 번호",-1)),ee={key:2,style:{display:"flex",height:"90px"}},te=c(()=>i("div",{class:"label",style:{"min-width":"110px","padding-top":"15px"}},"비밀번호",-1)),se=c(()=>i("div",{class:"input-text-box",style:{"padding-top":"10px","font-weight":"bold",color:"#000","font-size":"16px"}}," ********** ",-1)),ie={class:"auth-item"},le={class:"upd-button-box"},ae={key:3},oe={class:"label",style:{display:"flex"}},ne=c(()=>i("span",{style:{"font-size":"12px"}},"취소",-1)),de={class:"pass-validate"},re=c(()=>i("span",null,"영문포함",-1)),me={class:"icon"},ue=c(()=>i("span",null,"숫자포함",-1)),ce={class:"icon"},he=c(()=>i("span",null,"8-20자",-1)),pe={class:"icon"},_e=c(()=>i("span",null,"일치",-1)),fe={class:"icon"},ge={class:"button-row"},ve=c(()=>i("span",null,"회원정보 수정",-1));function ye(s,e,l,a,t,o){const p=h("v-text-field"),v=h("v-btn"),m=h("font-awesome-icon"),k=h("v-form");return g(),y("div",q,[n(k,{modelValue:t.form,"onUpdate:modelValue":e[10]||(e[10]=r=>t.form=r),novalidate:"",onSubmit:E(o.validate,["prevent"])},{default:u(()=>[i("ul",O,[i("li",j,[G,i("div",K,D(t.uid),1)]),i("li",null,[Z,n(p,{rules:[o.nameErrors],variant:"outlined",rounded:"",placeholder:"이름을 입력해주세요",modelValue:t.name,"onUpdate:modelValue":e[0]||(e[0]=r=>t.name=r)},null,8,["rules","modelValue"])]),t.settingInfo.nickUse=="yes"?(g(),y("li",H,[J,i("div",Q,[n(p,{rules:[o.nickErrors],variant:"outlined",rounded:"",placeholder:"닉네임을 입력해주세요",modelValue:t.nick,"onUpdate:modelValue":e[1]||(e[1]=r=>t.nick=r)},null,8,["rules","modelValue"]),t.nickDouble?(g(),y("div",W,"중복된 닉네임 입니다")):w("",!0)])])):w("",!0),t.settingInfo.pcsUse=="yes"?(g(),y("li",X,[$,n(p,{rules:[o.pcsErrors],rounded:"",variant:"outlined",maxLength:"13",placeholder:"휴대폰번호를 입력해주세요",modelValue:t.pcs,"onUpdate:modelValue":e[2]||(e[2]=r=>t.pcs=r)},null,8,["rules","modelValue"])])):w("",!0),t.changePassShow?(g(),y("li",ae,[i("div",oe,[_(" 비밀번호 변경 "),n(v,{onClick:e[4]||(e[4]=r=>t.changePassShow=!1),style:{"margin-top":"-3px","margin-left":"20px","max-width":"40px","max-height":"25px"},class:"whiteButton",type:"button",variant:"outlined"},{default:u(()=>[ne]),_:1})]),n(p,{type:"password",variant:"outlined",rounded:"","append-icon":t.show2?"mdi-eye":"mdi-eye-off",rules:[o.nowupassErrors],"onClick:append":e[5]||(e[5]=r=>t.show2=!t.show2),modelValue:t.nowupass,"onUpdate:modelValue":e[6]||(e[6]=r=>t.nowupass=r),placeholder:"현재비밀번호를 입력해주세요"},null,8,["append-icon","type","rules","modelValue"]),n(p,{type:"password",variant:"outlined",rounded:"","append-icon":t.show1?"mdi-eye":"mdi-eye-off",rules:[o.upassErrors],"onClick:append":e[7]||(e[7]=r=>t.show1=!t.show1),modelValue:t.upass,"onUpdate:modelValue":e[8]||(e[8]=r=>t.upass=r),placeholder:"비밀번호를 입력해주세요"},null,8,["append-icon","type","rules","modelValue"]),n(p,{type:"password",variant:"outlined",rounded:"",style:{"margin-top":"-5px"},rules:[o.reUpassErrors],modelValue:t.reUpass,"onUpdate:modelValue":e[9]||(e[9]=r=>t.reUpass=r),placeholder:"다시 입력해주세요"},null,8,["rules","modelValue"]),i("ul",de,[i("li",{class:f(t.passValidte.eng)},[re,i("div",me,[n(m,{class:"checked-icon",icon:"fa-solid fa-check"})])],2),i("li",{class:f(t.passValidte.number)},[ue,i("div",ce,[n(m,{class:"checked-icon",icon:"fa-solid fa-check"})])],2),i("li",{class:f(t.passValidte.lentype)},[he,i("div",pe,[n(m,{class:"checked-icon",icon:"fa-solid fa-check"})])],2),i("li",{class:f(t.passValidte.equal)},[_e,i("div",fe,[n(m,{class:"checked-icon",icon:"fa-solid fa-check"})])],2)])])):(g(),y("li",ee,[te,se,i("div",ie,[i("div",le,[n(v,{class:"send-button",type:"button",onClick:e[3]||(e[3]=r=>t.changePassShow=!0),color:"#000",rounded:"",variant:"outlined"},{default:u(()=>[_("비밀번호 변경 ")]),_:1})])])]))]),i("div",ge,[n(v,{type:"submit",rounded:"",class:"submit-button"},{default:u(()=>[ve]),_:1})])]),_:1},8,["modelValue","onSubmit"])])}const be=C(Y,[["render",ye],["__scopeId","data-v-c8d2f55e"]]);const we={components:{shopTable:R,memberView:be},props:["accept"],watch:{datalimit(s){this.getDataList(1)}},data(){return{tableShow:!1,util:S,columns:[{name:"선택",id:"id",sort:!1,width:60,type:"allCheckbox"},{name:"번호",id:"number",sort:!1,width:60},{name:"이름",id:"name",width:120,sort:!0,textStyle:{"text-align":"center"},type:"underline-action",action:"memberView"},{name:"아이디",id:"uid",width:120,textStyle:{"text-align":"center"},type:"underline-action",action:"memberView"},{name:"이메일",id:"email",width:120}],ids:[],fixed:0,memberList:[],levelList:[{title:"등급 전체",value:""}],levelNames:{},level:"",paging:{total:"",links:[],currentPage:1,lastPage:1},page:1,datalimit:20,dataSort:{field:"id",sort:"desc"},keywordCmd:"name",keywordCmdList:[{title:"이름",value:"name"},{title:"아이디",value:"uid"}],keyword:"",stdate:"",endate:"",dateCmd:"created_at",datalimitList:[{title:"10개",value:10},{title:"20개",value:20},{title:"30개",value:30},{title:"50개",value:50},{title:"100개",value:100}],dayClass:{to:"",yer:"",thr:"active",week:"",mon:"",tmon:""},selectedId:"",mstatus:"ing",memberViewDialog:!1,mId:"",memberSetting:{},buttonTitle:""}},created(){this.accept&&(this.mstatus=this.accept),this.buttonTitle=this.mstatus=="out"?"선택회원 삭제":"선택회원 탈퇴",this.setDay("tmon"),this.getData(1)},methods:{setDay(s){for(let o in this.dayClass)o==s?this.dayClass[o]="active":this.dayClass[o]="";const e=new Date;let l=e.getMonth()+1,a=e.getDate();const t=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);switch(this.endate=t,s){case"to":this.stdate=t;break;case"yer":e.setDate(a-1),l=e.getMonth()+1,a=e.getDate(),this.stdate=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);break;case"thr":e.setDate(a-3),l=e.getMonth()+1,a=e.getDate(),this.stdate=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);break;case"week":e.setDate(a-7),l=e.getMonth()+1,a=e.getDate(),this.stdate=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);break;case"mon":e.setMonth(l-1),l=e.getMonth(),a=e.getDate(),this.stdate=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);break;case"tmon":e.setMonth(l-3),l=e.getMonth(),a=e.getDate(),this.stdate=e.getFullYear()+"-"+(l<10?"0"+l:l)+"-"+(a<10?"0"+a:a);break}},searchReset(){this.keywordCmd="name",this.keyword="",this.stdate="",this.endate="",this.level="",this.dateCmd="created_at",this.setDay("tmon")},memberView(s){this.mId=s.id,this.memberViewDialog=!0},getSearchParams(s){return this.page=s,{orderByField:this.dataSort.field,orderBySort:this.dataSort.sort,limit:this.datalimit,mstatus:this.mstatus,page:s,keywordCmd:this.keywordCmd,keyword:this.keyword,stdate:this.stdate,endate:this.endate,dateCmd:this.dateCmd,level:this.level}},getData(s){const e=this.getSearchParams(s);x.post(T,e,l=>{var t;for(let o of l.data.list.levelList)this.levelNames[o.id]=o.gname,this.levelList.push({title:o.gname,value:o.id});if((t=l.data.memberSetting)!=null&&t.member){if(this.memberSetting=l.data.memberSetting.member,this.memberSetting.nickUse=="yes"){let o={name:"닉네임",id:"nick",width:100};this.columns.push(o)}if(this.memberSetting.pcsUse=="yes"){let o={name:"연락처",id:"pcs",width:100};this.columns.push(o)}}let a={name:"등급",id:"lvid",width:100};this.columns.push(a),a={name:"보유적립금",id:"point",width:100,sort:!0},this.columns.push(a),a={name:"등록일",id:"created_at",sort:!0,width:120},this.columns.push(a),this.setDataList(l.data.list.memberList),this.tableShow=!0})},getDataList(s){const e=this.getSearchParams(s);x.post(B,e,l=>{this.setDataList(l.data)})},setDataList(s){this.memberList=[],this.paging={total:s.total,links:s.links,currentPage:s.current_page,lastPage:s.last_page};const e=parseInt(s.total)-this.datalimit*(parseInt(s.current_page)-1);let l=0;for(let a of s.data)a.number=e-l,a.lvid=this.levelNames[a.lvid],a.point=S.numberFormat(a.point),a.created_at=a.created_at.substring(0,10),this.memberList.push(a),l++},pageMove(s){this.getDataList(s.page)},tableEventAction(s){switch(s.type){case"dataSort":this.dataSort=s.sort,this.getDataList(1);break}},search(){this.getDataList(1)},reloadList(){this.getDataList(this.page),this.memberViewDialog=!1},checkDataList(s){this.ids=[];for(let e in s)this.ids.push(e)},userStatusUpdate(){let s={};if(this.ids.length<1){s={message:"회원을 하나 이상 선택하세요"},this.emitter.emit("modalOpen",s);return}let e="탈퇴";this.mstatus=="out"&&(e="삭제"),this.emitter.emit("modalOpen",{type:"confirm",message:"선택된 회원을 "+e+" 시키겠습니까?",doAction:()=>{const l={ids:this.ids,mstatus:this.mstatus};this.emitter.emit("overlay","open"),x.post(F,l,a=>{this.emitter.emit("overlay","hide"),this.getDataList(this.page);let t={message:"선택된 회원이 "+e+" 되었습니다"};this.emitter.emit("modalOpen",t)})}})}}},b=s=>(I("data-v-754c0dd6"),s=s(),L(),s),ke={class:"table-box"},xe={class:"search-box"},Ve={class:"table-search",cellspacing:"0",cellpadding:"0",border:"0"},De=b(()=>i("th",null,"등급",-1)),Se=b(()=>i("th",null,"검색어",-1)),Ce={class:"select-box",style:{display:"flex"}},Ee={class:"input-box",style:{"margin-left":"20px",width:"300px"}},Ie=b(()=>i("th",null,"등록일 검색",-1)),Le={style:{display:"flex"}},Me={class:"date-box"},Ue={style:{display:"flex","margin-left":"10px"}},Ae={style:{width:"160px"}},Pe=b(()=>i("div",{style:{width:"30px","text-align":"center","line-height":"50px",height:"50px"}},"~ ",-1)),Ne={style:{width:"160px"}},Te={class:"button-row"},Be=b(()=>i("span",null,"초기화",-1)),Fe=b(()=>i("span",null,"검색",-1)),Re={style:{display:"flex",padding:"0 10px","justify-content":"space-between","z-index":"20"}},ze={class:"sub-title"},Ye={class:"select-box",style:{display:"flex","max-height":"50px",padding:"4px 0"}},qe={class:"total"},Oe={class:"modal-layout",style:{height:"760px"}},je={class:"modal-header"},Ge=b(()=>i("div",{class:"modal-title"},"회원 정보",-1)),Ke={class:"modal-body",style:{height:"700px",padding:"40px"}};function Ze(s,e,l,a,t,o){const p=h("v-select"),v=h("v-text-field"),m=h("v-btn"),k=h("shopTable"),r=h("font-awesome-icon"),M=h("member-view"),U=h("v-dialog");return g(),y("div",ke,[i("form",{novalidate:"",onSubmit:e[12]||(e[12]=E((...d)=>o.search&&o.search(...d),["prevent"]))},[i("div",xe,[i("table",Ve,[i("tbody",null,[i("tr",null,[De,i("td",null,[n(p,{modelValue:t.level,"onUpdate:modelValue":e[0]||(e[0]=d=>t.level=d),density:"compact",variant:"outlined",style:{"max-width":"200px"},items:t.levelList},null,8,["modelValue","items"])])]),i("tr",null,[Se,i("td",null,[i("div",Ce,[n(p,{modelValue:t.keywordCmd,"onUpdate:modelValue":e[1]||(e[1]=d=>t.keywordCmd=d),density:"compact",variant:"outlined",style:{"max-width":"150px"},items:t.keywordCmdList},null,8,["modelValue","items"]),i("div",Ee,[n(v,{density:"compact",variant:"outlined",modelValue:t.keyword,"onUpdate:modelValue":e[2]||(e[2]=d=>t.keyword=d)},null,8,["modelValue"])])])])]),i("tr",null,[Ie,i("td",null,[i("div",Le,[i("div",Me,[n(m,{variant:"outlined",class:f("white-button "+t.dayClass.to),onClick:e[3]||(e[3]=d=>o.setDay("to"))},{default:u(()=>[_("오늘 ")]),_:1},8,["class"]),n(m,{variant:"outlined",class:f("white-button "+t.dayClass.yer),onClick:e[4]||(e[4]=d=>o.setDay("yer"))},{default:u(()=>[_(" 어제 ")]),_:1},8,["class"]),n(m,{variant:"outlined",class:f("white-button "+t.dayClass.thr),onClick:e[5]||(e[5]=d=>o.setDay("thr"))},{default:u(()=>[_(" 3일 ")]),_:1},8,["class"]),n(m,{variant:"outlined",class:f("white-button "+t.dayClass.week),onClick:e[6]||(e[6]=d=>o.setDay("week"))},{default:u(()=>[_(" 1주일 ")]),_:1},8,["class"]),n(m,{variant:"outlined",class:f("white-button "+t.dayClass.mon),onClick:e[7]||(e[7]=d=>o.setDay("mon"))},{default:u(()=>[_(" 1개월 ")]),_:1},8,["class"]),n(m,{variant:"outlined",class:f("white-button "+t.dayClass.tmon),onClick:e[8]||(e[8]=d=>o.setDay("tmon"))},{default:u(()=>[_(" 3개월 ")]),_:1},8,["class"])]),i("div",Ue,[i("div",Ae,[n(v,{type:"date",modelValue:t.stdate,"onUpdate:modelValue":e[9]||(e[9]=d=>t.stdate=d),density:"compact",variant:"outlined"},null,8,["modelValue"])]),Pe,i("div",Ne,[n(v,{type:"date",density:"compact",variant:"outlined",modelValue:t.endate,"onUpdate:modelValue":e[10]||(e[10]=d=>t.endate=d)},null,8,["modelValue"])])])])])])])])]),i("div",Te,[n(m,{class:"white-button",variant:"outlined",onClick:e[11]||(e[11]=d=>o.searchReset())},{default:u(()=>[Be]),_:1}),n(m,{class:"search-button",type:"submit",variant:"outlined"},{default:u(()=>[Fe]),_:1})])],32),i("div",Re,[i("div",ze,[_("회원 리스트 "),n(m,{variant:"outlined",color:"#006064",style:{width:"120px","margin-left":"20px","max-height":"30px"},rounded:"",onClick:e[13]||(e[13]=d=>o.userStatusUpdate())},{default:u(()=>[_(D(t.buttonTitle),1)]),_:1})]),i("div",Ye,[i("div",qe,"전체 회원수 "+D(t.util.numberFormat(t.paging.total))+"명",1),n(p,{modelValue:t.datalimit,"onUpdate:modelValue":e[14]||(e[14]=d=>t.datalimit=d),density:"compact","bg-color":"#fff",style:{"max-width":"100px"},items:t.datalimitList},null,8,["modelValue","items"])])]),t.tableShow?(g(),z(k,{key:0,datas:t.memberList,fixed:t.fixed,onPageMove:o.pageMove,onMemberView:o.memberView,onParentEvent:o.tableEventAction,columns:t.columns,paging:t.paging,onCheckDataList:o.checkDataList},null,8,["datas","fixed","onPageMove","onMemberView","onParentEvent","columns","paging","onCheckDataList"])):w("",!0),n(U,{modelValue:t.memberViewDialog,"onUpdate:modelValue":e[16]||(e[16]=d=>t.memberViewDialog=d),width:"600",persistent:"",rounded:"",style:{"z-index":"100"}},{default:u(()=>[i("div",Oe,[i("div",je,[Ge,i("div",{class:"modal-close",onClick:e[15]||(e[15]=d=>t.memberViewDialog=!1)},[n(r,{icon:"fa-solid fa-circle-xmark"})])]),i("div",Ke,[n(M,{onReload:o.reloadList,id:t.mId},null,8,["onReload","id"])])])]),_:1},8,["modelValue"])])}const tt=C(we,[["render",Ze],["__scopeId","data-v-754c0dd6"]]);export{tt as default};
