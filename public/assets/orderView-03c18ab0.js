import{m as w,_ as x,r as v,o as d,c as r,a as t,g as f,t as e,F as L,b,d as m,e as y,w as D,p as N,f as I}from"./index-e9ed42ea.js";import{a as S}from"./admin-36cebdfb.js";import{a as O,aF as P,aC as R}from"./apiService-0aea4262.js";import{U as g}from"./util-5fdb7bcf.js";const k={props:["oid"],data(){return{util:g,productList:[],info:{},totalProductPrice:0,statusList:{},opids:[],ostatusList:{},ostatusCancleList:{},ostatusReturnList:{},ostatusExchangeList:{},ostatusRefundList:{},sendNumber:"",payMenthod:"",historyList:[],changeOstatusList:[],changeOstatus:"",deliveryCompany:"",deliveryCompanyList:[],orgOstatus:"",createdAt:"",deliveryShow:!1,dCompany:"",dNumber:"",deliveryCompanyNames:{},usePoint:0,useCouponPrice:0,deliveryInputShow:!1}},created(){this.setPageMenuName("주문상세"),this.getData()},methods:{...w(S,["setPageMenuName"]),setChangeStatusList(){switch(this.changeOstatusList=[{title:"주문상태 선택",value:""}],this.orgOstatus){case"notpay":this.changeOstatusList.push({title:"입금완료",value:"income"});break;case"income":this.changeOstatusList.push({title:"배송준비중",value:"DR"}),this.changeOstatusList.push({title:"미입금",value:"notpay"});break;case"DR":this.changeOstatusList.push({title:"배송중",value:"DI"}),this.changeOstatusList.push({title:"입금완료",value:"income"});break;case"DI":this.changeOstatusList.push({title:"배송완료",value:"DC"}),this.changeOstatusList.push({title:"배송준비중",value:"DR"});break;case"DC":this.changeOstatusList.push({title:"구매확정",value:"OC"}),this.changeOstatusList.push({title:"배송중",value:"DI"});break;case"OC":this.changeOstatusList.push({title:"배송완료",value:"DC"});break}},getData(){const l={id:this.oid};O.post(P,l,o=>{var u;if(this.info=o.data.orderInfo,this.info.deliveryId&&o.data.deliveryInfo&&((u=o.data.deliveryInfo)==null?void 0:u.dmethod)=="auto"?this.deliveryInputShow=!0:this.deliveryInputShow=!1,this.info.usePoint&&(this.usePoint="-"+g.numberFormat(this.info.usePoint)),this.info.useCouponPrice&&(this.useCouponPrice="-"+g.numberFormat(this.info.useCouponPrice)),this.ostatusList=o.data.ostatusList,this.statusList=o.data.ostatusData,this.ostatusCancleList=o.data.ostatusCancleList,this.ostatusReturnList=o.data.ostatusReturnList,this.ostatusExchangeList=o.data.ostatusExchangeList,this.ostatusRefundList=o.data.ostatusRefundList,this.payMenthod=o.data.paymethodList[this.info.paymethod],o.data.duseCompany){this.deliveryCompanyList=[{title:"배송업체 선택",value:""}];for(const i of o.data.duseCompany){let s={title:i.name,value:i.id};this.deliveryCompanyList.push(s),this.deliveryCompanyNames[i.id]=i.name}}this.setDataList(o.data)})},setDataList(l){this.productList=[];let o=0,u;for(let i of l.productList){switch(u=i.created_at.substring(0,10),i.serviceName=i.serviceType=="normal"?"배송상품군":"서비스상품군",i.statusName=this.getStatusName(i.ostatus),i.ostatus){case"income":this.orgOstatus=i.ostatus;break;case"notpay":this.orgOstatus=i.ostatus;break;case"DR":this.orgOstatus=i.ostatus;break;case"DI":this.orgOstatus=i.ostatus,this.deliveryInputShow&&(this.deliveryShow=!0);break;case"DC":this.orgOstatus=i.ostatus,this.deliveryInputShow&&(this.deliveryShow=!0);break;case"OC":this.orgOstatus=i.ostatus,this.deliveryInputShow&&(this.deliveryShow=!0);break}let s=parseInt(i.payprice),h="";if(i.optionSingleInfos){let p=JSON.parse(i.optionSingleInfos),_=[];for(const c of p)c.required=="N"&&(s+=c.sellprice,_.push(c.option_parent_name+":"+c.option_name+" ("+c.camt+"개)"));h=_.join(",")}i.add_opt_name=h,i.payTotalPrice=s,o=o+parseInt(i.payTotalPrice),this.productList.push(i)}this.deliveryShow&&(this.dCompany=this.deliveryCompanyNames[this.info.deliveryCompany],this.dNumber=this.info.sendNumber),this.createdAt=u,this.totalProductPrice=o,this.setChangeStatusList(),this.historyList=[];for(let i of l.orderHistory){if(i.created_at){let s=i.created_at.split(".");i.created_at=s[0].replace("T"," ")}i.oldStatusName=this.getStatusName(i.oldstatus),i.nowStatusName=this.getStatusName(i.nowstatus),this.historyList.push(i)}},reloadPrudctList(l){this.info=l.orderInfo,this.setDataList(l)},getStatusName(l){if(l){if(this.ostatusList[l])return this.ostatusList[l];if(this.ostatusCancleList[l])return this.ostatusCancleList[l];if(this.ostatusReturnList[l])return this.ostatusReturnList[l];if(this.ostatusExchangeList[l])return this.ostatusExchangeList[l];if(this.ostatusRefundList[l])return this.ostatusRefundList[l]}},updateOstatus(){let l={};if(!this.changeOstatus){l={message:"변경할 주문상태를 선택하세요"},this.emitter.emit("modalOpen",l);return}let o="";if(this.changeOstatus=="DI"&&this.deliveryInputShow&&this.orgOstatus=="DR"){if(!this.deliveryCompany||!this.sendNumber){l={message:"배송정보를 확인하세요"},this.emitter.emit("modalOpen",l);return}o={},o[this.info.id]={sendNumber:this.sendNumber,deliveryCompany:this.deliveryCompany},o=JSON.stringify(o)}const u={ids:[this.oid],type:"single",ostatus:this.changeOstatus,deliveryData:o};this.emitter.emit("overlay","open"),O.post(R,u,i=>{this.emitter.emit("overlay","hide"),this.statusList=i.data.ostatusData,this.reloadPrudctList(i.data),this.$emit("reload"),this.changeOstatus="",l={message:"주문상태를 변경하였습니다"},this.emitter.emit("modalOpen",l)})}}},n=l=>(N("data-v-47bc0474"),l=l(),I(),l),E={class:"page-container"},V={class:"product-regist"},A={class:"product-title",style:{display:"flex","justify-content":"space-between"}},T={class:"gtitle"},F=n(()=>t("span",null,"주문번호",-1)),Z={class:"product-form"},M={class:"table-search bold-tbl",style:{"border-radius":"0"},cellspacing:"0",cellpadding:"0",border:"0"},U={style:{"border-left":"none","text-align":"center"}},j={key:0,style:{color:"orangered"}},B={key:1,style:{color:"#0D47A1"}},H={class:"product-regist"},J=n(()=>t("div",{class:"product-title"},"주문상품 정보",-1)),q={class:"product-form"},z={class:"table-list",cellspacing:"0",cellpadding:"0",border:"0"},G=n(()=>t("thead",null,[t("tr",null,[t("th",{style:{width:"60px"}}," 번호 "),t("th",{style:{width:"100px"}},"이미지"),t("th",{style:{width:"200px"}},"상품명"),t("th",{style:{width:"350px"}},"옵션명"),t("th",{style:{width:"100px"}},"구매수량"),t("th",null,"추가옵션명"),t("th",{style:{width:"100px"}},"판매가"),t("th",{style:{width:"100px"}},"주문상태")])],-1)),K=["src"],Q={style:{"border-right":"none !important"}},W={key:0,class:"status-change-box",style:{"padding-top":"20px"}},X={class:"select-box"},Y={key:0,class:"delivery-number-box"},$={class:"select-box",style:{position:"relative","z-index":"101"}},tt={class:"input-box"},st={class:"button-box",style:{"max-width":"120px"}},et={key:0,style:{width:"100%"}},it={class:"product-regist"},ot=n(()=>t("div",{class:"product-title"},"배송 정보",-1)),lt={class:"product-form"},nt={class:"table-search",style:{"border-radius":"0"},cellspacing:"0",cellpadding:"0",border:"0"},at=n(()=>t("th",null,"배송업체",-1)),dt=n(()=>t("th",{style:{"border-left":"solid 1px #999"}},"송장번호",-1)),rt={style:{display:"flex","justify-content":"space-between"}},ut={style:{width:"49%"}},ct={class:"product-regist"},ht=n(()=>t("div",{class:"product-title"},"주문자 정보",-1)),pt={class:"product-form"},_t={class:"table-search",style:{"border-radius":"0"},cellspacing:"0",cellpadding:"0",border:"0"},mt=n(()=>t("th",null,"주문자명",-1)),yt=n(()=>t("th",null,"휴대전화",-1)),vt=n(()=>t("th",null,"이메일",-1)),ft={class:"product-regist"},gt=n(()=>t("div",{class:"product-title"},"결제정보",-1)),Lt={class:"product-form"},bt={class:"table-search",style:{"border-radius":"0"},cellspacing:"0",cellpadding:"0",border:"0"},Ot=n(()=>t("th",null,"결제금액",-1)),Ct={class:"price"},wt=n(()=>t("th",null,"결제방법",-1)),xt={class:"price"},Dt=n(()=>t("th",null,"상품금액",-1)),Nt={class:"price"},It=n(()=>t("th",null,"쿠폰할인",-1)),St={class:"price"},Pt=n(()=>t("th",null,"적립금사용",-1)),Rt={class:"price"},kt=n(()=>t("th",null,"배송비",-1)),Et={class:"price"},Vt={style:{width:"49%"}},At={class:"product-regist"},Tt=n(()=>t("div",{class:"product-title"},"수령자 정보",-1)),Ft={class:"product-form"},Zt={class:"table-search",style:{"border-radius":"0"},cellspacing:"0",cellpadding:"0",border:"0"},Mt=n(()=>t("th",null,"수령자명",-1)),Ut=n(()=>t("th",null,"휴대전화",-1)),jt=n(()=>t("th",null,"배송지 주소",-1)),Bt=n(()=>t("th",null,"배송메모",-1)),Ht={key:0,class:"product-regist"},Jt=n(()=>t("div",{class:"product-title"},"주문정보 History",-1)),qt={class:"product-form"},zt={class:"history-list"},Gt={class:"date"},Kt={class:"content"};function Qt(l,o,u,i,s,h){const p=v("v-select"),_=v("v-text-field"),c=v("v-btn");return d(),r("div",E,[t("div",V,[t("div",A,[t("div",T,[f("주문 정보 ("),F,f(" : "+e(s.info.order_code)+")",1)]),t("span",null,"주문일 : "+e(s.createdAt),1)]),t("div",Z,[t("table",M,[t("tbody",null,[t("tr",null,[t("td",U,[s.info.ostatus=="notpay"?(d(),r("div",j," 미입금 ")):(d(),r("div",B," 입금완료 "))]),t("td",null," 배송준비중 "+e(s.statusList.DR?s.statusList.DR:0),1),t("td",null," 배송중 "+e(s.statusList.DI?s.statusList.DI:0),1),t("td",null," 배송완료 "+e(s.statusList.DC?s.statusList.DC:0),1),t("td",null," 구매확정 "+e(s.statusList.OC?s.statusList.OC:0),1),t("td",null," 취소 "+e(s.statusList.CZ?s.statusList.CZ:0),1),t("td",null," 반품 "+e(s.statusList.RZ?s.statusList.RZ:0),1),t("td",null," 교환 "+e(s.statusList.EZ?s.statusList.EZ:0),1),t("td",null," 환불 "+e(s.statusList.FZ?s.statusList.FZ:0),1)])])])])]),t("div",H,[J,t("div",q,[t("table",z,[G,t("tbody",null,[(d(!0),r(L,null,b(s.productList,(a,C)=>(d(),r("tr",null,[t("td",null,e(s.productList.length-C),1),t("td",null,[t("img",{src:a.listImg,style:{"max-height":"30px"}},null,8,K)]),t("td",null,e(a.pname),1),t("td",null,e(a.opt_name),1),t("td",null,e(a.oamt),1),t("td",null,e(a.add_opt_name),1),t("td",null,e(s.util.numberFormat(a.payTotalPrice)),1),t("td",Q,e(a.statusName),1)]))),256))])]),s.orgOstatus&&s.orgOstatus!="OC"?(d(),r("div",W,[t("div",X,[m(p,{variant:"outlined",modelValue:s.changeOstatus,"onUpdate:modelValue":o[0]||(o[0]=a=>s.changeOstatus=a),density:"compact",style:{width:"160px"},items:s.changeOstatusList},null,8,["modelValue","items"])]),s.changeOstatus=="DI"&&s.orgOstatus=="DR"&&s.deliveryInputShow?(d(),r("div",Y,[t("div",$,[m(p,{density:"compact",style:{width:"160px"},variant:"outlined",modelValue:s.deliveryCompany,"onUpdate:modelValue":o[1]||(o[1]=a=>s.deliveryCompany=a),items:s.deliveryCompanyList},null,8,["modelValue","items"])]),t("div",tt,[m(_,{variant:"outlined",style:{width:"200px"},density:"compact",modelValue:s.sendNumber,"onUpdate:modelValue":o[2]||(o[2]=a=>s.sendNumber=a),rules:[()=>!!s.sendNumber||"송장번호를 입력하세요"]},null,8,["modelValue","rules"])])])):y("",!0),t("div",st,[m(c,{class:"white-button",style:{"max-width":"120px",height:"40px"},onClick:o[3]||(o[3]=a=>h.updateOstatus()),variant:"outlined"},{default:D(()=>[f("주문상태 변경 ")]),_:1})])])):y("",!0)])]),s.deliveryShow?(d(),r("div",et,[t("div",it,[ot,t("div",lt,[t("table",nt,[t("tbody",null,[t("tr",null,[at,t("td",null,e(s.dCompany),1),dt,t("td",null,e(s.dNumber),1)])])])])])])):y("",!0),t("div",rt,[t("div",ut,[t("div",ct,[ht,t("div",pt,[t("table",_t,[t("tbody",null,[t("tr",null,[mt,t("td",null,e(s.info.oname),1)]),t("tr",null,[yt,t("td",null,e(s.info.opcs),1)]),t("tr",null,[vt,t("td",null,e(s.info.oemail),1)])])])])]),t("div",ft,[gt,t("div",Lt,[t("table",bt,[t("tbody",null,[t("tr",null,[Ot,t("td",Ct,e(s.util.numberFormat(s.info.price)),1)]),t("tr",null,[wt,t("td",xt,e(s.payMenthod),1)]),t("tr",null,[Dt,t("td",Nt,e(s.util.numberFormat(s.totalProductPrice)),1)]),t("tr",null,[It,t("td",St,e(s.useCouponPrice),1)]),t("tr",null,[Pt,t("td",Rt,e(s.usePoint),1)]),t("tr",null,[kt,t("td",Et,e(s.util.numberFormat(s.info.deliveryPrice)),1)])])])])])]),t("div",Vt,[t("div",At,[Tt,t("div",Ft,[t("table",Zt,[t("tbody",null,[t("tr",null,[Mt,t("td",null,e(s.info.rname),1)]),t("tr",null,[Ut,t("td",null,e(s.info.rpcs),1)]),t("tr",null,[jt,t("td",null," ("+e(s.info.rpost)+") "+e(s.info.raddr1)+" "+e(s.info.raddr2),1)]),t("tr",null,[Bt,t("td",null,e(s.info.rmessage),1)])])])])]),s.historyList.length>0?(d(),r("div",Ht,[Jt,t("div",qt,[t("ul",zt,[(d(!0),r(L,null,b(s.historyList,a=>(d(),r("li",null,[t("div",Gt,"["+e(a.created_at)+"]",1),t("div",Kt,e(a.pname)+" "+e(a.opt_name)+" ["+e(a.oldStatusName)+"] => ["+e(a.nowStatusName)+"] 상태 변경 ",1)]))),256))])])])):y("",!0)])])])}const ts=x(k,[["render",Qt],["__scopeId","data-v-47bc0474"]]);export{ts as o};
