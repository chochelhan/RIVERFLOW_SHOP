import{a as L,t as E,u as O,v as R,w as F,x as V}from"./apiService-0aea4262.js";import{_ as U,r as C,o as l,c as h,a as n,d as u,w as v,n as k,g as p,F as x,b as S,t as m,u as N,e as _,j as y,q as D,W as A,p as M,f as G}from"./index-e9ed42ea.js";import"./axios-c24e582b.js";const Y={data(){return{form:null,baseCategoryId:"newCategory",categoryList:[],categoryRegistTitle:"카테고리 상세설정",categoryId:"",cname:"",code:"",cuse:"yes",buttonTitle:"저장",rootActive:"active",pcode:"",depth:1,sequenceParams:{type:"",id:"",index:0,subIndex:0,subSubIndex:0},serverFlag:!1}},created(){this.getData()},methods:{cnameErrors(t){return t?!0:"카테고리명을 입력하세요"},getData(){this.serverFlag||(this.serverFlag=!0,L.post(E,{},t=>{this.serverFlag=!1,this.categoryList=[];for(let e of t.data)e.active="",e.open=!1,this.categoryList.push(e)}))},boxToggle(t){this.choiceCategory(t,"toggle")},choiceCategory(t,e){let c={},i=0;for(let s of this.categoryList){if(s.id==t?(s.active="active",c=s,e!="toggle"?s.open||(s.open=!0):s.open?s.open=!1:s.open=!0,this.sequenceParams={type:"main",id:s.id,index:i,subIndex:0,subSubIndex:0}):s.active="",s.subList){let a=0;for(let o of s.subList){if(o.id==t?(o.active="active",c=o,e!="toggle"?o.open||(o.open=!0):o.open?o.open=!1:o.open=!0,s.subList[a]=o,this.sequenceParams={type:"sub",id:o.id,index:i,subIndex:a,subSubIndex:0}):o.active="",o.subList){let f=0;for(let g of o.subList)g.id==t?(g.active="active",c=g,this.sequenceParams={type:"subSub",id:g.id,index:i,subIndex:a,subSubIndex:f}):g.active="",f++}a++}}i++}if(t=="root"){this.rootActive="active",this.depth=1,this.pcode="root",this.categoryId="",this.sequenceParams={type:"",id:"",index:0,subIndex:0,subSubIndex:0};return}else this.rootActive="",this.categoryId=c.id,this.pcode=c.code,this.depth=parseInt(c.depth)+1,this.cname=c.cname,this.cuse=c.cuse,this.code=c.code},addCategory(){if(this.depth>3){const i={message:"더이상 하위카테고리를 추가할수 없습니다"};this.emitter.emit("modalOpen",i);return}if(this.serverFlag)return;this.pcode||(this.pcode="root"),this.rootActive="";const t=this.baseCategoryId;let e=0;for(let i of this.categoryList){if(i.active="",this.categoryId==i.id&&(i.subList||(i.subList=[]),i.subList.push({cname:"새 카테고리",id:t,active:"active",open:!0}),i.open=!0,this.categoryList[e]=i),i.subList)for(let s of i.subList){if(s.active="",s.subList)for(let a of s.subList)a.active="";this.categoryId==s.id&&(s.subList||(s.subList=[]),s.subList.push({cname:"새 카테고리",id:t,active:"active"}))}e++}this.depth==1&&this.categoryList.push({cname:"새 카테고리",id:t,active:"active"}),this.categoryId=t;const c=new Date;this.code="c"+c.getTime(),this.cname="새 카테고리",this.cuse="no",this.validate()},reset(){this.categoryId="",this.categoryList.splice(this.categoryList.length-1,1)},deleteCategory(t,e){if(this.categoryList[e].subList&&this.categoryList[e].subList.length>0){const c={message:"하위 카테고리가 존재하므로 삭제할수 없습니다"};this.emitter.emit("modalOpen",c);return}this.deleteConfirm("main",t,e)},deleteSubCategory(t,e,c){if(this.categoryList[e].subList[c].subList&&this.categoryList[e].subList[c].subList.length>0){const i={message:"하위 카테고리가 존재하므로 삭제할수 없습니다"};this.emitter.emit("modalOpen",i);return}this.deleteConfirm("sub",t,e,c)},deleteSubSubCategory(t,e,c,i){this.deleteConfirm("subSub",t,e,c,i)},deleteConfirm(t,e,c,i,s){const a={type:"confirm",message:"선택된 카테고리을 삭제하시겠습니까?",doAction:()=>{this.deleteAction(t,e,c,i,s)}};this.emitter.emit("modalOpen",a)},deleteAction(t,e,c,i,s){this.serverFlag||(this.serverFlag=!0,this.emitter.emit("overlay","open"),L.post(O,{id:e},a=>{if(this.serverFlag=!1,this.emitter.emit("overlay","hide"),a.status=="success"){const o={message:"선택된 카테고리가 삭제되었습니다"};this.emitter.emit("modalOpen",o),this.removeCategoryList(t,e,c,i,s),this.categoryId==e&&this.choiceCategory(this.categoryList[0].id)}else{const o={message:"선택된 카테고리에 상품이 존재하므로 삭제할수 없습니다"};this.emitter.emit("modalOpen",o)}}))},removeCategoryList(t,e,c,i,s){switch(t){case"main":this.categoryList.splice(c,1);break;case"sub":this.categoryList[c].subList.splice(i,1);break;case"subSub":this.categoryList[c].subList[i].subList.splice(s,1);break}},validate(){if(this.form){let t={cname:this.cname,cuse:this.cuse},e=F;if(this.categoryId&&this.categoryId!=this.baseCategoryId?(e=V,t.id=this.categoryId):(t.depth=this.depth,t.pcode=this.pcode,t.code=this.code),this.serverFlag)return;this.serverFlag=!0,this.emitter.emit("overlay","open"),L.post(e,t,c=>{if(this.serverFlag=!1,this.emitter.emit("overlay","hide"),c.data){if(t.id){let i={message:"카테고리정보가 수정 되었습니다"};this.emitter.emit("modalOpen",i)}this.updateSet(t.id,c.data)}})}},updateSet(t,e){let c=0;for(let i of this.categoryList){if(i.id==this.categoryId){const s=this.updateDataSet(i,t,e);this.categoryList[c]=s;break}if(i.subList){let s=0;for(let a of i.subList){if(a.id==this.categoryId){const o=this.updateDataSet(a,t,e);i.subList[s]=o;break}if(a.subList){let o=0;for(let f of a.subList){if(f.id==this.categoryId){const g=this.updateDataSet(f,t,e);a.subList[o]=g;break}o++}}s++}}c++}},updateDataSet(t,e,c){return e?(t.cname=this.cname,t.cuse=this.cuse):(t=c,t.active="active",t.subList=[],t.open=!0,this.categoryId=t.id,this.pcode=t.code,this.depth=parseInt(t.depth)+1),t},upDownCategory(t){this.sequenceParams.id&&(this.serverFlag||(this.serverFlag=!0,L.post(R,{id:this.sequenceParams.id,cmd:t},e=>{if(this.serverFlag=!1,e.data){if(e.data=="stay")return;this.sequenceResultSet(t)}})))},sequenceResultSet(t){let e,c,i,s,a;switch(this.sequenceParams.type){case"main":if(e=parseInt(this.sequenceParams.index),c=this.categoryList[e],t=="up"){if(e<1)return;i=e-1}else{if(this.categoryList.length<=e+1)return;i=e+1}s=this.categoryList[i],this.categoryList.splice(e,1,s),this.categoryList.splice(i,1,c),this.sequenceParams.index=i;break;case"sub":if(a=parseInt(this.sequenceParams.index),e=parseInt(this.sequenceParams.subIndex),c=this.categoryList[a].subList[e],t=="up"){if(e<1)return;i=e-1}else{if(this.categoryList[a].subList.length<=e+1)return;i=e+1}s=this.categoryList[a].subList[i],this.categoryList[a].subList.splice(e,1,s),this.categoryList[a].subList.splice(i,1,c),this.sequenceParams.subIndex=i;break;case"subSub":let o=parseInt(this.sequenceParams.index);if(a=parseInt(this.sequenceParams.subIndex),e=parseInt(this.sequenceParams.subSubIndex),c=this.categoryList[o].subList[a].subList[e],t=="up"){if(e<1)return;i=e-1}else{if(this.categoryList[o].subList[a].subList.length<=e+1)return;i=e+1}s=this.categoryList[o].subList[a].subList[i],this.categoryList[o].subList[a].subList.splice(e,1,s),this.categoryList[o].subList[a].subList.splice(i,1,c),this.sequenceParams.subSubIndex=i;break}}}},B=t=>(M("data-v-02533b6d"),t=t(),G(),t),j={class:"page-container"},z={class:"category-container"},Q={class:"category-list"},W={class:"category-list-header"},H={class:"up-down"},J={class:"add"},K={class:"category-list-body"},X={class:"main-category"},Z={class:"main-li"},$={class:"icon-box"},ee=["onClick"],te=["onClick"],se=["onClick"],ie=["onClick"],oe={class:"sub-category"},ae={class:"sub-li"},ce={class:"icon-box"},ne=["onClick"],re=["onClick"],le=["onClick"],de=["onClick"],ue={class:"subsub-category"},he={class:"subsub-li"},fe=["onClick"],ge={style:{"padding-right":"5px"}},ye=["onClick"],be={class:"category-regist"},pe={key:0},ve={class:"category-title"},me={class:"table-ul"},_e={class:"label-input"},Le={class:"input-box"},Ce={class:"label-input"},ke={class:"input-box"},Ie=B(()=>n("div",{class:"label"}," 카테고리 사용여부 ",-1)),xe={class:"label-input"},Se={class:"radio-box"},Pe={class:"button-row"};function De(t,e,c,i,s,a){const o=C("font-awesome-icon"),f=C("v-btn"),g=C("v-text-field"),T=C("v-form");return l(),h("div",j,[n("div",z,[n("div",Q,[n("div",W,[n("div",H,[u(f,{class:"white-button",variant:"outlined",onClick:e[0]||(e[0]=r=>a.upDownCategory("up"))},{default:v(()=>[u(o,{icon:"fa-solid fa-angle-up"})]),_:1}),u(f,{class:"white-button",onClick:e[1]||(e[1]=r=>a.upDownCategory("down")),variant:"outlined"},{default:v(()=>[u(o,{icon:"fa-solid fa-angle-down"})]),_:1})]),n("div",J,[u(f,{class:"white-button",onClick:e[2]||(e[2]=r=>a.addCategory()),variant:"outlined"},{default:v(()=>[u(o,{icon:"fa-solid fa-plus"}),p(" 카테고리 추가 ")]),_:1})])]),n("div",K,[n("div",{class:k("root-category "+s.rootActive),onClick:e[3]||(e[3]=r=>a.choiceCategory("root"))},[u(o,{class:"icon",icon:"fa-solid fa-folder-open"}),p(" Root ")],2),(l(!0),h(x,null,S(s.categoryList,(r,I)=>(l(),h("ul",X,[n("li",Z,[n("div",{class:k("main-data "+r.active)},[n("div",$,[r.subList&&r.subList.length>0?(l(),h("div",{key:0,onClick:d=>a.boxToggle(r.id)},[r.open?(l(),y(o,{key:0,class:"icon",icon:"fa-solid fa-folder-open"})):(l(),y(o,{key:1,class:"icon",icon:"fa-solid fa-folder"}))],8,ee)):(l(),h("div",{key:1,onClick:d=>a.choiceCategory(r.id)},[u(o,{class:"icon",icon:"fa-solid fa-file-lines"})],8,te))]),n("div",{class:"gname",onClick:d=>a.choiceCategory(r.id)},[p(m(r.cname)+" ",1),r.cuse=="yes"?(l(),y(o,{key:0,icon:"fa-solid fa-eye"})):(l(),y(o,{key:1,icon:"fa-solid fa-eye-slash"}))],8,se),n("div",{class:"btn",onClick:d=>a.deleteCategory(r.id,I)},[u(o,{icon:"fa-solid fa-circle-minus"})],8,ie)],2),r.open?(l(!0),h(x,{key:0},S(r.subList,(d,P)=>(l(),h("ul",oe,[n("li",ae,[n("div",{class:k("sub-data "+d.active)},[n("div",ce,[d.subList&&d.subList.length>0?(l(),h("div",{key:0,onClick:b=>a.boxToggle(d.id)},[d.open?(l(),y(o,{key:0,class:"icon",icon:"fa-solid fa-folder-open"})):_("",!0),d.open?_("",!0):(l(),y(o,{key:1,class:"icon",icon:"fa-solid fa-folder"}))],8,ne)):(l(),h("div",{key:1,onClick:b=>a.choiceCategory(d.id)},[u(o,{class:"icon",icon:"fa-solid fa-file-lines"})],8,re))]),n("div",{class:"gname",onClick:b=>a.choiceCategory(d.id)},[p(m(d.cname)+" ",1),d.cuse=="yes"?(l(),y(o,{key:0,icon:"fa-solid fa-eye"})):(l(),y(o,{key:1,icon:"fa-solid fa-eye-slash"}))],8,le),n("div",{class:"btn",onClick:b=>a.deleteSubCategory(d.id,I,P)},[u(o,{icon:"fa-solid fa-circle-minus"})],8,de)],2),d.open?(l(!0),h(x,{key:0},S(d.subList,(b,w)=>(l(),h("ul",ue,[n("li",he,[n("div",{class:k("subsub-data "+b.active)},[n("div",{class:"gname",onClick:q=>a.choiceCategory(b.id)},[u(o,{class:"icon",icon:"fa-solid fa-file-lines"}),n("span",ge,m(b.cname),1),b.cuse=="yes"?(l(),y(o,{key:0,icon:"fa-solid fa-eye"})):(l(),y(o,{key:1,icon:"fa-solid fa-eye-slash"}))],8,fe),n("div",{class:"btn",onClick:q=>a.deleteSubSubCategory(b.id,I,P,w)},[u(o,{icon:"fa-solid fa-circle-minus"})],8,ye)],2)])]))),256)):_("",!0)])]))),256)):_("",!0)])]))),256))])]),n("div",be,[s.categoryId?(l(),h("div",pe,[n("div",ve,m(s.categoryRegistTitle),1),u(T,{modelValue:s.form,"onUpdate:modelValue":e[8]||(e[8]=r=>s.form=r),novalidate:"",onSubmit:N(a.validate,["prevent"])},{default:v(()=>[n("ul",me,[n("li",null,[n("div",_e,[n("div",Le,[u(g,{modelValue:s.code,"onUpdate:modelValue":e[4]||(e[4]=r=>s.code=r),density:"compact",variant:"outlined",label:"카테고리 코드",readonly:""},null,8,["modelValue"])])])]),n("li",null,[n("div",Ce,[n("div",ke,[u(g,{modelValue:s.cname,"onUpdate:modelValue":e[5]||(e[5]=r=>s.cname=r),rules:[a.cnameErrors],density:"compact",variant:"outlined",label:"카테고리명",placeholder:"카테고리명을 입력해주세요"},null,8,["modelValue","rules"])])])]),n("li",null,[Ie,n("div",xe,[n("div",Se,[n("label",null,[D(n("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=r=>s.cuse=r),value:"yes"},null,512),[[A,s.cuse]]),p(" 사용 ")]),n("label",null,[D(n("input",{type:"radio","onUpdate:modelValue":e[7]||(e[7]=r=>s.cuse=r),value:"no"},null,512),[[A,s.cuse]]),p(" 사용안함 ")])])])])]),n("div",Pe,[u(f,{class:"submit-button",type:"submit"},{default:v(()=>[p("카테고리정보 "+m(s.buttonTitle),1)]),_:1})])]),_:1},8,["modelValue","onSubmit"])])):_("",!0)])])])}const qe=U(Y,[["render",De],["__scopeId","data-v-02533b6d"]]);export{qe as default};
