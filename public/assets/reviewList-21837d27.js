import{a as g,ak as T,al as N,am as L,an as E,ao as R,ap as A,aq as M}from"./apiService-0aea4262.js";import{U as w}from"./util-5fdb7bcf.js";import{s as P}from"./shopTable-d56388e3.js";import{_ as x,r as h,o as f,c as b,a as s,t as p,e as C,d,w as _,F as U,b as O,p as I,f as V,u as B,q as F,v as H,g as y}from"./index-e9ed42ea.js";import"./axios-c24e582b.js";import"./jquery-331624d0.js";const j={props:["id"],watch:{id(i){i&&this.getData()}},computed:{form(){return{comment:this.comment}}},data(){return{util:w,info:{},productInfo:{},comment:"",commentId:"",insertFlag:!1,imgs:[],commentList:[],reload:!1,formHasErrors:!1,blindText:"숨김 처리"}},created(){this.getData()},methods:{getData(){g.post(T,{id:this.id},i=>{this.productInfo=i.data.productInfo,this.info=i.data.info,this.info.imgs&&(this.imgs=JSON.parse(this.info.imgs)),this.info.commentCnt||(this.info.commentCnt=0),this.info.created_at=this.info.created_at.substring(0,19).replace("T"," ");for(let t of i.data.commentList)t.created_at=t.created_at.substring(0,19).replace("T"," "),this.commentList.push(t);this.info.is_delete=="yes"&&(this.blindText="숨김 제거")})},getCommentList(){let i={parentId:this.id,parentType:"orderReview"};g.post(N,i,t=>{this.commentList=[];for(let a of t.data)a.created_at=a.created_at.substring(0,19).replace("T"," "),this.commentList.push(a)})},deleteItem(){let i;this.info.is_delete=="yes"?i="후기글 숨김 제거 하시겠습니까?":i="후기글을 숨김 처리 하시겠습니까?";const t={type:"confirm",message:i,doAction:()=>{this.blindAction()}};this.$eventBus.$emit("modalOpen",t)},blindAction(){let i,t,a;this.info.is_delete=="yes"?(i="no",t="후기글 숨김 제거 처리되었습니다",a="숨김 처리"):(i="yes",t="후기글이 숨김 처리되었습니다",a="숨김 제거");const o={ids:[this.id],cmd:i};this.$eventBus.$emit("overlay","open"),g.post(L,o,e=>{this.$eventBus.$emit("overlay","hide");const n={message:t};this.$emit("orderReviewReload"),this.info.is_delete=i,this.blindText=a,this.$eventBus.$emit("modalOpen",n)})},updateReview(){if(this.insertFlag||(this.formHasErrors=!1,Object.keys(this.form).forEach(a=>{this.form[a]||(this.formHasErrors=!0),this.$refs[a].validate(!0)}),this.formHasErrors))return;this.insertFlag=!0,this.$eventBus.$emit("overlay","open");let i="",t={parentId:this.id,parentType:"orderReview",content:this.comment};this.commentId?(i=E,t.id=this.commentId):i=R,g.post(i,t,a=>{this.$eventBus.$emit("overlay","hide"),this.insertFlag=!1,this.getCommentList();const o={message:"댓글이 저장 되었습니다"};this.commentId="",this.comment="",this.$refs.comment.reset(),this.$eventBus.$emit("modalOpen",o)})}}},G=i=>(I("data-v-d8e5672a"),i=i(),V(),i),W={class:"page-container"},z={class:"article-container"},q={class:"article-info"},J=G(()=>s("li",{class:"bname"}," 상품정보 ",-1)),Y={class:"bsubject"},K={class:"img"},Q=["src"],X={class:"text-box"},Z={class:"summary"},$={key:0,class:"blind"},tt={class:"list-imgs"},et=["src"],it=["innerHTML"];function st(i,t,a,o,e,n){const m=h("v-btn");return f(),b("div",W,[s("div",z,[s("ul",q,[J,s("li",Y,[s("div",K,[s("img",{src:e.productInfo.listImg},null,8,Q)]),s("div",X,p(e.productInfo.pname)+"    가격 "+p(e.util.numberFormat(e.productInfo.price))+"원   즉시 할인가 "+p(e.util.numberFormat(e.productInfo.dcprice))+"원 ",1)]),s("li",Z,[s("div",null,[s("span",null,"작성자 : "+p(e.info.name),1),s("span",null,"평점 : "+p(e.info.grade),1),s("span",null,"등록일 : "+p(e.info.created_at),1),e.info.is_delete=="yes"?(f(),b("span",$,"숨김 처리됨")):C("",!0)]),s("div",null,[d(m,{class:"red-button",onClick:t[0]||(t[0]=r=>n.deleteItem()),depressed:""},{default:_(()=>[s("span",null,p(e.blindText),1)]),_:1})])])]),s("ul",tt,[(f(!0),b(U,null,O(e.imgs,r=>(f(),b("li",null,[s("img",{src:r},null,8,et)]))),256))]),s("div",{innerHTML:e.info.content,class:"content"},null,8,it)])])}const ot=x(j,[["render",st],["__scopeId","data-v-d8e5672a"]]);const at={components:{shopTable:P,reviewView:ot},watch:{datalimit(i){this.getDataList(1)},cate1(i){this.subCategoryList=[];let t={text:"2차카테고리 선택",value:""};this.subCategoryList.push(t),this.subSubCategoryList=[];let a={text:"3차카테고리 선택",value:""};if(this.subSubCategoryList.push(a),this.cate2="",this.cate3="",this.orgSubCategoryList=[],i){for(let o of this.orgCategoryList)if(o.id==i&&o.subList&&o.subList.length>0)for(let e of o.subList)t={text:e.cname,value:e.id},this.subCategoryList.push(t),this.orgSubCategoryList.push(e)}},cate2(i){this.subSubCategoryList=[];let t={text:"3차카테고리 선택",value:""};if(this.subSubCategoryList.push(t),this.cate3="",i){for(let a of this.orgSubCategoryList)if(a.id==i&&a.subList&&a.subList.length>0)for(let o of a.subList)t={text:o.cname,value:o.id},this.subSubCategoryList.push(t)}}},props:["accept","selectedProduct"],data(){return{util:w,columns:[{name:"선택",id:"id",sort:!1,width:90,type:"allCheckbox"},{name:"번호",id:"number",sort:!1,width:60},{name:"숨김",id:"is_delete",sort:!1,width:60},{name:"이미지",id:"img",width:80,type:"image"},{name:"평점",id:"grade",width:80},{name:"내용",id:"content",type:"underline-action",action:"reviewView",textStyle:{"text-align":"left","padding-left":"10px","max-width":"437px"},width:450},{name:"작성자",id:"user_name",sort:!0,width:100},{name:"지급포인트",id:"point",width:80},{name:"등록일",id:"created_at",sort:!0,width:100},{name:"상품이미지",id:"listImg",width:100,type:"image"},{name:"상품명",id:"pname",width:300,sort:!0},{name:"카테고리",id:"category",width:300},{name:"브랜드",id:"brandId",width:200},{name:"정가",id:"price",width:100},{name:"할인가",id:"dcprice",width:100}],fixed:9,reviewList:[],paging:{total:"",links:[],currentPage:1,lastPage:1},categoryListNames:{},categoryList:[],subCategoryList:[],subSubCategoryList:[],orgCategoryList:[],orgSubCategoryList:[],cate1:"",cate2:"",cate3:"",brandList:[],brandListNames:{},page:1,datalimit:20,keywordCmd:"pname",keywordCmdList:[{title:"작성자",value:"name"},{title:"후기내용",value:"content"},{title:"상품명",value:"pname"}],keyword:"",brand:"",stdate:"",endate:"",vmenu1:!1,vmenu2:!1,dateCmd:"created_at",dateCmdList:[{title:"후기등록일",value:"created_at"}],datalimitList:[{title:"10개",value:10},{title:"20개",value:20},{title:"30개",value:30},{title:"50개",value:50},{title:"100개",value:100}],ids:{},stickyTop:0,dataSort:{field:"id",sort:"desc"},imgCheck:"",selectedId:"",reviewDialog:!1,blind:"yes",blindShow:!1,blindList:[{title:"숨김",value:"yes"},{title:"숨김해제",value:"no"}]}},created(){this.getData(1)},methods:{searchReset(){this.keywordCmd="pname",this.keyword="",this.brand="",this.stdate="",this.endate="",this.dateCmd="created_at",this.cate1="",this.cate2="",this.cate3="",this.imgCheck=""},getSearchParams(i){this.page=i;let t=[];return this.cate1&&t.push(this.cate1),this.cate2&&t.push(this.cate2),this.cate3&&t.push(this.cate3),{orderByField:this.dataSort.field,orderBySort:this.dataSort.sort,limit:this.datalimit,page:i,keywordCmd:this.keywordCmd,keyword:this.keyword,brand:this.brand,stdate:this.stdate,endate:this.endate,dateCmd:this.dateCmd,photo:this.imgCheck,category:t.length>0?t.join(","):""}},getData(i){const t=this.getSearchParams(i);g.post(A,t,a=>{this.orgCategoryList=a.data.categoryList;let o={title:"1차카테고리 선택",value:""};this.categoryList.push(o);let e={title:"2차카테고리 선택",value:""};this.subCategoryList.push(e);let n={title:"3차카테고리 선택",value:""};this.subSubCategoryList.push(n),this.categoryListNames={};for(let r of a.data.categoryList)if(o={title:r.cname,value:r.id},this.categoryList.push(o),this.categoryListNames[r.id]=r.cname,r.subList){for(let c of r.subList)if(this.categoryListNames[c.id]=c.cname,c.subList)for(let v of c.subList)this.categoryListNames[v.id]=v.cname}this.brandListNames={};let m={title:"브랜드 선택",value:""};this.brandList.push(m);for(let r of a.data.brandList){let c={title:r.bname,value:r.id};this.brandList.push(c),this.brandListNames[r.id]=r.bname}this.setDataList(a.data.reviewList)})},getDataList(i){const t=this.getSearchParams(i);g.post(M,t,a=>{this.setDataList(a.data)})},setDataList(i){this.reviewList=[],this.paging={total:i.total,links:i.links,currentPage:i.current_page,lastPage:i.last_page};const t=parseInt(i.total)-this.datalimit*(parseInt(i.current_page)-1);let a=0;for(let o of i.data){o.number=t-a,o.created_at=o.created_at.substring(0,10),parseInt(o.gamt)<1&&(o.pstatus="soldout");let e=o.category1.split(","),n=this.categoryListNames[e[0]];if(e[1]&&(n+=" > "+this.categoryListNames[e[1]]),e[2]&&(n+=" > "+this.categoryListNames[e[2]]),o.category=n,o.imgs){const m=JSON.parse(o.imgs);o.img=m[0]}else o.img="";o.is_delete=o.is_delete=="yes"?"Y":"",o.price=w.numberFormat(o.price),o.dcprice=w.numberFormat(o.dcprice),o.brandId=this.brandListNames[o.brandId],this.reviewList.push(o),a++}},pageMove(i){this.getDataList(i.page)},productModify(i){this.$router.push("/admin/product/productModify/"+i.id)},search(){this.getDataList(1)},tableEventAction(i){switch(i.type){case"dataSort":this.dataSort=i.sort,this.getDataList(1);break}},checkDataList(i){this.ids=i},blindReviewToggle(){this.blindShow?this.blindShow=!1:this.blindShow=!0},blindReview(){let i=!1;for(const o in this.ids)o&&(i=!0);if(!i){const o={message:"후기글을 하나 이상 선택하세요"};this.emitter.emit("modalOpen",o);return}const a={type:"confirm",message:"후기글을 "+(this.blind=="yes"?"숨김 처리":"숨김해제")+" 하시겠습니까?",doAction:()=>{this.blindAction(this.ids)}};this.emitter.emit("modalOpen",a)},pageReload(){this.getDataList(this.page)},blindAction(i){const t={ids:i,cmd:this.blind};this.emitter.emit("overlay","open"),g.post(L,t,a=>{this.emitter.emit("overlay","hide");const e={message:"후기글 "+(this.blind=="yes"?"숨김 처리":"숨김해제")+"되었습니다"};this.emitter.emit("modalOpen",e),this.getDataList(this.page)})},reviewView(i){this.selectedId=i.id,this.reviewDialog=!0}}},u=i=>(I("data-v-f247fbd0"),i=i(),V(),i),lt={class:"page-container"},nt={class:"table-box"},dt={class:"search-box"},rt={class:"table-search",cellspacing:"0",cellpadding:"0",border:"0"},mt=u(()=>s("th",null,"상품 브랜드",-1)),ct=u(()=>s("th",null,"상품 카테고리",-1)),ut={style:{display:"flex"}},ht=u(()=>s("div",{style:{width:"20px"}},null,-1)),pt=u(()=>s("div",{style:{width:"20px"}},null,-1)),gt=u(()=>s("th",null,"포토 후기",-1)),_t=u(()=>s("th",null,"검색어",-1)),ft={style:{display:"flex"}},bt={style:{"margin-left":"20px"}},vt=u(()=>s("th",null,"기간검색",-1)),yt={style:{display:"flex"}},wt={class:"select-box",style:{display:"flex","margin-right":"20px"}},Lt={style:{width:"160px"}},xt=u(()=>s("div",{style:{width:"30px","text-align":"center","line-height":"50px",height:"50px"}},"~ ",-1)),Ct={style:{width:"160px"}},It={class:"button-row"},Vt=u(()=>s("span",null,"초기화",-1)),kt=u(()=>s("span",null,"검색",-1)),St={style:{display:"flex",padding:"0 10px","justify-content":"space-between","z-index":"20"}},Dt={class:"sub-title"},Tt={class:"select-box",style:{display:"flex","max-height":"40px","padding-top":"4px"}},Nt={class:"total"},Et={key:0,class:"status-change-box"},Rt={class:"select-box",style:{position:"relative","z-index":"101"}},At={class:"button-box",style:{"max-width":"120px"}},Mt={class:"modal-layout",style:{height:"760px"}},Pt={class:"modal-header"},Ut=u(()=>s("div",{class:"modal-title"},"후기 상세",-1)),Ot={class:"modal-body",style:{height:"700px"}};function Bt(i,t,a,o,e,n){const m=h("v-select"),r=h("v-text-field"),c=h("v-btn"),v=h("shopTable"),k=h("font-awesome-icon"),S=h("reviewView"),D=h("v-dialog");return f(),b("div",lt,[s("div",nt,[s("form",{novalidate:"",onSubmit:t[11]||(t[11]=B((...l)=>n.search&&n.search(...l),["prevent"]))},[s("div",dt,[s("table",rt,[s("tbody",null,[s("tr",null,[mt,s("td",null,[d(m,{modelValue:e.brand,"onUpdate:modelValue":t[0]||(t[0]=l=>e.brand=l),density:"compact",variant:"outlined",style:{"max-width":"200px"},items:e.brandList},null,8,["modelValue","items"])])]),s("tr",null,[ct,s("td",null,[s("div",ut,[d(m,{modelValue:e.cate1,"onUpdate:modelValue":t[1]||(t[1]=l=>e.cate1=l),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:e.categoryList},null,8,["modelValue","items"]),ht,d(m,{modelValue:e.cate2,"onUpdate:modelValue":t[2]||(t[2]=l=>e.cate2=l),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:e.subCategoryList},null,8,["modelValue","items"]),pt,d(m,{modelValue:e.cate3,"onUpdate:modelValue":t[3]||(t[3]=l=>e.cate3=l),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:e.subSubCategoryList},null,8,["modelValue","items"])])])]),s("tr",null,[gt,s("td",null,[s("label",null,[F(s("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=l=>e.imgCheck=l),value:"yes"},null,512),[[H,e.imgCheck]]),y(" 포토후기만 ")])])]),s("tr",null,[_t,s("td",null,[s("div",ft,[d(m,{modelValue:e.keywordCmd,"onUpdate:modelValue":t[5]||(t[5]=l=>e.keywordCmd=l),density:"compact",variant:"outlined",style:{"max-width":"150px"},items:e.keywordCmdList},null,8,["modelValue","items"]),s("div",bt,[d(r,{style:{width:"400px"},density:"compact",variant:"outlined",modelValue:e.keyword,"onUpdate:modelValue":t[6]||(t[6]=l=>e.keyword=l)},null,8,["modelValue"])])])])]),s("tr",null,[vt,s("td",null,[s("div",yt,[s("div",wt,[d(m,{modelValue:e.dateCmd,"onUpdate:modelValue":t[7]||(t[7]=l=>e.dateCmd=l),density:"compact",variant:"outlined",items:e.dateCmdList},null,8,["modelValue","items"])]),s("div",Lt,[d(r,{type:"date",modelValue:e.stdate,"onUpdate:modelValue":t[8]||(t[8]=l=>e.stdate=l),density:"compact",variant:"outlined"},null,8,["modelValue"])]),xt,s("div",Ct,[d(r,{type:"date",density:"compact",variant:"outlined",modelValue:e.endate,"onUpdate:modelValue":t[9]||(t[9]=l=>e.endate=l)},null,8,["modelValue"])])])])])])])]),s("div",It,[d(c,{class:"white-button",variant:"outlined",onClick:t[10]||(t[10]=l=>n.searchReset())},{default:_(()=>[Vt]),_:1}),d(c,{class:"search-button",type:"submit",variant:"outlined"},{default:_(()=>[kt]),_:1})])],32),s("div",St,[s("div",Dt,[y("후기 리스트 "),d(c,{depressed:"",color:"primary",variant:"outlined",class:"sdel-button",rounded:"",onClick:t[12]||(t[12]=l=>n.blindReviewToggle())},{default:_(()=>[y(" 선택된 리뷰 숨김변경 ")]),_:1})]),s("div",Tt,[s("div",Nt,"전체 후기 수 "+p(e.util.numberFormat(e.paging.total))+"개",1),d(m,{modelValue:e.datalimit,"onUpdate:modelValue":t[13]||(t[13]=l=>e.datalimit=l),density:"compact","bg-color":"#fff",style:{"max-width":"100px"},items:e.datalimitList},null,8,["modelValue","items"])])]),e.blindShow?(f(),b("div",Et,[s("div",Rt,[d(m,{density:"compact",modelValue:e.blind,"onUpdate:modelValue":t[14]||(t[14]=l=>e.blind=l),variant:"outlined",style:{width:"150px"},items:e.blindList},null,8,["modelValue","items"])]),s("div",At,[d(c,{class:"white-button",style:{"max-width":"120px",height:"40px"},onClick:t[15]||(t[15]=l=>n.blindReview()),variant:"outlined"},{default:_(()=>[y("숨김상태 변경 ")]),_:1})])])):C("",!0),d(v,{datas:e.reviewList,updateStickyTop:e.stickyTop,fixed:e.fixed,onPageMove:n.pageMove,onParentEvent:n.tableEventAction,columns:e.columns,paging:e.paging,onReviewView:n.reviewView,onCheckDataList:n.checkDataList},null,8,["datas","updateStickyTop","fixed","onPageMove","onParentEvent","columns","paging","onReviewView","onCheckDataList"])]),d(D,{modelValue:e.reviewDialog,"onUpdate:modelValue":t[19]||(t[19]=l=>e.reviewDialog=l),width:"800",persistent:"",rounded:"",style:{"z-index":"100"}},{default:_(()=>[s("div",Mt,[s("div",Pt,[Ut,s("div",{class:"modal-close",onClick:t[16]||(t[16]=l=>e.reviewDialog=!1)},[d(k,{icon:"fa-solid fa-circle-xmark"})])]),s("div",Ot,[d(S,{id:e.selectedId,onOrderReviewReload:t[17]||(t[17]=l=>n.pageReload()),onReviewDialogHide:t[18]||(t[18]=l=>e.reviewDialog=!1)},null,8,["id"])])])]),_:1},8,["modelValue"])])}const qt=x(at,[["render",Bt],["__scopeId","data-v-f247fbd0"]]);export{qt as default};
