import{a as k,aC as S,aD as P,aE as E}from"./apiService-0aea4262.js";import{U as w}from"./util-5fdb7bcf.js";import{s as F}from"./shopTable-d56388e3.js";import{o as U}from"./orderView-03c18ab0.js";import{_ as M,r as f,o as r,c as u,a as e,u as A,F as C,b as O,q as T,v as R,g as p,t as c,e as V,d as n,w as m,n as x,p as z,f as Y}from"./index-e9ed42ea.js";const B={components:{shopTable:F,orderViewComponent:U},props:["orgOstatus"],watch:{datalimit(s){this.getDataList(1)},changeOstatus(s){if(this.orgOstatus=="DR")if(s=="DI")if(this.ids.length<1){let t={message:"먼저 주문을 선택하세요",doAction:()=>{this.changeOstatus=""}};this.emitter.emit("modalOpen",t);return}else this.setDeliveryInfoList(),this.deliveryDialog=!0;else this.deliveryDialog=!1}},data(){return{orderViewDialog:!1,orderViewId:"",util:w,changeOstatusList:[],changeOstatus:"",deliveryCompanyList:[],deliveryDialog:!1,columns:[{name:"번호",id:"number",sort:!1,width:60,rows:!0},{name:"주문번호",id:"order_code",width:150,rows:!0,type:"underline-action",action:"orderView"},{name:"주문자",id:"oname",width:100,sort:!0,rows:!0},{name:"주문자휴대폰",id:"opcs",width:120,rows:!0},{name:"결제수단",id:"paymethod",width:100,sort:!0,rows:!0},{name:"결제금액",id:"pay_price",width:100,sort:!0,rows:!0},{name:"배송비",id:"deliveryPrice",width:100,rows:!0},{name:"주문일",id:"created_at",sort:!0,width:100,rows:!0},{name:"주문상태",id:"ostatus",width:"100"},{name:"상품명",id:"pname",width:200},{name:"옵션명",id:"opt_name",width:200},{name:"추가옵션명",id:"add_opt_name",width:300},{name:"판매가격",id:"payTotalPrice",width:100},{name:"구매수량",id:"oamt",width:100},{name:"수령자명",id:"rname",width:100},{name:"수령자휴대폰",id:"rpcs",width:100},{name:"우편번호",id:"rpost",width:100},{name:"주소",id:"raddr",width:250}],ids:[],orgIds:{},fixed:8,orderList:[],orderFixList:[],paging:{total:"",links:[],currentPage:1,lastPage:1},page:1,datalimit:20,serviceTypeList:{normal:"배송상품군",service:"서비스상품군"},ostatusList:[],ostatus:[],paymethod:[],paymethodList:[],ostatusNames:{},paymethodNames:{},keywordCmd:"order_code",keywordCmdList:[{title:"주문번호",value:"order_code"},{title:"주문자명",value:"oname"},{title:"주문자휴대폰",value:"opcs"},{title:"상품명",value:"pname"},{title:"수령자",value:"rname"},{title:"수령자휴대폰",value:"rpcs"}],keyword:"",stdate:"",endate:"",vmenu1:!1,vmenu2:!1,datalimitList:[{title:"10개",value:10},{title:"20개",value:20},{title:"30개",value:30},{title:"50개",value:50},{title:"100개",value:100}],stickyTop:0,dataSort:{field:"id",sort:"desc"},dayClass:{to:"",yer:"",thr:"",week:"active",mon:"",tmon:""},ostatusCancleList:{},ostatusReturnList:{},ostatusExchangeList:{},ostatusRefundList:{},deliveryInfoList:[],deliveryServerDatas:{}}},created(){this.orgOstatus!="all"&&(this.ostatus.push(this.orgOstatus),this.columns.unshift({name:"선택",id:"id",sort:!1,width:70,type:"allCheckbox"}),this.fixed=9,this.setChangeStatusList()),this.setDay("week"),this.getData()},methods:{resetChangeOstatus(){this.changeOstatus=""},setDeliveryInfoList(){this.deliveryInfoList=[];for(const s of this.orderFixList)if(this.orgIds[s.id]){let t=!1,o="";s.deliveryId?this.deliveryServerDatas[s.deliveryId]?this.deliveryServerDatas[s.deliveryId].dmethod=="auto"?t=!0:o="직접배송":o="잘못된 배송정보":o="서비스상품군";const a={order_code:s.order_code,oname:s.oname,opcs:s.opcs,id:s.id,paymethod:s.paymethod,pay_price:s.pay_price,deliveryPrice:s.deliveryPrice,deliveryCompany:"",sendNumber:"",transCheck:t,noTransText:o};this.deliveryInfoList.push(a)}},deliveryInfoAction(){let s={},t=!0,o=!0;const a={};for(const i of this.deliveryInfoList)i.transCheck&&(i.deliveryCompany||(t=!1),i.sendNumber||(o=!1)),a[i.id]={deliveryCompany:i.deliveryCompany,sendNumber:i.sendNumber};if(!t){s={message:"배송업체를 선택하세요"},this.emitter.emit("modalOpen",s);return}if(!o){s={message:"송장번호를 입력하세요"},this.emitter.emit("modalOpen",s);return}if(this.ids.length<1){s={message:"주문을 선택하세요"},this.emitter.emit("modalOpen",s);return}if(!this.changeOstatus){s={message:"변경할 주문상태를 선택하세요"},this.emitter.emit("modalOpen",s);return}const l={ids:this.ids,ostatus:this.changeOstatus,deliveryData:JSON.stringify(a)};this.emitter.emit("overlay","open"),k.post(S,l,i=>{this.emitter.emit("overlay","hide"),this.resetChangeOstatus(),this.getDataList(this.page),s={message:"주문상태를 변경하였습니다"},this.emitter.emit("modalOpen",s)})},setChangeStatusList(){switch(this.changeOstatusList=[{title:"주문상태 선택",value:""}],this.orgOstatus){case"notpay":this.changeOstatusList.push({title:"입금완료",value:"income"});break;case"income":this.changeOstatusList.push({title:"배송준비중",value:"DR"}),this.changeOstatusList.push({title:"미입금",value:"notpay"});break;case"DR":this.changeOstatusList.push({title:"배송중",value:"DI"}),this.changeOstatusList.push({title:"입금완료",value:"income"});break;case"DI":this.changeOstatusList.push({title:"배송완료",value:"DC"}),this.changeOstatusList.push({title:"배송준비중",value:"DR"});break;case"DC":this.changeOstatusList.push({title:"구매확정",value:"OC"}),this.changeOstatusList.push({title:"배송중",value:"DI"});break;case"OC":this.changeOstatusList.push({title:"배송완료",value:"DC"});break}},setDay(s){for(let i in this.dayClass)i==s?this.dayClass[i]="active":this.dayClass[i]="";const t=new Date;let o=t.getMonth()+1,a=t.getDate();const l=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);switch(this.endate=l,s){case"to":this.stdate=l;break;case"yer":t.setDate(a-1),o=t.getMonth()+1,a=t.getDate(),this.stdate=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);break;case"thr":t.setDate(a-3),o=t.getMonth()+1,a=t.getDate(),this.stdate=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);break;case"week":t.setDate(a-7),o=t.getMonth()+1,a=t.getDate(),this.stdate=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);break;case"mon":t.setMonth(o-1),o=t.getMonth(),a=t.getDate(),this.stdate=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);break;case"tmon":t.setMonth(o-3),o=t.getMonth(),a=t.getDate(),this.stdate=t.getFullYear()+"-"+(o<10?"0"+o:o)+"-"+(a<10?"0"+a:a);break}},searchReset(){this.keywordCmd="order_code",this.keyword="",this.stdate="",this.endate="",this.paymethod=[],this.ostatus=[]},getSearchParams(){let s={orderByField:this.dataSort.field,orderBySort:this.dataSort.sort,limit:this.datalimit,page:this.page,keywordCmd:this.keywordCmd,keyword:this.keyword,stdate:this.stdate,endate:this.endate};return this.ostatus.length>0&&(s.ostatus=this.ostatus.join(",")),this.paymethod.length>0&&(s.paymethod=this.paymethod.join(",")),s},getData(){const s=this.getSearchParams();k.post(P,s,t=>{this.ostatusNames=t.data.ostatusList;for(let o in t.data.ostatusList)this.ostatusList.push({text:t.data.ostatusList[o],value:o});if(t.data.deliveryInfo)for(const o of t.data.deliveryInfo)this.deliveryServerDatas[o.id]=o;this.paymethodNames=t.data.paymethodList;for(let o in t.data.paymethodList)this.paymethodList.push({text:t.data.paymethodList[o],value:o});if(this.ostatusCancleList=t.data.ostatusCancleList,this.ostatusReturnList=t.data.ostatusReturnList,this.ostatusExchangeList=t.data.ostatusExchangeList,this.ostatusRefundList=t.data.ostatusRefundList,t.data.duseCompany)for(const o of t.data.duseCompany){let a={title:o.name,value:o.id};this.deliveryCompanyList.push(a)}this.setDataList(t.data.orderList)})},getDataList(){const s=this.getSearchParams();k.post(E,s,t=>{this.setDataList(t.data)})},reloadOrderList(){this.getDataList()},setDataList(s){this.orderFixList=[],this.orderList=[],this.paging={total:s.total,links:s.links,currentPage:s.current_page,lastPage:s.last_page};const t=parseInt(s.total)-this.datalimit*(parseInt(s.current_page)-1);let o=0;for(let a of s.data){let l=t-o;a.number=l,a.rows=a.orderProducts.length,a!=null&&a.created_at&&(a.created_at=a.created_at.substring(0,10)),a.paymethod=this.paymethodNames[a.paymethod],a.pay_price=w.numberFormat(a.price),this.orderFixList.push(a);for(let i of a.orderProducts){i.serviceType=this.serviceTypeList[i.serviceType],i.dcprice=w.numberFormat(i.dcprice),i.price=w.numberFormat(i.price),i!=null&&i.ostatus&&(this.ostatusNames[i.ostatus]?i.ostatus=this.ostatusNames[i.ostatus]:this.ostatusCancleList[i.ostatus]?i.ostatus=this.ostatusCancleList[i.ostatus]:this.ostatusReturnList[i.ostatus]?i.ostatus=this.ostatusReturnList[i.ostatus]:this.ostatusExchangeList[i.ostatus]?i.ostatus=this.ostatusExchangeList[i.ostatus]:this.ostatusRefundList[i.ostatus]&&(i.ostatus=this.ostatusRefundList[i.ostatus])),i.rname=a.rname,i.rpcs=a.rpcs,i.rpost=a.rpost,i.raddr=a.raddr1+" "+a.raddr2;let g=parseInt(i.payprice),_="";if(i.optionSingleInfos){let h=JSON.parse(i.optionSingleInfos),b=[];for(const v of h)v.required=="N"&&(g+=v.sellprice,b.push(v.option_parent_name+":"+v.option_name+" ("+v.camt+"개)"));_=b.join(",")}i.add_opt_name=_,i.payTotalPrice=w.numberFormat(g),this.orderList.push(i)}o++}},pageMove(s){this.page=s.page,this.getDataList()},search(){this.getDataList(1)},tableEventAction(s){switch(s.type){case"dataSort":s.sort.field=="pay_price"&&(s.sort.field="price"),this.dataSort=s.sort,this.getDataList(1);break}},orderView(s){this.orderViewId=s.id,this.orderViewDialog=!0},updateOstatus(){let s={};if(this.ids.length<1){s={message:"주문을 선택하세요"},this.emitter.emit("modalOpen",s);return}if(!this.changeOstatus){s={message:"변경할 주문상태를 선택하세요"},this.emitter.emit("modalOpen",s);return}const t={ids:this.ids,ostatus:this.changeOstatus};this.emitter.emit("overlay","open"),k.post(S,t,o=>{this.emitter.emit("overlay","hide"),this.getDataList(this.page),s={message:"주문상태를 변경하였습니다"},this.emitter.emit("modalOpen",s)})},checkDataList(s){this.ids=[],this.orgIds=s;for(let t in s)t&&this.ids.push(t)}}},y=s=>(z("data-v-e309e717"),s=s(),Y(),s),j={class:"page-container"},q={class:"table-box"},G={class:"search-box"},J={class:"table-search",cellspacing:"0",cellpadding:"0",border:"0"},H={key:0},K=y(()=>e("th",null,"주문상태",-1)),Q={style:{display:"flex"}},W={style:{"margin-right":"20px"}},X=["value"],Z={key:0},$={key:1,style:{"border-radius":"5px"}},tt={style:{display:"flex"}},et={style:{"margin-right":"20px"}},st=["value"],it=y(()=>e("th",null,"검색어",-1)),at={style:{display:"flex"}},ot=y(()=>e("th",{style:{"border-radius":"5px"}},"주문일 검색",-1)),lt={style:{display:"flex","max-height":"40px","padding-top":"6px"}},dt={class:"date-box"},nt={style:{display:"flex","margin-top":"-5px","margin-left":"10px"}},rt={style:{width:"160px"}},ut=y(()=>e("div",{style:{width:"30px","text-align":"center","line-height":"50px",height:"50px"}},"~ ",-1)),ht={style:{width:"160px"}},mt={class:"button-row"},pt=y(()=>e("span",null,"초기화",-1)),ct=y(()=>e("span",null,"검색",-1)),yt={style:{display:"flex",padding:"0 10px","justify-content":"space-between","z-index":"20"}},vt=y(()=>e("div",{class:"sub-title flex-box"},"주문 리스트",-1)),gt={key:0,class:"status-change-box"},_t={class:"select-box",style:{position:"relative","z-index":"101"}},ft={class:"button-box",style:{"max-width":"120px"}},xt={class:"select-box flex-box",style:{display:"flex","max-height":"40px","padding-top":"4px"}},wt={class:"total"},bt={class:"modal-layout",style:{height:"760px"}},Lt={class:"modal-header"},kt=y(()=>e("div",{class:"modal-title"},"배송정보 등록",-1)),Dt={key:0,class:"modal-body",style:{height:"700px",padding:"40px"}},Ct=y(()=>e("div",{style:{"font-size":"18px","font-weight":"bold","padding-bottom":"10px"}},"선택된 주문목록",-1)),Ot={style:{height:"520px"}},Vt={class:"table-regist",cellpadding:"0",cellspacing:"0",border:"0",style:{width:"100%"}},It=y(()=>e("thead",{style:{position:"sticky",top:"0"}},[e("tr",null,[e("th",null," 주문번호 "),e("th",{style:{width:"100px"}}," 주문자 "),e("th",null," 주문자휴대폰 "),e("th",null," 결제수단 "),e("th",null," 결제금액 "),e("th",{style:{width:"100px"}}," 배송비 "),e("th",null," 배송업체 "),e("th",null," 송장번호 ")])],-1)),St={style:{"padding-bottom":"6px"}},Tt={key:0,class:"select-box",style:{width:"130px",margin:"auto","max-height":"35px"}},Rt={key:1},Nt={key:0,class:"input-box",style:{width:"120px",margin:"auto","max-height":"35px"}},Pt={key:1},Et={class:"button-row",style:{"text-align":"center"}},Ft={class:"modal-layout",style:{height:"760px"}},Ut={class:"modal-header"},Mt=y(()=>e("div",{class:"modal-title"},"주문 상세 보기",-1)),At={class:"modal-body",style:{height:"700px",padding:"40px"}};function zt(s,t,o,a,l,i){const g=f("v-select"),_=f("v-text-field"),h=f("v-btn"),b=f("shopTable"),v=f("font-awesome-icon"),I=f("v-dialog"),N=f("order-view-component");return r(),u("div",j,[e("div",q,[e("form",{novalidate:"",onSubmit:t[13]||(t[13]=A((...d)=>i.search&&i.search(...d),["prevent"]))},[e("div",G,[e("table",J,[e("tbody",null,[o.orgOstatus=="all"?(r(),u("tr",H,[K,e("td",null,[e("div",Q,[(r(!0),u(C,null,O(l.ostatusList,d=>(r(),u("div",W,[e("label",null,[T(e("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=L=>l.ostatus=L),value:d.value},null,8,X),[[R,l.ostatus]]),p(" "+c(d.text),1)])]))),256))])])])):V("",!0),e("tr",null,[o.orgOstatus=="all"?(r(),u("th",Z,"결제수단")):(r(),u("th",$,"결제수단")),e("td",null,[e("div",tt,[(r(!0),u(C,null,O(l.paymethodList,d=>(r(),u("div",et,[e("label",null,[T(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=L=>l.paymethod=L),value:d.value},null,8,st),[[R,l.paymethod]]),p(" "+c(d.text),1)])]))),256))])])]),e("tr",null,[it,e("td",null,[e("div",at,[n(g,{modelValue:l.keywordCmd,"onUpdate:modelValue":t[2]||(t[2]=d=>l.keywordCmd=d),density:"compact",variant:"outlined",style:{"max-width":"200px"},items:l.keywordCmdList},null,8,["modelValue","items"]),n(_,{style:{"margin-left":"20px","max-width":"300px"},density:"compact",variant:"outlined",modelValue:l.keyword,"onUpdate:modelValue":t[3]||(t[3]=d=>l.keyword=d)},null,8,["modelValue"])])])]),e("tr",null,[ot,e("td",null,[e("div",lt,[e("div",dt,[n(h,{variant:"outlined",class:x("white-button "+l.dayClass.to),onClick:t[4]||(t[4]=d=>i.setDay("to"))},{default:m(()=>[p("오늘 ")]),_:1},8,["class"]),n(h,{variant:"outlined",class:x("white-button "+l.dayClass.yer),onClick:t[5]||(t[5]=d=>i.setDay("yer"))},{default:m(()=>[p(" 어제 ")]),_:1},8,["class"]),n(h,{variant:"outlined",class:x("white-button "+l.dayClass.thr),onClick:t[6]||(t[6]=d=>i.setDay("thr"))},{default:m(()=>[p(" 3일 ")]),_:1},8,["class"]),n(h,{variant:"outlined",class:x("white-button "+l.dayClass.week),onClick:t[7]||(t[7]=d=>i.setDay("week"))},{default:m(()=>[p(" 1주일 ")]),_:1},8,["class"]),n(h,{variant:"outlined",class:x("white-button "+l.dayClass.mon),onClick:t[8]||(t[8]=d=>i.setDay("mon"))},{default:m(()=>[p(" 1개월 ")]),_:1},8,["class"]),n(h,{variant:"outlined",class:x("white-button "+l.dayClass.tmon),onClick:t[9]||(t[9]=d=>i.setDay("tmon"))},{default:m(()=>[p(" 3개월 ")]),_:1},8,["class"])]),e("div",nt,[e("div",rt,[n(_,{type:"date",modelValue:l.stdate,"onUpdate:modelValue":t[10]||(t[10]=d=>l.stdate=d),density:"compact",variant:"outlined"},null,8,["modelValue"])]),ut,e("div",ht,[n(_,{type:"date",density:"compact",variant:"outlined",modelValue:l.endate,"onUpdate:modelValue":t[11]||(t[11]=d=>l.endate=d)},null,8,["modelValue"])])])])])])])])]),e("div",mt,[n(h,{class:"white-button",variant:"outlined",onClick:t[12]||(t[12]=d=>i.searchReset())},{default:m(()=>[pt]),_:1}),n(h,{class:"search-button",type:"submit",variant:"outlined"},{default:m(()=>[ct]),_:1})])],32),e("div",yt,[vt,o.orgOstatus!="all"?(r(),u("div",gt,[e("div",_t,[n(g,{density:"compact",modelValue:l.changeOstatus,"onUpdate:modelValue":t[14]||(t[14]=d=>l.changeOstatus=d),variant:"outlined",style:{width:"160px"},items:l.changeOstatusList},null,8,["modelValue","items"])]),e("div",ft,[n(h,{class:"white-button",style:{"max-width":"120px",height:"40px"},onClick:t[15]||(t[15]=d=>i.updateOstatus()),variant:"outlined"},{default:m(()=>[p("주문상태 변경 ")]),_:1})])])):V("",!0),e("div",xt,[e("div",wt,"전체주문수 "+c(l.util.numberFormat(l.paging.total))+"개",1),n(g,{modelValue:l.datalimit,"onUpdate:modelValue":t[16]||(t[16]=d=>l.datalimit=d),density:"compact","bg-color":"#fff",style:{"max-width":"100px"},items:l.datalimitList},null,8,["modelValue","items"])])]),n(b,{datas:l.orderList,fixType:"rows",fixDatas:l.orderFixList,updateStickyTop:l.stickyTop,fixed:l.fixed,onPageMove:i.pageMove,onOrderView:i.orderView,onParentEvent:i.tableEventAction,onCheckDataList:i.checkDataList,columns:l.columns,paging:l.paging},null,8,["datas","fixDatas","updateStickyTop","fixed","onPageMove","onOrderView","onParentEvent","onCheckDataList","columns","paging"])]),n(I,{modelValue:l.deliveryDialog,"onUpdate:modelValue":t[20]||(t[20]=d=>l.deliveryDialog=d),width:"1000",persistent:"",rounded:"",style:{"z-index":"100"}},{default:m(()=>[e("div",bt,[e("div",Lt,[kt,e("div",{class:"modal-close",onClick:t[17]||(t[17]=d=>i.resetChangeOstatus())},[n(v,{icon:"fa-solid fa-circle-xmark"})])]),l.deliveryDialog?(r(),u("div",Dt,[Ct,e("div",Ot,[e("table",Vt,[It,e("tbody",null,[(r(!0),u(C,null,O(l.deliveryInfoList,(d,L)=>(r(),u("tr",null,[e("td",null,c(d.order_code),1),e("td",null,c(d.oname),1),e("td",null,c(d.opcs),1),e("td",null,c(d.paymethod),1),e("td",null,c(d.pay_price),1),e("td",null,c(d.deliveryPrice),1),e("td",St,[d.transCheck?(r(),u("div",Tt,[n(g,{density:"compact",variant:"outlined",style:{width:"130px"},label:"택배사",modelValue:d.deliveryCompany,"onUpdate:modelValue":D=>d.deliveryCompany=D,items:l.deliveryCompanyList},null,8,["modelValue","onUpdate:modelValue","items"])])):(r(),u("div",Rt,c(d.noTransText),1))]),e("td",null,[d.transCheck?(r(),u("div",Nt,[n(_,{density:"compact",variant:"outlined",modelValue:d.sendNumber,"onUpdate:modelValue":D=>d.sendNumber=D,rules:[()=>!!d.sendNumber||"송장번호를 입력하세요"]},null,8,["modelValue","onUpdate:modelValue","rules"])])):(r(),u("div",Pt,c(d.noTransText),1))])]))),256))])])]),e("div",Et,[n(h,{class:"white-button",style:{"max-width":"120px","min-width":"120px",height:"50px",border:"solid 1px #000","border-radius":"5px"},onClick:t[18]||(t[18]=d=>i.resetChangeOstatus()),variant:"outlined"},{default:m(()=>[p("취소 ")]),_:1}),n(h,{class:"black-button",style:{"margin-left":"20px","max-width":"120px","min-width":"120px",height:"50px",background:"#000",color:"#fff"},onClick:t[19]||(t[19]=d=>i.deliveryInfoAction()),variant:"outlined"},{default:m(()=>[p("확인 ")]),_:1})])])):V("",!0)])]),_:1},8,["modelValue"]),n(I,{modelValue:l.orderViewDialog,"onUpdate:modelValue":t[22]||(t[22]=d=>l.orderViewDialog=d),width:"1200",persistent:"",rounded:"",style:{"z-index":"100"}},{default:m(()=>[e("div",Ft,[e("div",Ut,[Mt,e("div",{class:"modal-close",onClick:t[21]||(t[21]=d=>l.orderViewDialog=!1)},[n(v,{icon:"fa-solid fa-circle-xmark"})])]),e("div",At,[n(N,{oid:l.orderViewId,onReload:i.reloadOrderList},null,8,["oid","onReload"])])])]),_:1},8,["modelValue"])])}const Jt=M(B,[["render",zt],["__scopeId","data-v-e309e717"]]);export{Jt as o};
