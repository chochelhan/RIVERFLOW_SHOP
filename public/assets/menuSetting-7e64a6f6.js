import{a as y,a6 as S,a7 as I}from"./apiService-0aea4262.js";import{_ as w,r as f,o as u,c,a as o,b as d,w as p,F as V,g as F,t as k,d as P,k as A,e as m,n as D,j as v,s as b,W as _,p as q,f as U}from"./index-7c0b344a.js";import"./axios-c24e582b.js";const N={watch:{fcategory(i){},scategory(i){this.tcategory="",this.tcategoryList=[];for(const e of this.categoryList)if(this.fcategory==e.id){for(const s of e.subList)if(s.id==i){this.tcategoryList.push({text:s.cname+" 전체",value:""});for(const n of s.subList)this.tcategoryList.push({text:n.cname,value:n.id});break}}this.tcategorySelected&&(this.tcategory=this.tcategorySelected,this.tcategorySelected="")}},data(){return{form:null,siteMenuList:[],siteMenuRegistTitle:"메뉴 상세설정",siteMenuId:"",baseSiteMenuId:"baseMenuId",mname:"",muse:"yes",buttonTitle:"저장",rootActive:"active",linkType:"category",pcode:"",depth:1,sequenceParams:{type:"",id:"",index:0,subIndex:0},serverFlag:!1,categoryList:[],fcategory:"",fcategoryList:[],scategory:"",scategorySelected:"",tcategorySelected:"",scategoryList:[],tcategory:"",tcategoryList:[],boardList:[],boardId:"",fCode:"",sCode:""}},created(){this.getData()},methods:{mnameErrors(i){return i?!0:"메뉴명을 입력하세요"},getData(){this.serverFlag||(this.serverFlag=!0,y.post(S,{},i=>{var e,s,n;if(this.serverFlag=!1,this.siteMenuList=[],(e=i.data)!=null&&e.menuList&&i.data.menuList&&i.data.menuList.menu)for(let t of i.data.menuList.menu)t.active="",t.open=!1,this.siteMenuList.push(t);if(this.categoryList=[],this.fcategoryList=[],(s=i.data)!=null&&s.categoryList)for(let t of i.data.categoryList)this.categoryList.push(t),this.fcategoryList.push({title:t.cname,value:t.id});if(this.boardList=[],(n=i.data)!=null&&n.boardList)for(const t of i.data.boardList)t.btype!="notice"&&this.boardList.push({title:t.bname,value:t.id})}))},boxToggle(i){this.choicesiteMenu(i,"toggle")},choicesiteMenu(i,e){if(i=="root"){this.rootActive="active",this.siteMenuId="",this.sequenceParams={type:"",code:"",index:0,subIndex:0};return}else{let s={},n=0;for(let t of this.siteMenuList){if(t.code==i?(t.active="active",s=t,this.fCode=t.code,this.sCode="",e!="toggle"?t.open||(t.open=!0):t.open?t.open=!1:t.open=!0,this.sequenceParams={type:"main",code:t.code,index:n,subIndex:0}):t.active="",t.subList){let a=0;for(let r of t.subList)r.code==i?(this.fCode=t.code,this.sCode=r.code,r.active="active",s=r,e!="toggle"?r.open||(r.open=!0):r.open?r.open=!1:r.open=!0,t.subList[a]=r,this.sequenceParams={type:"sub",code:r.code,index:n,subIndex:a}):r.active="",a++}n++}this.rootActive="",this.siteMenuId=s.code,this.mname=s.mname,this.linkType=s.linkType,this.linkType=="category"?(this.fcategory=s.fcategory,this.scategory=s.scategory,this.tcategory=s.tcategory,this.scategorySelected=s.scategory,this.tcategorySelected=s.tcategory,this.boardId=""):(this.fcategory="",this.scategory="",this.tcategory="",this.boardId=s.boardId),this.muse=s.muse}},addsiteMenu(){if(this.rootActive="active",this.sCode){const s={message:"더이상 하위메뉴를 추가할수 없습니다"};this.emitter.emit("modalOpen",s);return}if(this.serverFlag)return;const e="m"+new Date().getTime();if(this.rootActive=="active"){const s={mname:"새 메뉴",code:e,linkType:"category",fcategory:"",scategory:"",tcategory:"",boardId:"",active:"active",muse:"no",subList:[]};this.siteMenuList.push(s),this.fCode=e,this.sCode=""}else{let s=0;for(let n of this.siteMenuList){if(n.active="",this.siteMenuId==n.code){this.fCode=n.code,this.sCode=e,n.subList||(n.subList=[]);const t={mname:"새 메뉴",code:e,linkType:"category",fcategory:"",scategory:"",tcategory:"",boardId:"",active:"active",muse:"no",open:!0,subList:[]};n.subList.push(t),n.open=!0,this.siteMenuList[s]=n}s++}}this.rootActive="",this.siteMenuId=this.baseSiteMenuId,this.mname="새 메뉴",this.muse="no",this.validate()},reset(){this.siteMenuId="",this.siteMenuList.splice(this.siteMenuList.length-1,1)},deletesiteMenu(i){if(this.siteMenuList[i].subList&&this.siteMenuList[i].subList.length>0){const e={message:"하위 메뉴가 존재하므로 삭제할수 없습니다"};this.emitter.emit("modalOpen",e);return}this.deleteConfirm("main",i)},deleteSubsiteMenu(i,e){this.deleteConfirm("sub",i,e)},deleteConfirm(i,e,s){const n={type:"confirm",message:"선택된 메뉴을 삭제하시겠습니까?",doAction:()=>{this.deleteAction(i,e,s)}};this.emitter.emit("modalOpen",n)},deleteAction(i,e,s){i=="main"?this.siteMenuList.splice(e,1):this.siteMenuList[e].subList.splice(s,1);let n={menu:this.siteMenuList};this.serverFlag||(this.serverFlag=!0,this.emitter.emit("overlay","open"),y.post(I,n,t=>{if(this.serverFlag=!1,this.emitter.emit("overlay","hide"),t.data){this.siteMenuId="";let a={message:"메뉴가 삭제 되었습니다"};this.emitter.emit("modalOpen",a)}}))},checkBoardId(){return this.linkType=="board"?this.boardId?!0:"게시판을 선택하세요":!0},checkFcategory(){return this.linkType!="board"?this.fcategory?!0:"카테고리를 선택하세요":!0},validate(){if(this.form){if(this.linkType=="board"){if(!this.boardId)return}else if(!this.fcategory)return;if(this.siteMenuId!=this.baseSiteMenuId&&this.fCode){let e={},s=0,n="",t="";for(const r of this.siteMenuList){if(this.fCode==r.code){if(!this.sCode)e=r,n=s;else{n=s;let h=0;for(const g of r.subList){if(this.sCode==g.code){e=g,t=h;break}h++}}break}s++}let a={mname:this.mname,code:e.code,linkType:this.linkType,fcategory:this.fcategory,scategory:this.scategory,tcategory:this.tcategory,boardId:this.boardId,muse:this.muse,active:e.active,open:e.open};this.sCode?this.siteMenuList[n].subList[t]=a:(a.subList=e.subList,this.siteMenuList[n]=a)}let i={menu:this.siteMenuList};if(this.serverFlag)return;this.serverFlag=!0,this.emitter.emit("overlay","open"),y.post(I,i,e=>{if(this.serverFlag=!1,this.emitter.emit("overlay","hide"),e.data)if(this.siteMenuId!=this.baseSiteMenuId){let s={message:"메뉴정보가 수정 되었습니다"};this.emitter.emit("modalOpen",s)}else this.sCode?this.choicesiteMenu(this.sCode):this.choicesiteMenu(this.fCode)})}},upDownsiteMenu(i){if(!this.sequenceParams.code||!this.sequenceResultSet(i)||this.serverFlag)return;this.serverFlag=!0;let e={menu:this.siteMenuList};y.post(I,e,s=>{this.serverFlag=!1})},sequenceResultSet(i){let e,s,n,t,a;switch(this.sequenceParams.type){case"main":if(e=parseInt(this.sequenceParams.index),s=this.siteMenuList[e],i=="up"){if(e<1)return!1;n=e-1}else{if(this.siteMenuList.length<=e+1)return!1;n=e+1}t=this.siteMenuList[n],this.siteMenuList.splice(e,1,t),this.siteMenuList.splice(n,1,s),this.sequenceParams.index=n;break;case"sub":if(a=parseInt(this.sequenceParams.index),e=parseInt(this.sequenceParams.subIndex),s=this.siteMenuList[a].subList[e],i=="up"){if(e<1)return!1;n=e-1}else{if(this.siteMenuList[a].subList.length<=e+1)return!1;n=e+1}t=this.siteMenuList[a].subList[n],this.siteMenuList[a].subList.splice(e,1,t),this.siteMenuList[a].subList.splice(n,1,s),this.sequenceParams.subIndex=n;break}return!0}}},L=i=>(q("data-v-99076461"),i=i(),U(),i),E={class:"page-container"},B={class:"siteMenu-container"},O={class:"siteMenu-list"},R={class:"siteMenu-list-header"},G={class:"up-down"},j={class:"add"},z={class:"siteMenu-list-body"},W={class:"main-siteMenu"},H={class:"main-li"},J={class:"icon-box"},K=["onClick"],Q=["onClick"],X=["onClick"],Y=["onClick"],Z={class:"siteMenu-regist"},$={key:0},ee={class:"siteMenu-title"},te={class:"table-ul"},se={class:"label-input"},ie={class:"input-box"},oe=L(()=>o("div",{class:"label"}," 메뉴 링크 유형 ",-1)),ne={class:"label-input"},ae={class:"radio-box"},le={key:0},re=L(()=>o("div",{class:"label"}," 카테고리 선택 ",-1)),de={class:"label-input flex"},ue={class:"select-box",style:{width:"180px","margin-right":"10px"}},ce={key:1},he=L(()=>o("div",{class:"label"}," 게시판 선택 ",-1)),me={class:"label-input flex"},fe={class:"select-box",style:{width:"180px","margin-right":"10px"}},pe=L(()=>o("div",{class:"label"}," 메뉴 사용여부 ",-1)),ge={class:"label-input"},ye={class:"radio-box"},ve={class:"button-row"};function be(i,e,s,n,t,a){const r=f("font-awesome-icon"),h=f("v-btn"),g=f("v-text-field"),x=f("v-select"),C=f("v-form");return u(),c("div",E,[o("div",B,[o("div",O,[o("div",R,[o("div",G,[d(h,{class:"white-button",onClick:e[0]||(e[0]=l=>a.upDownsiteMenu("up")),style:{"margin-right":"5px"},variant:"outlined"},{default:p(()=>[d(r,{icon:"fa-solid fa-angle-up"})]),_:1}),d(h,{class:"white-button",onClick:e[1]||(e[1]=l=>a.upDownsiteMenu("down")),variant:"outlined"},{default:p(()=>[d(r,{icon:"fa-solid fa-angle-down"})]),_:1})]),o("div",j,[d(h,{class:"white-button",onClick:e[2]||(e[2]=l=>a.addsiteMenu()),variant:"outlined"},{default:p(()=>[d(r,{icon:"fa-solid fa-plus"}),m("   메뉴 추가 ")]),_:1})])]),o("div",z,[(u(!0),c(V,null,F(t.siteMenuList,(l,T)=>(u(),c("ul",W,[o("li",H,[o("div",{class:D("main-data "+l.active)},[o("div",J,[l.subList&&l.subList.length>0?(u(),c("div",{key:0,onClick:M=>a.boxToggle(l.code)},[l.open?(u(),v(r,{key:0,class:"icon",icon:"fa-solid fa-folder-open"})):(u(),v(r,{key:1,class:"icon",icon:"fa-solid fa-folder"}))],8,K)):(u(),c("div",{key:1,onClick:M=>a.choicesiteMenu(l.code)},[d(r,{class:"icon",icon:"fa-solid fa-file-lines"})],8,Q))]),o("div",{class:"gname",onClick:M=>a.choicesiteMenu(l.code)},[m(k(l.mname)+" ",1),l.muse=="yes"?(u(),v(r,{key:0,icon:"fa-solid fa-eye"})):(u(),v(r,{key:1,icon:"fa-solid fa-eye-slash"}))],8,X),o("div",{class:"btn",onClick:M=>a.deletesiteMenu(T)},[d(r,{icon:"fa-solid fa-circle-minus"})],8,Y)],2)])]))),256))])]),o("div",Z,[t.siteMenuId?(u(),c("div",$,[o("div",ee,k(t.siteMenuRegistTitle),1),d(C,{modelValue:t.form,"onUpdate:modelValue":e[10]||(e[10]=l=>t.form=l),novalidate:"",onSubmit:P(a.validate,["prevent"])},{default:p(()=>[o("ul",te,[o("li",null,[o("div",se,[o("div",ie,[d(g,{modelValue:t.mname,"onUpdate:modelValue":e[3]||(e[3]=l=>t.mname=l),rules:[a.mnameErrors],label:"메뉴명",density:"compact",variant:"outlined",placeholder:"메뉴명을 입력해주세요"},null,8,["modelValue","rules"])])])]),o("li",null,[oe,o("div",ne,[o("div",ae,[o("label",null,[b(o("input",{type:"radio","onUpdate:modelValue":e[4]||(e[4]=l=>t.linkType=l),value:"category"},null,512),[[_,t.linkType]]),m(" 카테고리 ")]),o("label",null,[b(o("input",{type:"radio","onUpdate:modelValue":e[5]||(e[5]=l=>t.linkType=l),value:"board"},null,512),[[_,t.linkType]]),m(" 게시판 ")])])])]),t.linkType=="category"?(u(),c("li",le,[re,o("div",de,[o("div",ue,[d(x,{modelValue:t.fcategory,"onUpdate:modelValue":e[6]||(e[6]=l=>t.fcategory=l),rules:[a.checkFcategory],density:"compact",variant:"outlined",label:"카테고리 선택",items:t.fcategoryList},null,8,["modelValue","rules","items"])])])])):(u(),c("li",ce,[he,o("div",me,[o("div",fe,[d(x,{modelValue:t.boardId,"onUpdate:modelValue":e[7]||(e[7]=l=>t.boardId=l),density:"compact",variant:"outlined",rules:[a.checkBoardId],label:"게시판 선택",items:t.boardList},null,8,["modelValue","rules","items"])])])])),o("li",null,[pe,o("div",ge,[o("div",ye,[o("label",null,[b(o("input",{type:"radio","onUpdate:modelValue":e[8]||(e[8]=l=>t.muse=l),value:"yes"},null,512),[[_,t.muse]]),m(" 사용 ")]),o("label",null,[b(o("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=l=>t.muse=l),value:"no"},null,512),[[_,t.muse]]),m(" 사용안함 ")])])])])]),o("div",ve,[d(h,{class:"submit-button",type:"submit"},{default:p(()=>[m("메뉴정보 "+k(t.buttonTitle),1)]),_:1})])]),_:1},8,["modelValue","onSubmit"])])):A("",!0)])])])}const Ie=w(N,[["render",be],["__scopeId","data-v-99076461"]]);export{Ie as default};
