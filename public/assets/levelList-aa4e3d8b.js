import{a as L,m as M,n as A,o as D,p as C,q as S}from"./apiService-0aea4262.js";import{U as v}from"./util-5fdb7bcf.js";import{_ as T,r as f,o as r,c as h,a as t,d as n,w as p,F as B,b as R,t as I,u as N,e as y,g as d,n as O,j as V,S as E,q as g,W as _,p as q,f as G}from"./index-e9ed42ea.js";import"./axios-c24e582b.js";import"./jquery-331624d0.js";const F={data(){return{form:null,baseLevelId:"newLevel",levelList:[],levelRegistTitle:"등급 상세설정",levelId:"",gname:"",gdesc:"",guse:"yes",gprice:0,gservicePointUse:"no",gservicePoint:0,gpointUse:"no",gpoint:0,gcoupon:"",gbase:"no",buttonTitle:"저장",rules:{numeric:l=>v.numericByPrice(l)?"숫자만 입력가능합니다":!0}}},created(){this.getData()},methods:{getData(){L.post(M,{},l=>{this.levelList=[];for(let e of l.data)e.active="",this.levelList.push(e);this.levelId?this.choiceLevel(this.levelId):this.choiceLevel(this.levelList[0].id)})},checkPrice(l){v.price(l)&&(this.gprice=v.price(l))},checkPoint(l){v.price(l)&&(this.gservicePoint=v.price(l))},checkGPoint(l){v.price(l)&&(this.gpoint=v.price(l))},choiceLevel(l){if(this.levelId==this.baseLevelId){let o={message:"먼저 그룹설정 정보를 저장하세요"};this.emitter.emit("modalOpen",o);return}let e={};for(let o of this.levelList)o.id==l?(o.active="active",e=o):o.active="";this.levelId=e.id,this.gname=e.gname,this.gdesc=e.gdesc,this.guse=e.guse,this.gbase=e.gbase,this.gprice=e.gprice,this.gservicePointUse=e.gservicePointUse,this.gservicePoint=e.gservicePoint,this.gpointUse=e.gpointUse,this.gpoint=e.gpoint,this.gcoupon=e.gcoupon,this.buttonTitle="수정"},addLevel(){if(this.levelId==this.baseLevelId){let e={message:"먼저 그룹설정 정보를 저장하세요"};this.emitter.emit("modalOpen",e);return}if(this.levelList.length>20){let e={message:"그룹은 최대 20개까지만 설정 가능합니다"};this.emitter.emit("modalOpen",e)}for(let e of this.levelList)e.active="";const l=this.baseLevelId;this.levelList.push({gname:"새 등급",id:l,active:"active"}),this.levelId=l,this.dataReset(),this.gname="새 등급",this.buttonTitle="저장",this.guse="no",this.validate()},reset(){this.levelId="",this.dataReset(),this.levelList.splice(this.levelList.length-1,1)},checkGprice(l){},dataReset(){this.gname="",this.gdesc="",this.guse="yes",this.gprice=0,this.gservicePointUse="no",this.gservicePoint=0,this.gpointUse="no",this.gpoint=0,this.gcoupon="",this.buttonTitle="저장"},checkBaseLevelId(l,e){if(this.levelId==this.baseLevelId)switch(e.type){case"delete":if(e.id==this.baseLevelId){const o={message:"선택된 등급이 삭제되었습니다",doAction:()=>{this.levelList.splice(this.levelList.length-1,1),this.levelId="",this.choiceLevel(this.levelList[0].id)}};this.emitter.emit("modalOpen",o)}else{const o={message:"먼저 새등급 정보를 저장해주세요"};this.emitter.emit("modalOpen",o)}return}l(e)},deleteLevel(l,e){const o={type:"delete",id:l,index:e};this.checkBaseLevelId(this.deleteConfirm,o)},deleteConfirm(l){const e={type:"confirm",message:"선택된 등급을 삭제하시겠습니까?",doAction:()=>{this.deleteAction(l.id,l.index)}};this.emitter.emit("modalOpen",e)},deleteAction(l,e){this.emitter.emit("overlay","open"),L.post(A,{id:l},o=>{if(this.emitter.emit("overlay","hide"),o.status=="success"){const u={message:"선택된 등급이 삭제되었습니다"};this.emitter.emit("modalOpen",u),this.levelList.splice(e,1),this.levelId==l&&this.choiceLevel(this.levelList[0].id)}else{const u={message:"선택된 등급에 회원이 존재하므로 삭제할수 없습니다"};this.emitter.emit("modalOpen",u)}})},validate(){if(!this.form)return;this.gservicePointUse=="no"&&(this.gservicePoint=0),this.gpointUse=="no"&&(this.gpoint=0);const l=this.gprice?this.gprice.toString().replace(/,/gi,""):0,e=this.gservicePoint?this.gservicePoint.toString().replace(/,/gi,""):0,o=this.gpoint?this.gpoint.toString().replace(/,/gi,""):0;let u={gname:this.gname,gdesc:this.gdesc,guse:this.guse,gprice:l,gservicePointUse:this.gservicePointUse,gservicePoint:e,gpointUse:this.gpointUse,gpoint:o,gcoupon:this.gcoupon},i=C;this.levelId&&this.levelId!=this.baseLevelId&&(i=S,u.id=this.levelId),this.emitter.emit("overlay","open"),L.post(i,u,a=>{if(this.emitter.emit("overlay","hide"),a.data){if(this.levelId&&this.levelId!=this.baseLevelId){let m={message:u.id?"등급정보가 수정 되었습니다":"등급정보가 저장 되었습니다"};this.emitter.emit("modalOpen",m)}else this.levelId=a.data.id;this.getData()}})},upDownLevel(l){if(this.levelId==this.baseLevelId){let e={message:"먼저 등급설정 정보를 저장하세요"};this.emitter.emit("modalOpen",e);return}if(this.gbase=="yes"){let e={message:"기본등급은 순위를 변경할수 없습니다"};this.emitter.emit("modalOpen",e);return}L.post(D,{id:this.levelId,cmd:l},e=>{if(e.data){if(e.data=="stay")return;this.levelList=[];for(let o of e.data)o.id==this.levelId?o.active="active":o.active="",this.levelList.push(o)}})}}},U=l=>(q("data-v-25985249"),l=l(),G(),l),j={class:"page-container"},z={class:"brand-container"},Q={class:"brand-list"},W={class:"brand-list-header"},H={class:"up-down"},J={class:"add"},K={class:"brand-list-body"},X={class:"main-brand"},Y={class:"main-li"},Z=["onClick"],$={style:{"padding-right":"5px"}},ee=["onClick"],te={class:"brand-regist"},ie={key:0},se={class:"brand-title"},le={class:"table-ul"},oe={class:"label-input"},ne={class:"input-box"},ae={class:"label-input"},de={class:"input-box"},ce={class:"label-input"},re={class:"input-box input-price"},pe={class:"label"},ue=U(()=>t("br",null,null,-1)),ve=U(()=>t("span",null,"승급시 적립금을 1회 지급합니다",-1)),he={class:"label-input",style:{"max-width":"200px","padding-top":"10px"}},me={class:"radio-box"},ge=["disabled"],_e=["disabled"],be={key:0,class:"input-price",style:{"margin-top":"20px",width:"170px"}},fe={class:"label"},Le=U(()=>t("span",null,"상품구매시 적립금을 지급합니다",-1)),Ie={class:"label-input",style:{"max-width":"200px"}},ye={class:"radio-box"},Ue={key:0,class:"input-price",style:{"margin-top":"20px",width:"170px"}},Pe=U(()=>t("div",{class:"label"}," 등급 사용여부 ",-1)),Ve={class:"label-input"},Ee={class:"radio-box"},xe=["disabled"],ke=["disabled"],we={class:"button-row"};function Me(l,e,o,u,i,a){const c=f("font-awesome-icon"),m=f("v-btn"),b=f("v-text-field"),P=f("v-tooltip"),x=f("v-form");return r(),h("div",j,[t("div",z,[t("div",Q,[t("div",W,[t("div",H,[n(m,{class:"white-button",onClick:e[0]||(e[0]=s=>a.upDownLevel("up")),variant:"outlined",style:{"margin-right":"5px"}},{default:p(()=>[n(c,{icon:"fa-solid fa-angle-up"})]),_:1}),n(m,{class:"white-button",onClick:e[1]||(e[1]=s=>a.upDownLevel("down")),variant:"outlined"},{default:p(()=>[n(c,{icon:"fa-solid fa-angle-down"})]),_:1})]),t("div",J,[n(m,{class:"white-button",onClick:e[2]||(e[2]=s=>a.addLevel()),variant:"outlined"},{default:p(()=>[n(c,{icon:"fa-solid fa-plus"}),d(" 등급 추가 ")]),_:1})])]),t("div",K,[(r(!0),h(B,null,R(i.levelList,(s,k)=>(r(),h("ul",X,[t("li",Y,[t("div",{class:O("main-data "+s.active)},[t("div",{class:"gname",onClick:w=>a.choiceLevel(s.id)},[t("span",$,I(s.grank),1),d(" "+I(s.gname)+" ",1),s.guse=="yes"?(r(),V(c,{key:0,icon:"fa-solid fa-eye"})):(r(),V(c,{key:1,icon:"fa-solid fa-eye-slash"}))],8,Z),s.gbase!="yes"?(r(),h("div",{key:0,class:"btn",onClick:w=>a.deleteLevel(s.id,k)},[n(c,{icon:"fa-solid fa-circle-minus"})],8,ee)):y("",!0)],2)])]))),256))])]),t("div",te,[i.levelId?(r(),h("div",ie,[t("div",se,I(i.levelRegistTitle),1),n(x,{modelValue:i.form,"onUpdate:modelValue":e[14]||(e[14]=s=>i.form=s),novalidate:"",onSubmit:N(a.validate,["prevent"])},{default:p(()=>[t("ul",le,[t("li",null,[t("div",oe,[t("div",ne,[n(b,{modelValue:i.gname,"onUpdate:modelValue":e[3]||(e[3]=s=>i.gname=s),density:"compact",variant:"outlined",ref:"gname",label:"등급명",rules:[()=>!!i.gname||"등급명을 입력하세요"],placeholder:"등급명을 입력해주세요"},null,8,["modelValue","rules"])])])]),t("li",null,[t("div",ae,[t("div",de,[n(b,{modelValue:i.gdesc,"onUpdate:modelValue":e[4]||(e[4]=s=>i.gdesc=s),density:"compact",variant:"outlined",label:"등급설명",disabled:i.gbase=="yes",placeholder:"등급설명을 입력해주세요"},null,8,["modelValue","disabled"])])])]),t("li",null,[t("div",ce,[t("div",re,[n(b,{modelValue:i.gprice,"onUpdate:modelValue":e[5]||(e[5]=s=>i.gprice=s),density:"compact",variant:"outlined",ref:"gprice",rules:[i.rules.numeric],label:"승급시 필요한 전체구매금액",disabled:i.gbase=="yes",onInput:a.checkPrice,placeholder:"승급시 필요한 전체구매금액을 입력해주세요"},null,8,["modelValue","rules","disabled","onInput"])])])]),t("li",null,[t("div",pe,[d(" 등급적립금"),ue,d("자동지급설정 "),n(P,{bottom:""},{activator:p(({props:s})=>[n(c,E(s,{class:"help-icon",icon:"fa-solid fa-circle-question"}),null,16)]),default:p(()=>[ve]),_:1})]),t("div",he,[t("div",me,[t("label",null,[g(t("input",{type:"radio","onUpdate:modelValue":e[6]||(e[6]=s=>i.gservicePointUse=s),disabled:i.gbase=="yes",value:"yes"},null,8,ge),[[_,i.gservicePointUse]]),d(" 사용 ")]),t("label",null,[g(t("input",{type:"radio",disabled:i.gbase=="yes","onUpdate:modelValue":e[7]||(e[7]=s=>i.gservicePointUse=s),value:"no"},null,8,_e),[[_,i.gservicePointUse]]),d(" 사용안함 ")])])]),i.gservicePointUse=="yes"?(r(),h("div",be,[n(b,{modelValue:i.gservicePoint,"onUpdate:modelValue":e[8]||(e[8]=s=>i.gservicePoint=s),density:"compact",variant:"outlined",rules:[i.rules.numeric],label:"지급금액",ref:"gservicePoint",onInput:a.checkPoint,placeholder:""},null,8,["modelValue","rules","onInput"])])):y("",!0)]),t("li",null,[t("div",fe,[d(" 등급적립금 혜택 "),n(P,{bottom:""},{activator:p(({props:s})=>[n(c,E(s,{class:"help-icon",icon:"fa-solid fa-circle-question"}),null,16)]),default:p(()=>[Le]),_:1})]),t("div",Ie,[t("div",ye,[t("label",null,[g(t("input",{type:"radio","onUpdate:modelValue":e[9]||(e[9]=s=>i.gpointUse=s),value:"yes"},null,512),[[_,i.gpointUse]]),d(" 사용 ")]),t("label",null,[g(t("input",{type:"radio","onUpdate:modelValue":e[10]||(e[10]=s=>i.gpointUse=s),value:"no"},null,512),[[_,i.gpointUse]]),d(" 사용안함 ")])])]),i.gpointUse=="yes"?(r(),h("div",Ue,[n(b,{modelValue:i.gpoint,"onUpdate:modelValue":e[11]||(e[11]=s=>i.gpoint=s),density:"compact",variant:"outlined",ref:"gpoint",rules:[i.rules.numeric],label:"적립률",suffix:"%",onInput:a.checkGPoint,placeholder:""},null,8,["modelValue","rules","onInput"])])):y("",!0)]),t("li",null,[Pe,t("div",Ve,[t("div",Ee,[t("label",null,[g(t("input",{type:"radio","onUpdate:modelValue":e[12]||(e[12]=s=>i.guse=s),disabled:i.gbase=="yes",value:"yes"},null,8,xe),[[_,i.guse]]),d(" 사용 ")]),t("label",null,[g(t("input",{type:"radio",disabled:i.gbase=="yes","onUpdate:modelValue":e[13]||(e[13]=s=>i.guse=s),value:"no"},null,8,ke),[[_,i.guse]]),d(" 사용안함 ")])])])])]),t("div",we,[n(m,{class:"submit-button",type:"submit"},{default:p(()=>[d("등급정보 "+I(i.buttonTitle),1)]),_:1})])]),_:1},8,["modelValue","onSubmit"])])):y("",!0)])])])}const Be=T(F,[["render",Me],["__scopeId","data-v-25985249"]]);export{Be as default};
