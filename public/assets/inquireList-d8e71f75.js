import{a as g,ar as U,as as C,at as P,au as A,av as R}from"./apiService-0aea4262.js";import{U as y}from"./util-5fdb7bcf.js";import{s as E}from"./shopTable-d56388e3.js";import{_ as V,r as h,o as v,c as L,a as i,t as _,d as n,w as f,u as D,e as M,p as S,f as k,q as w,v as I,g as b}from"./index-e9ed42ea.js";import"./axios-c24e582b.js";import"./jquery-331624d0.js";const F={props:["id"],watch:{id(s){s&&this.getData()}},data(){return{form:null,util:y,info:{},productInfo:{},insertFlag:!1,formHasErrors:!1,comment:"",statusText:"답변 대기중"}},created(){this.getData()},methods:{getData(){g.post(U,{id:this.id},s=>{this.productInfo=s.data.productInfo,this.info=s.data.info,this.info.created_at=this.info.created_at.substring(0,19).replace("T"," "),this.info.status=="complete"&&(this.statusText="답변 완료")})},deleteItem(){const s={type:"confirm",message:"문의글을 삭제하시겠습니까?",doAction:()=>{this.deleteAction()}};this.emitter.emit("modalOpen",s)},deleteAction(){const s={ids:[this.id]};this.emitter.emit("overlay","open"),g.post(C,s,e=>{this.emitter.emit("overlay","hide"),this.$emit("productInquireReload"),this.$emit("inquireDialogHide")})},updateReview(){if(this.insertFlag||!this.form)return;this.insertFlag=!0,this.emitter.emit("overlay","open");let s={id:this.id,content:this.comment};g.post(P,s,e=>{this.emitter.emit("overlay","hide"),this.insertFlag=!1;const l={};this.info.status=="wait"?(this.$emit("productInquireReload"),l.message="답변이 저장 되었습니다"):l.message="답변이 수정 되었습니다",this.info.content=this.comment,this.info.status="complete",this.statusText="답변완료",this.comment="",this.$refs.comment.reset(),l.doAction=()=>{this.$emit("inquireDialogHide")},this.emitter.emit("modalOpen",l)})}}},x=s=>(S("data-v-f2b6f2a7"),s=s(),k(),s),O={class:"page-container"},H={class:"article-container"},j={class:"article-info"},B=x(()=>i("li",{class:"bname"}," 상품정보 ",-1)),Q={class:"bsubject"},G={class:"img"},z=["src"],J={class:"text-box"},K={class:"summary"},W=x(()=>i("span",null,"삭제",-1)),X=["innerHTML"],Y={class:"comment-info"},Z={class:"form-box"},$={class:"input-box"},tt=x(()=>i("span",null,"답변 저장",-1)),et={key:0,class:"reple-list"},it=["innerHTML"];function st(s,e,l,a,t,d){const u=h("v-btn"),r=h("v-text-field"),m=h("v-form");return v(),L("div",O,[i("div",H,[i("ul",j,[B,i("li",Q,[i("div",G,[i("img",{src:t.productInfo.listImg},null,8,z)]),i("div",J,_(t.productInfo.pname)+"    가격 "+_(t.util.numberFormat(t.productInfo.price))+"원   즉시 할인가 "+_(t.util.numberFormat(t.productInfo.dcprice))+"원 ",1)]),i("li",K,[i("div",null,[i("span",null,"작성자 : "+_(t.info.name),1),i("span",null,"등록일 : "+_(t.info.created_at),1),i("span",null,"상태 : "+_(t.statusText),1)]),i("div",null,[n(u,{class:"red-button",onClick:e[0]||(e[0]=p=>d.deleteItem()),variant:"outlined"},{default:f(()=>[W]),_:1})])])]),i("div",{innerHTML:t.info.subject,class:"content"},null,8,X)]),i("div",Y,[n(m,{modelValue:t.form,"onUpdate:modelValue":e[2]||(e[2]=p=>t.form=p),onSubmit:D(d.updateReview,["prevent"])},{default:f(()=>[i("div",Z,[i("div",$,[n(r,{ref:"comment",modelValue:t.comment,"onUpdate:modelValue":e[1]||(e[1]=p=>t.comment=p),dense:"",variant:"outlined",rules:[()=>!!t.comment||"답변을 입력하세요"]},null,8,["modelValue","rules"])]),n(u,{class:"white-button",type:"submit",style:{width:"110px",height:"54px"},variant:"outlined"},{default:f(()=>[tt]),_:1})])]),_:1},8,["modelValue","onSubmit"]),t.info.status=="complete"?(v(),L("ul",et,[i("li",null,[i("div",{class:"content",innerHTML:t.info.content},null,8,it)])])):M("",!0)])])}const ot=V(F,[["render",st],["__scopeId","data-v-f2b6f2a7"]]);const at={components:{shopTable:E,inquireView:ot},watch:{datalimit(s){this.getDataList(1)},cate1(s){this.subCategoryList=[];let e={title:"2차카테고리 선택",value:""};this.subCategoryList.push(e),this.subSubCategoryList=[];let l={title:"3차카테고리 선택",value:""};if(this.subSubCategoryList.push(l),this.cate2="",this.cate3="",this.orgSubCategoryList=[],s){for(let a of this.orgCategoryList)if(a.id==s&&a.subList&&a.subList.length>0)for(let t of a.subList)e={title:t.cname,value:t.id},this.subCategoryList.push(e),this.orgSubCategoryList.push(t)}},cate2(s){this.subSubCategoryList=[];let e={title:"3차카테고리 선택",value:""};if(this.subSubCategoryList.push(e),this.cate3="",s){for(let l of this.orgSubCategoryList)if(l.id==s&&l.subList&&l.subList.length>0)for(let a of l.subList)e={title:a.cname,value:a.id},this.subSubCategoryList.push(e)}}},props:["accept","selectedProduct"],data(){return{util:y,columns:[{name:"선택",id:"id",sort:!1,width:90,type:"allCheckbox"},{name:"번호",id:"number",sort:!1,width:60},{name:"상태",id:"status",sort:!0,width:80},{name:"문의내용",id:"subject",type:"underline-action",action:"inquireView",textStyle:{"text-align":"left","padding-left":"10px","max-width":"437px"},width:450},{name:"작성자",id:"user_name",sort:!0,width:100},{name:"등록일",id:"created_at",sort:!0,width:100},{name:"상품이미지",id:"listImg",width:100,type:"image"},{name:"상품명",id:"pname",width:300,sort:!0},{name:"카테고리",id:"category",width:300},{name:"브랜드",id:"brandId",width:200},{name:"정가",id:"price",width:100},{name:"할인가",id:"dcprice",width:100}],fixed:6,inquireList:[],paging:{total:"",links:[],currentPage:1,lastPage:1},categoryListNames:{},categoryList:[],subCategoryList:[],subSubCategoryList:[],orgCategoryList:[],orgSubCategoryList:[],cate1:"",cate2:"",cate3:"",brandList:[],brandListNames:{},page:1,datalimit:20,keywordCmd:"pname",keywordCmdList:[{title:"작성자",value:"name"},{title:"문의내용",value:"subject"},{title:"상품명",value:"pname"}],keyword:"",brand:"",stdate:"",endate:"",dateCmd:"created_at",dateCmdList:[{title:"문의등록일",value:"created_at"}],datalimitList:[{title:"10개",value:10},{title:"20개",value:20},{title:"30개",value:30},{title:"50개",value:50},{title:"100개",value:100}],ids:{},stickyTop:0,dataSort:{field:"id",sort:"desc"},status:[],selectedId:"",inquireDialog:!1}},created(){this.getData(1)},methods:{searchReset(){this.keywordCmd="pname",this.keyword="",this.brand="",this.stdate="",this.endate="",this.dateCmd="created_at",this.cate1="",this.cate2="",this.cate3="",this.status=[]},getSearchParams(s){this.page=s;let e=[];return this.cate1&&e.push(this.cate1),this.cate2&&e.push(this.cate2),this.cate3&&e.push(this.cate3),{orderByField:this.dataSort.field,orderBySort:this.dataSort.sort,limit:this.datalimit,page:s,keywordCmd:this.keywordCmd,keyword:this.keyword,brand:this.brand,stdate:this.stdate,endate:this.endate,dateCmd:this.dateCmd,status:this.status,category:e.length>0?e.join(","):""}},getData(s){const e=this.getSearchParams(s);g.post(A,e,l=>{this.orgCategoryList=l.data.categoryList;let a={title:"1차카테고리 선택",value:""};this.categoryList.push(a);let t={title:"2차카테고리 선택",value:""};this.subCategoryList.push(t);let d={title:"3차카테고리 선택",value:""};this.subSubCategoryList.push(d),this.categoryListNames={};for(let r of l.data.categoryList)if(a={title:r.cname,value:r.id},this.categoryList.push(a),this.categoryListNames[r.id]=r.cname,r.subList){for(let m of r.subList)if(this.categoryListNames[m.id]=m.cname,m.subList)for(let p of m.subList)this.categoryListNames[p.id]=p.cname}this.brandListNames={};let u={title:"브랜드 선택",value:""};this.brandList.push(u);for(let r of l.data.brandList){let m={title:r.bname,value:r.id};this.brandList.push(m),this.brandListNames[r.id]=r.bname}this.setDataList(l.data.inquireList)})},getDataList(s){const e=this.getSearchParams(s);g.post(R,e,l=>{this.setDataList(l.data)})},setDataList(s){this.inquireList=[],this.paging={total:s.total,links:s.links,currentPage:s.current_page,lastPage:s.last_page};const e=parseInt(s.total)-this.datalimit*(parseInt(s.current_page)-1);let l=0;for(let a of s.data){a.number=e-l,a.created_at=a.created_at.substring(0,10);let t=a.category1.split(","),d=this.categoryListNames[t[0]];t[1]&&(d+=" > "+this.categoryListNames[t[1]]),t[2]&&(d+=" > "+this.categoryListNames[t[2]]),a.category=d,a.status=a.status=="wait"?"답변대기":"답변완료",a.price=y.numberFormat(a.price),a.dcprice=y.numberFormat(a.dcprice),a.brandId=this.brandListNames[a.brandId],this.inquireList.push(a),l++}},pageMove(s){this.getDataList(s.page)},search(){this.getDataList(1)},tableEventAction(s){switch(s.type){case"dataSort":this.dataSort=s.sort,this.getDataList(1);break}},checkDataList(s){this.ids=s},deleteInquire(){let s=!1;for(const l in this.ids)l&&(s=!0);if(!s){const l={message:"문의글을 하나 이상 선택하세요"};this.emitter.emit("modalOpen",l);return}const e={type:"confirm",message:"문의글을 삭제 하시겠습니까?",doAction:()=>{this.deleteAction(this.ids)}};this.emitter.emit("modalOpen",e)},pageReload(){this.getDataList(this.page)},deleteAction(s){const e={ids:s};this.emitter.emit("overlay","open"),g.post(C,e,l=>{this.emitter.emit("overlay","hide");const a={message:"문의글이 삭제 되었습니다"};this.emitter.emit("modalOpen",a),this.getDataList(this.page)})},inquireView(s){this.selectedId=s.id,this.inquireDialog=!0}}},c=s=>(S("data-v-0c5fba2f"),s=s(),k(),s),lt={class:"page-container"},nt={class:"table-box"},dt={class:"search-box"},rt={class:"table-search",cellspacing:"0",cellpadding:"0",border:"0"},ut=c(()=>i("th",null,"상품 브랜드",-1)),mt=c(()=>i("th",null,"상품 카테고리",-1)),ct={style:{display:"flex"}},ht=c(()=>i("div",{style:{width:"20px"}},null,-1)),pt=c(()=>i("div",{style:{width:"20px"}},null,-1)),_t=c(()=>i("th",null,"상태",-1)),ft={style:{display:"flex"}},gt={style:{"margin-right":"20px"}},bt=c(()=>i("th",null,"검색어",-1)),yt={style:{display:"flex"}},vt={style:{"margin-left":"20px"}},Lt=c(()=>i("th",null,"기간검색",-1)),xt={class:"date-div",style:{display:"flex"}},wt={style:{"margin-right":"20px"}},It={style:{width:"160px"}},Ct=c(()=>i("div",{style:{width:"30px","text-align":"center","line-height":"50px",height:"50px"}},"~ ",-1)),Vt={style:{width:"160px"}},Dt={class:"button-row"},St=c(()=>i("span",null,"초기화",-1)),kt=c(()=>i("span",null,"검색",-1)),qt={style:{display:"flex",padding:"0 10px","justify-content":"space-between","z-index":"20"}},Tt={class:"sub-title"},Nt={class:"select-box",style:{display:"flex","max-height":"40px","padding-top":"4px"}},Ut={class:"total"},Pt={class:"modal-layout",style:{height:"760px"}},At={class:"modal-header"},Rt=c(()=>i("div",{class:"modal-title"},"후기 상세",-1)),Et={class:"modal-body",style:{height:"700px"}};function Mt(s,e,l,a,t,d){const u=h("v-select"),r=h("v-text-field"),m=h("v-btn"),p=h("shopTable"),q=h("font-awesome-icon"),T=h("inquireView"),N=h("v-dialog");return v(),L("div",lt,[i("div",nt,[i("form",{novalidate:"",onSubmit:e[12]||(e[12]=D((...o)=>d.search&&d.search(...o),["prevent"]))},[i("div",dt,[i("table",rt,[i("tbody",null,[i("tr",null,[ut,i("td",null,[n(u,{modelValue:t.brand,"onUpdate:modelValue":e[0]||(e[0]=o=>t.brand=o),density:"compact",variant:"outlined",style:{"max-width":"200px"},items:t.brandList},null,8,["modelValue","items"])])]),i("tr",null,[mt,i("td",null,[i("div",ct,[n(u,{modelValue:t.cate1,"onUpdate:modelValue":e[1]||(e[1]=o=>t.cate1=o),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:t.categoryList},null,8,["modelValue","items"]),ht,n(u,{modelValue:t.cate2,"onUpdate:modelValue":e[2]||(e[2]=o=>t.cate2=o),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:t.subCategoryList},null,8,["modelValue","items"]),pt,n(u,{modelValue:t.cate3,"onUpdate:modelValue":e[3]||(e[3]=o=>t.cate3=o),density:"compact",variant:"outlined",style:{"max-width":"230px"},items:t.subSubCategoryList},null,8,["modelValue","items"])])])]),i("tr",null,[_t,i("td",null,[i("div",ft,[i("label",gt,[w(i("input",{type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>t.status=o),value:"wait"},null,512),[[I,t.status]]),b(" 답변대기중 ")]),i("label",null,[w(i("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>t.status=o),value:"complete"},null,512),[[I,t.status]]),b(" 답변완료 ")])])])]),i("tr",null,[bt,i("td",null,[i("div",yt,[n(u,{modelValue:t.keywordCmd,"onUpdate:modelValue":e[6]||(e[6]=o=>t.keywordCmd=o),density:"compact",variant:"outlined",style:{"max-width":"150px"},items:t.keywordCmdList},null,8,["modelValue","items"]),i("div",vt,[n(r,{style:{width:"300px"},density:"compact",variant:"outlined",modelValue:t.keyword,"onUpdate:modelValue":e[7]||(e[7]=o=>t.keyword=o)},null,8,["modelValue"])])])])]),i("tr",null,[Lt,i("td",null,[i("div",xt,[i("div",wt,[n(u,{modelValue:t.dateCmd,"onUpdate:modelValue":e[8]||(e[8]=o=>t.dateCmd=o),density:"compact",variant:"outlined",style:{"max-width":"150px"},items:t.dateCmdList},null,8,["modelValue","items"])]),i("div",It,[n(r,{type:"date",modelValue:t.stdate,"onUpdate:modelValue":e[9]||(e[9]=o=>t.stdate=o),density:"compact",variant:"outlined"},null,8,["modelValue"])]),Ct,i("div",Vt,[n(r,{type:"date",density:"compact",variant:"outlined",modelValue:t.endate,"onUpdate:modelValue":e[10]||(e[10]=o=>t.endate=o)},null,8,["modelValue"])])])])])])])]),i("div",Dt,[n(m,{class:"white-button",variant:"outlined",onClick:e[11]||(e[11]=o=>d.searchReset())},{default:f(()=>[St]),_:1}),n(m,{class:"search-button",type:"submit",variant:"outlined"},{default:f(()=>[kt]),_:1})])],32),i("div",qt,[i("div",Tt,[b("문의 리스트 "),n(m,{depressed:"",color:"primary",variant:"outlined",class:"sdel-button",rounded:"",onClick:e[13]||(e[13]=o=>d.deleteInquire())},{default:f(()=>[b("선택된 문의 삭제 ")]),_:1})]),i("div",Nt,[i("div",Ut,"전체 문의 수 "+_(t.util.numberFormat(t.paging.total))+"개",1),n(u,{modelValue:t.datalimit,"onUpdate:modelValue":e[14]||(e[14]=o=>t.datalimit=o),density:"compact","bg-color":"#fff",style:{"max-width":"100px"},items:t.datalimitList},null,8,["modelValue","items"])])]),n(p,{datas:t.inquireList,updateStickyTop:t.stickyTop,fixed:t.fixed,onPageMove:d.pageMove,onParentEvent:d.tableEventAction,columns:t.columns,paging:t.paging,onInquireView:d.inquireView,onCheckDataList:d.checkDataList},null,8,["datas","updateStickyTop","fixed","onPageMove","onParentEvent","columns","paging","onInquireView","onCheckDataList"])]),n(N,{modelValue:t.inquireDialog,"onUpdate:modelValue":e[18]||(e[18]=o=>t.inquireDialog=o),width:"800",persistent:"",rounded:"",style:{"z-index":"100"}},{default:f(()=>[i("div",Pt,[i("div",At,[Rt,i("div",{class:"modal-close",onClick:e[15]||(e[15]=o=>t.inquireDialog=!1)},[n(q,{icon:"fa-solid fa-circle-xmark"})])]),i("div",Et,[n(T,{id:t.selectedId,onProductInquireReload:e[16]||(e[16]=o=>d.pageReload()),onInquireDialogHide:e[17]||(e[17]=o=>t.inquireDialog=!1)},null,8,["id"])])])]),_:1},8,["modelValue"])])}const Gt=V(at,[["render",Mt],["__scopeId","data-v-0c5fba2f"]]);export{Gt as default};
